Ciencias Matem´aticas, Vol. 30, No. 1, Pag. 1-84, 2016
Recibido 05-2016
Introducci´on al m´etodo de los elementos finitos
Introduction to the finite element method
Franck Boyer1, S´ebastien Martin2*
Resumen Estasnotaspresentanlosaspectosb´asicosdelm´etododeelementofinito.Sepresentanlasbasesmatem´aticas
del m´etodo como las del an´alisis funcional, la formulaci´on variacional de problemas de contorno para ecuaciones en
derivadas parciales, as´ı como el buen planteamiento de los problemas resultantes. Se introducen las aproximaciones
de Galerkin que proporcionan la idea general del m´etodo de elemento finito. Se muestran ejemplos de espacios de
elementos finitos y sus propiedades incluy´endose el an´alisis de error. La inclusi´on de aspectos pr´acticos se realiza a
trav´es del an´alisis de problemas con enfoque en los aspectos matem´aticos presentados. El software libre FreeFem++
se emplea en 2D para ilustrar los principales teoremas mostrados, as´ı como sus limitaciones, en particular tomando
presupuestos que no est´an necesariamente presentes en los teoremas. Se incluyen programas FreeFem++ y ejercicios.
Abstract This notes presents the basic aspects of the finite element method. The mathematical foundations such
as the functional framework, the variational formulation of boundary value partial differential equations and the
well-posedness of the problems are presented. Galerkin approximations are introduced, providing the general idea of
the finite element method. Examples of finite element spaces and their related properties are presented, including
the error analysis. Practical aspects are included through the analysis of problems which focus on the mathematical
issues of the notes: The free finite element solver FreeFem++ is used in 2D to illustrate the main theorems and their
limitations, in particular by tackling assumptions that are not necessarily met in the theorems. FreeFem++ programs
and exercises are included.
Palabras Clave
finite element method — elliptic problems — saddle-point problems — FreeFem++
1Universit´eToulouse3PaulSabatier,InstitutdeMath´ematiquesdeToulouseCNRSUMR5219,franck.boyer@math.univ-toulouse.fr
2Universit´eParisDescartes,MAP5CNRSUMR8145,sebastien.martin@parisdescartes.fr
*AutorparaCorrespondencia
´Indice 3.3 Example 1: A very simple linear constraint . . . . . 21
3.4 Example 2: Porous medium . . . . . . . . . . . . . . . 22
1 Sobolev spaces 2
3.5 Example 3: Stokes problem . . . . . . . . . . . . . . . 22
1.1 Definitions . . . . . . . . . . . . . . . . . . . . . . . . . . . . 2
4 Basic principles of the Galerkin approximation 23
1.2 Basic properties . . . . . . . . . . . . . . . . . . . . . . . . 3
4.1 Elliptic problems: Galerkin approximation . . . . . . 23
1.3 Trace operator . . . . . . . . . . . . . . . . . . . . . . . . . 4
4.2 Elliptic problems: Petrov-Galerkin approximation . 25
1.4 Poincar´e inequalities . . . . . . . . . . . . . . . . . . . . . 5
4.3 Saddle-point problems and Galerkin approximation 26
1.5 Vector fields in L2 with divergence in L2. Definition of
the normal trace . . . . . . . . . . . . . . . . . . . . . . . . 6 4.4 Approximation spaces . . . . . . . . . . . . . . . . . . . 28
2 Weak formulation of elliptic problems 8 5 Examples of finite element spaces 29
2.1 Lax-Milgram theorem . . . . . . . . . . . . . . . . . . . . . 8 5.1 Finite elements in 1D: P1 finite element . . . . . . . 29
2.2 Example 1: Poisson problem . . . . . . . . . . . . . . . 10 5.2 Finite elements in 1D: P2 finite element . . . . . . . 34
2.3 Example 2: General linear elliptic operators . . . . 12 5.3 Pk finite element in dimension d>1 . . . . . . . . . 36
2.4 Example 3: Reaction-diffusion. . . . . . . . . . . . . . 13
5.4 Other classical finite elements . . . . . . . . . . . . . . 43
2.5 Example 4: Convection-diffusion. . . . . . . . . . . . 13
6 Finite elements for saddle-point problems 44
2.6 Example 5: Linear elasticity. . . . . . . . . . . . . . . . 14
6.1 Fortin’s lemma . . . . . . . . . . . . . . . . . . . . . . . . 45
3 Weak formulation of saddle-point problems 14
6.2 Stokes problem . . . . . . . . . . . . . . . . . . . . . . . . 46
3.1 Banach-Neˇcas-Babuˇska theorem . . . . . . . . . . . . 15
TheP1−P0element•TheQ1−P0element•TheP1−P1element
b
3.2 Saddle-point problems . . . . . . . . . . . . . . . . . . . 16 •TheP2−P1 (Taylor-Hood)element
1
7 Problems 53 present the mathematical formulation of elliptic prob-
7.1 Analysis of the convergence . . . . . . . . . . . . . . . 54 lems with related results and examples. In section 3 we
present the mathematical formulation of saddle-point
7.2 Numerical treatment of the boundary conditions . 54
problems with related results and examples. In section 4
7.3 On a Dirichlet boundary term g∈/H1/2(∂Ω) . . . . 57
weintroducetheso-calledGalerkinapproximationwhich
7.4 Compatibility conditions in PDE . . . . . . . . . . . . 59 defines a class of finite-dimensional problems associated
7.5 Lack of regularity and error estimates . . . . . . . . 60 to the continuous problems. In section 5 we introduce
the main approximation spaces and establish the main
7.6 Finite elements for the Stokes system . . . . . . . . 62
approximation properties of these spaces along with sub-
7.7 Uzawa algorithm for saddle-point problems . . . . . 63
sequent error estimates of the method. In section 6 we
7.8 A fluid-structure interaction problem . . . . . . . . . 72
focusonthefiniteelementapproximationofsaddle-point
8 FreeFem++ programs 77 problems such as the Stokes system for which additional
8.1 Problem 1 . . . . . . . . . . . . . . . . . . . . . . . . . . . 77 difficulties have to be targetted. In section 7 we present
somemathematicalproblemsthataresolvedwithafreefi-
8.2 Problem 2 . . . . . . . . . . . . . . . . . . . . . . . . . . . 77
nite element solver FreeFem++ whose formalism respects
8.3 Problem 3 . . . . . . . . . . . . . . . . . . . . . . . . . . . 80
the variational formulation of problems. Section 8 is
8.4 Problem 4 . . . . . . . . . . . . . . . . . . . . . . . . . . . 80 dedicated to the FreeFem++ programs.
8.5 Problem 5 . . . . . . . . . . . . . . . . . . . . . . . . . . . 80
8.6 Problem 6 . . . . . . . . . . . . . . . . . . . . . . . . . . . 81 1. Sobolev spaces
8.7 Problem 7 . . . . . . . . . . . . . . . . . . . . . . . . . . . 82
1.1 Definitions
8.8 Problem 8 . . . . . . . . . . . . . . . . . . . . . . . . . . . 82 For any open subset Ω of Rd, we define D(Ω) (resp.
References 84
D(cid:48)(Ω))tobethesetofC∞functionscompactlysupported
in Ω (resp. the set of distributions on Ω). For any func-
tion u∈L1 (Ω), and any multi-index α =(α ,...,α )∈
Introduction loc 1 d
Nd, we set
In engineering sciences, finite element solvers are ∂α1 ∂αd
∂αu= ··· u,
likely to compute an approximate solution of bound- ∂xα1 ∂xαd
1 d
ary value problems. The goal of designing a numerical
in the sense of distributions.
method is to ensure the convergence of the method, i.e.
to guarantee that the approximate solution is close to
Definition 1.1 (Sobolev space) LetΩbeanopensub-
the unique solution of the continuous problem (if hope- set of Rd. For all integer k≥0, we define the Sobolev
fully it exists) defined by the mathematical model. But space Hk(Ω) as
understanding the properties of the obtained solution
may strongly rely on mathematical aspects such as Hk(Ω)={u∈L2(Ω), ∂αu∈L2(Ω), ∀α ∈Nd, |α|≤k}.
1. themathematicalformulationandthewell-posedness The space is endowed with the norm
of the continuous problem: existence, uniqueness,
(cid:32) (cid:33)1
2
regularity of the solution and stability with respect
(cid:107)u(cid:107) = ∑ (cid:107)∂αu(cid:107)2 .
tothedataarerequiredinordertoprovideastrong Hk L2
|α|≤k
basis for the discretization process;
.
2. the choice of the discretization process: the subse-
Remark 1.2 An equivalent definition consists in defin-
quent approximate finite-dimensional problem has
ing, by induction, H0(Ω)=L2(Ω) and
to be well-posed in order to be numerically solved;
Hk+1(Ω)={u∈Hk(Ω), ∇u∈(Hk(Ω))d}.
3. the error analysis: the quantitative analysis of the
approximation should guarantee that the solution Definition 1.3 (Domains of Rd) A non empty open
to the approximate problem is“close”to the solu- subsetΩofRd issaidtobeaCk domain(resp. aLipschitz
tion to the initial problem. domain) if its boundary ∂Ω is a submanifold of Rd of
class Ck (resp. Lipschitz continuous) and if Ω is locally
Theaimofthiscourseistoprovideanintroductionto situated only on one side of its boundary.
the mathematical analysis of the finite element method.
Practical issues are also addressed. Forsuchdomains,byusinglocalcharts,wecandefine
In section 1 we present the main results in functional the outward unit normal field n:∂Ω→Rd as well as
(cid:82)
analysis,whicharethebasisofthemathematicalanalysis surface integrals f and corresponding Lebesgue spaces
∂
at both continuous and discrete levels. In section 2 we Lp(∂).
Introducci´on al m´etodo de los elementos finitos 3
Proposition 1.4 (Density of smooth functions) Let Moreover,
Ω be a Lipschitz bounded domain of Rd, then the set
T : H1(Ω) → H1(Ω)
C∞(Ω) made of smooth functions up to the boundary of
u (cid:55)→ T(u)
Ω is dense in Hk(Ω) for any k≥0.
is a (non-linear) continuous map.
The following subspace of Hk(Ω) will be very important
in the study of boundary-value problems. Actually the chain rule is still valid if T is Lipschitz
continuousandpiecewiseC1,forinstance. Inthiscase,T(cid:48)
Definition 1.5 For any open subset Ω in Rd we define maybedefinedinanonunivoquewayinsomepointsbut
Hk(Ω) as the closure of D(Ω) in Hk(Ω). the theorem still applies, which implies that the values
0
of T(cid:48) on these particular points are not important.
The topological dual of Hk(Ω) (i.e. the space made of all
0 Example. If T(x)=x+=max(x,0), we define T(cid:48)(x)=1
continuous linear forms defined on this space) may be
if x>0 and T(cid:48)(x)=0 if x≤0. Then we obtain
characterized as follows.
∇(u+)=1 ∇u.
u>0
Definition 1.6 For all k≥0, we define the following
But if we define T(cid:48)(x)=1 if x≥0 and T(cid:48)(x)=0 if x<0,
space of distributions:
we obtain
(cid:40) (cid:41) ∇(u+)=1 ∇u.
u≥0
H−k(Ω)= f ∈D(cid:48)(Ω), f = ∑ ∂αf , with f ∈L2(Ω) .
α α The theorem states that ∇u=0 almost everywhere on
|α|≤k the set {u=0}. (cid:3)
The space is endowed with the norm
LetusrecallthemainresultsonSobolevembeddings:
(cid:32) (cid:33)1 in this part, we focus on H1(Ω) even if similar results
2
(cid:107)f(cid:107) =inf ∑ (cid:107)f (cid:107)2 . can be proved for spaces Hk(Ω), k>1.
H−k α L2
|α|≤k
Theorem 1.10 (Sobolev embeddings) LetΩbeabounded
the infimum being taken among all the possible decompo- Lipschitz domain of Rd.
sitions of f.
If d=1, the embedding H1(Ω)⊂L∞(Ω) is continu-
Proposition 1.7 (Dual of Sobolev spaces) Thespa- ous.
ce H−k(Ω), k≥0, is a Hilbert space which is isomorphic If d =2, the embedding H1(Ω)⊂Lp(Ω), for all
to the dual space of H
0
k(Ω). To be more precise, the
p∈[2,+∞[, is continuous.
duality bracket can be expressed as
If d≥3, the embedding
H1(Ω)⊂Lp∗
(Ω) is contin-
(cid:104)f,u(cid:105) H−k,Hk = ∑ (−1)|α| (cid:90) f α ∂αu, uous, with p∗= d 2 − d 2 .
0 |α|≤k Ω
Theorem 1.11 (Rellich-Kondrachov) LetΩbeabounded
for all f ∈H−k(Ω) and for all u∈Hk(Ω). The formula Lipschitz domain of Rd.
0
does not depend on the choice of decomposition for f. If d=1, the embedding H1(Ω)⊂C0(Ω¯) is compact
(completely continuous).
Note that the topological dual of Hk(Ω) is not a
distribution space and cannot be characterized so easily. If d =2, the embedding H1(Ω)⊂Lp(Ω), for all
p∈[1,+∞[, is compact.
Remark 1.8 The main application of Proposition 1.7 If d ≥3, the embedding H1(Ω)⊂Lp(Ω), for all
is the following result: any element f ∈H−1(Ω) can be p∈[1,p∗[ with p∗= 2d , is compact.
d−2
written as
In particular, the embedding Hk+1(Ω)⊂Hk(Ω), k≥0, is
f =u+div(G), with u∈L2(Ω) and (G∈L2(Ω))d compact.
in the sense of distributions. Theorem 1.12 (Morrey’s inequality) LetΩbeabounded
Lipschitz domain of Rd. If
1.2 Basic properties
k−α =d/2
Theorem 1.9 (Chain rule) Let Ω be an open subset
of Rd. For any function u∈H1(Ω) and any function with α ∈(0,1), then one has the following embedding:
T ∈C1(R;R) with a bounded derivative, we have Hk(Ω)⊂C0,α(Ω¯).
T(u)∈H1(Ω), ∇T(u)=T(cid:48)(u)∇u. As a consequence, Hk(Ω)⊂C0(Ω¯) if k>d/2.
4 Introducci´on al m´etodo de los elementos finitos
1.3 Trace operator and finally
A Lipschitz continuous function which is defined over √
(cid:107)u(cid:107) ≤ 2(cid:107)u(cid:107) .
an open subset Ω can be naturally extended up to the L2(]0,1[×{0}) H1
boundary of Ω. This allows us to define the notion of
Theaboveinequalityshowsthatthemappingγ :C∞(Ω¯)→
trace of such a function on the boundary ∂Ω. In some 0
L2(∂Ω) is continuous for the H1−topology. Its natural
way, it is possible to build a similar notion for functions
continuous extension to H1(Ω) is then straightforward
which lack such a regularity.
by density (see Proposition 1.4).
Observe finally that we have in fact shown the more
Theorem 1.13 (Trace) Let Ω be a bounded Lipschitz
domain of Rd. The mapping precise inequality
1 1
γ : C∞(Ω¯) → L2(∂Ω) (cid:107)u(cid:107) ≤C(cid:107)u(cid:107)2 (cid:107)u(cid:107)2 ,
0 L2(]0,1[×{0}) L2 H1
u (cid:55)→ γ (u)=u
0 |∂Ω
which implies that we can estimate the L2 norm of the
has a unique continuous extension to the whole Sobolev trace by using only the square root of the norm of the
space H1(Ω). This operator, still denoted γ , is called the gradientofu. Thisisaformaljustificationofthenotation
0
trace operator. Besides, H2 1 (∂)thatweadoptedfortherangeofthetraceoperator.
(cid:3)
the trace operator γ :H1(Ω)→L2(∂Ω) is not sur-
0
jective onto L2(∂Ω);
the image of H1(Ω) by the trace operator is a Exercise 1 1. Let Q=(0,1)2 be the unit cube in R2.
1
Prove that, there exists a C>0, such that for any
fractional Sobolev space called H2(∂Ω) which is
u∈H1(Q), we have
a Hilbert space if it is endowed with the norm
(cid:107)v(cid:107)
H
1
2(∂Ω)
=
u∈H
in
1
f
(Ω)
(cid:107)u(cid:107) H1(Ω) . (cid:12) (cid:12) (cid:12)
(cid:12)
(cid:90)
0
1 (γ 0 u)(x,0)dx− (cid:90)
Q
u (cid:12) (cid:12) (cid:12)
(cid:12)
2 ≤C (cid:90)
Q
|∇u|2.
γ0(u)=v
2. Let α∈(0,1) and Q =(0,α)2. Prove that for any
α
Moreover, there exists a (non unique) continuous linear u∈H1(Q) we have
o
sa
p
t
e
i
r
s
a
fi
t
e
o
s
rR
0
:H 1 2(∂Ω
γ
)
0
→
◦R
H
0
1
=
(Ω
Id
),
1
called
.
liftoperator,which
(cid:12) (cid:12) (cid:12) (cid:12)α 1 (cid:90) 0 α (γ 0 u)(x,0)dx− α 1 2 (cid:90) Qα u (cid:12) (cid:12) (cid:12) (cid:12) 2 ≤C (cid:90) Qα |∇u|2,
H2(∂Ω)
and
Proposition 1.14 (Integration by parts) The trace
o al p l e u ra ∈ to H r 1 e ( x Ω te ) n , d fo s r th a e ll n Φ ot ∈ io ( n H o 1( f Ω in )) t d eg , ration by parts: for (cid:12) (cid:12) (cid:12) (cid:12)α 1 (cid:90) 0 α (γ 0 u)(0,y)dy− α 1 2 (cid:90) Qα u (cid:12) (cid:12) (cid:12) (cid:12) 2 ≤C (cid:90) Qα |∇u|2.
(cid:90) (cid:90) (cid:90)
udiv(Φ)+ ∇u·Φ= γ (u)γ (v). 3. Let g∈L2(∂Q) be defined as follows
0 0
Ω Ω ∂Ω
g(x,0)=g(x,1)=0, ∀x∈(0,1),
Example. Thecaseoftheunitsquareisquiteinteresting.
Let us consider Ω=]0,1[2 and u∈C∞(Ω). We have, for g(0,y)=g(1,y)=1, ∀y∈(0,1).
all (x,y)∈]0,1[2,
Using the inequalities of question 2, prove that it
(cid:90) y does not exist a function u∈H1(Q) such that γ u=
u2(x,0)=u2(x,y)−2 u(x,z)∂ u(x,z)dz. 0
y g. We have thus proved that this function g does
0
1
not belong to the trace space H2(∂Q).
Then we get
InthecaseofregulardomainsofRd,thespaceH1(Ω)
u2(x,0)≤u2(x,y)+2 (cid:90) y |u(x,z)| (cid:12) (cid:12)∂
y
u(x,z) (cid:12) (cid:12)dz. can be characterized by the following properties: 0
0
Proposition 1.15 LetΩbeaboundedLipschitzdomain
Integrating with respect to x and using the Cauchy-
of Rd and u∈H1(Ω). The following are equivalent:
Schwarz inequality, we get
u∈H1(Ω);
(cid:82)1u2(x,0)dx ≤ (cid:82) u2+2(cid:107)u(cid:107) (cid:107)∂ u(cid:107) 0
0 Ω L2 y L2
≤ (cid:107)u(cid:107)2 +2(cid:107)u(cid:107) (cid:107)∇u(cid:107) , u¯∈H1(Rd), where u¯ is the extension of u over Rd
≤ 2(cid:107)u L (cid:107) 2 (cid:107)u(cid:107) , L2 L2 satisfying u¯=0 on Rd\Ω.
L2 H1
Introducci´on al m´etodo de los elementos finitos 5
It is also possible to consider the trace of functions Theorem 1.20 (Poincar´e-Wirtinger) LetΩbeacon-
in H1(Ω) when combined with a nonlinear function: nected bounded Lipschitz domain of Rd. We define
(cid:26) (cid:90) (cid:27)
Proposition 1.16 LetΩbeaboundedLipschitzdomain H˜1(Ω)= u∈H1(Ω), u=0 .
of Rd and T ∈C1(R;R) with a bounded derivative. Then Ω
There exists a constant C>0 such that
∀u∈H1(Ω), γ (Tu)=T(γ (u)).
0 0
∀u∈H˜1(Ω), (cid:107)u(cid:107) ≤C(cid:107)∇u(cid:107) .
L2 L2
This property still holds if T is Lipschitz continuous
and piecewiseC1 with a countable number of discontinu- Actually these theorems follow from the abstract in-
ity points for T(cid:48). equality:
Theorem 1.21 (Poincar´e) Let Ω be a bounded open
1.4 Poincar´e inequalities
subset of Rd. Let H be a Hilbert space, L:H1(Ω)→H
The trace operator allows us to give a clear charac-
terization of H1(Ω). be a continuous linear operator. We assume that L is
0 nonzerooverthesetofnonzerolocallyconstantfunctions.
Proposition 1.17 LetΩbeaboundedLipschitzdomain Then there exists a constant C>0 such that
of Rd. We have
∀u∈H1(Ω), (cid:107)u(cid:107)
L2
≤C((cid:107)∇u(cid:107)
L2
+(cid:107)L(u)(cid:107)H).
H 0 1(Ω)=Ker(γ 0 ). In particular the map u(cid:55)→(cid:107)∇u(cid:107) L2 +(cid:107)L(u)(cid:107)H is a norm
on H1(Ω), which is equivalent to the classical H1−norm.
The space H1(Ω) is thus the set of functions in H1(Ω)
0
which are equal to 0 on the boundary in the sense of Proof of Theorem 1.21. We proceed by reductio ad
traces. absurdum. Assume that the property is false. This
implies that there exists a sequence of functions u in
n
Let us go back to the previous example, dealing with H1(Ω) satisfying
the unit square, and assume that u is equal to 0 on the
boundary. A similar computation gives (cid:107)u n (cid:107) L2 ≥n((cid:107)∇u n (cid:107) L2 +(cid:107)L(u n )(cid:107)F).
(cid:90) By homogeneity we may assume that (cid:107)u (cid:107) =1 so that
u2≤2(cid:107)u(cid:107) (cid:107)∇u(cid:107) , n L2
L2 L2
Ω 1
hence
(cid:107)∇u
n
(cid:107)
L2
+(cid:107)L(u
n
)(cid:107)F ≤
n
. (1)
(cid:107)u(cid:107) L2 ≤C(cid:107)∇u(cid:107) L2 . Thus {u n } is bounded in H1(Ω) and consequently there
This inequality states that the L2−norm is controlled by existssomeu∈H1(Ω)suchthat{u n }weaklyconvergesto
the L2−norm of its derivatives, in the case of functions
uinH1(Ω),uptoasubsequence. TheembeddingH1⊂L2
is compact (here we use the fact that Ω is bounded) so
that are equal to 0 on the boundary.
that the sequence strongly converges in L2(Ω), which
Theorem 1.18 (Poincar´e-Friedrichs I) Let Ω be a implies that (cid:107)u(cid:107) L2 =1. Then the sequence {∇u n }
bounded Lipschitz domain of Rd. There exists a constant weakly converges to ∇u in L2(Ω), as {u } weakly
n
C>0 such that converges to u in H1(Ω),
∀u∈H
0
1(Ω), (cid:107)u(cid:107)
L2
≤C(cid:107)∇u(cid:107)
L2
. strongly converges to 0 in L2(Ω), because of (1),
Inparticularthemapu(cid:55)→(cid:107)∇u(cid:107) isanormonH1(Ω), hence ∇u=0. This implies that u is locally constant.
L2 0
which is equivalent to the classical H1−norm. Other Besides, we have
similar inequalities are available: L(u ) strongly converges to 0 in F, because of (1),
n
Theorem 1.19 (Poincar´e-Friedrichs II) Let Ω be a L(u n ) weakly converges to L(u) in F, see1.
connected bounded Lipschitz domain of Rd. Consider Γ
1Theresultfollowsfromtheproposition:
a closed part of ∂Ω with a non-empty relative interior
and define Proposition 1.22 LetH andF beHilbertspaces. Assumethat
L:H →F isacontinuouslinearoperator. If{un}weaklyconverges
H
Γ
1(Ω)={u∈H1(Ω), γ
0
(u)=0 on Γ}. to u in H, then {L(un)} weakly converges to L(u) in F.
There exists a constant C>0 such that
Proof. Assumethatun(cid:42)uinH. WefixT∈F(cid:48) andweaimat
provingthatT(Lun)→T(Lu). WehaveT◦L∈H(cid:48)andas{un}weakly
converges to u in H, we get (T◦L)(un)→(T◦L)u, i.e. T(Lun)→
∀u∈H Γ 1(Ω), (cid:107)u(cid:107) L2 ≤C(cid:107)∇u(cid:107) L2 . T(Lu). (cid:4)
6 Introducci´on al m´etodo de los elementos finitos
and thus L(u)=0. Since u is locally constant, by as- AsD(Ω)isdenseinH1(Ω)thereexistsasequence{g }∈
0 n
sumption on L, we obtain that necessarily u=0 which D(Ω) which converges to g in H1(Ω). But for any n, we
0
is in contradiction with the property (cid:107)u(cid:107) =1. This have
L2
concludes the proof. (cid:4)
(cid:90) (cid:90)
u·∇g + div(u)g =0, ∀u∈H (Ω),
n n div
1.5 Vector fields in L2 with divergence in L2. Defini- Ω Ω
tion of the normal trace by definition of the divergence in the sense of distribu-
Definition 1.23 (Space H div ) The space tions. Thus we can pass to the limit and get
H (Ω)={u∈(L2(Ω))d, div(u)∈L2(Ω)} (cid:90) (cid:90)
div
u·f+ div(u)div(f)=0, ∀u∈H (Ω),
div
Ω Ω
endowed with the norm
i.e. F =0 as it is expected. (cid:4)
(cid:107)u(cid:107) Hdiv =((cid:107)u(cid:107)2 L2 +(cid:107)div(u)(cid:107)2 L2 )2 1 Let us recall that H 1 2(∂Ω) is the image of the trace
operator of γ :H1(Ω)→L2(∂Ω) and that the norm of
is a Hilbert space. 0
this space can be defined by
Theorem 1.24 Let Ω be a regular bounded open subset
of Rd. The set of vector fields of class (C∞(Ω¯))d is dense (cid:107)φ(cid:107) 1 = inf (cid:107)u(cid:107) H1(Ω) .
H2(∂Ω) u∈H1(Ω)
in H
div
(Ω).
γ0(u)=φ
TheproofofProposition1.24isbasedupontheHahn-
We define
H−1
2(∂Ω) as the dual space of H
1
2(∂Ω) after
Banach theorem that we recall: identifying L2(∂Ω) to its own dual space.
Theorem 1.25 (Hahn-Banach) Let E be a Banach
Proposition 1.26 (Stokes formula) Let Ω be a Lip-
space and F a subspace of E. Then F is dense in E if, schitz continuous open subset of Rd. The mapping
and only if, any continuous linear form on E which is
zero over F is the zero form. γ
n
: (C∞(Ω¯))d → H−1 2(∂Ω)
u (cid:55)→ γ (u)=(u·n)
Proof of Proposition 1.24. In order to apply the
n |∂Ω
Hahn-Banach theorem, we consider a continuous linear where n denotes the outward normal unit vector at ∂Ω,
form F on H div (Ω) which is zero on (C∞(Ω¯))d. Let us has an unique continuous extension on the whole space
prove that it is zero on the whole space H div (Ω). H div (Ω). Moreover we have, for all u∈H div (Ω) and for
Since H (Ω) is a Hilbert space, the Riesz represen- all w∈H1(Ω),
div
tation theorem guarantees that F is represented by an
(cid:90) (cid:90)
element f ∈H div (Ω) by
Ω
u·∇w+
Ω
wdiv(u)=(cid:104)γ n u,γ 0 w(cid:105) H−1
2,H
1
2
.
(cid:90) (cid:90)
(cid:104)F,u(cid:105) H
d
(cid:48)
iv
,Hdiv =
Ω
f·u+
Ω
div(f)div(u), ∀u∈H div (Ω). Remark 1.27 If u∈(H1(Ω))d, we have in particular
u∈H (Ω) and the so-called normal trace γ has two
div n
By assumption, we have definitions. In fact, they coincide and we have
(cid:90) (cid:90)
f·φ+ div(f)div(φ)=0, ∀φ ∈(C∞(Ω¯))d. γ
0
u·n=γ
n
u.
Ω Ω
1
We denote f (resp. div(f)) the extension of f (resp.
In this case, γ
n
u belongs to H2(Ω).
div(f)) by 0 over Rd we get
Proof of Proposition 1.26. Letusrecallthat,byThe-
(cid:90) (cid:90) orem 1.13, there exists a continuous linear lift operator
f·φ+ div(f)div(φ)=0, ∀φ ∈(D(Rd))d.
Rd Rd R 0 :H 1 2(∂Ω)→H1(Ω) satisfying
This shows in particular that div(f)∈H1(Rd) and γ ◦R =Id .
0 0 1
H2(∂Ω)
∇(div(f))= f.
Let us proceed in two steps:
Since div(f)∈H1(Ω) and div(f)∈H1(Rd), then g:= 1
div(f)∈H1(Ω) (see Proposition 1.15) and ∇g= f. Then
Step 1. For all u∈H
div
(Ω) and φ ∈H2(∂Ω), we define
the linear 0 form F writes X u ∈H− 2 1 (∂Ω) as
(cid:90) (cid:90) (cid:90)
(cid:104)F,u(cid:105)
H
d
(cid:48)
iv
,Hdiv
=
Ω
u·∇g+
Ω
div(u)g, ∀u∈H
div
(Ω). X
u
(φ)=
Ω
(R
0
(φ)div(u)+u·∇R
0
(φ)), ∀φ ∈H 1 2(∂Ω).
Introducci´on al m´etodo de los elementos finitos 7
We have χ Ω¯ ≤∑m i=1 f i ≤1.
Let φ ∈D(Rd) which we restrict to Ω and we apply the
|X (φ)|≤(cid:107)R (φ)(cid:107) (cid:107)u(cid:107) ≤C(cid:107)φ(cid:107) (cid:107)u(cid:107) ,
u 0 H1 Hdiv H 1 2(∂Ω) Hdiv Stokes formula, see Proposition 1.26 :
(cid:90) (cid:90)
usingthecontinuityofR 0 . Thisshowsthat,ubeingfixed, φ div(u)+ u·∇φ =0.
X
u
is a continuous linear form on H 1 2(∂Ω) which satisfies Ω Ω
We replace φ by αφ so that we get
i
(cid:107)X (cid:107) ≤C(cid:107)u(cid:107) . (cid:90) (cid:90)
u H−1
2(∂Ω)
Hdiv
α
i
φ div(u)+ u·(φ∇α
i
+α
i
∇φ)=0.
Ω∩ωi Ω∩ωi
This inequality shows that the mapping
We may rewrite this equality as
u∈H div (cid:55)→X u
∈H−1
2(∂Ω)
(cid:90)
Rd
(1 |Ω∩ωi α i div(u)+1 |Ω∩ωi u·∇α i )φ
(cid:90)
i
r
s
em
lin
ai
e
n
a
s
r
t
a
o
n
p
d
ro
co
ve
nt
t
i
h
n
a
u
t
ou
th
s.
e
W
de
e
sir
d
e
e
d
no
p
t
r
e
op
γ
e
n
r
(
t
u
y
):
i
=
s s
X
a
u
tis
a
fi
n
e
d
d.
it +
Rd
(1
|Ω∩ωi
uα
i
)·∇φ = 0.
The above equality holds for any test function φ, which
Step 2. Let u∈(C∞(Ω¯))d. If w and w are functions in
1 2 means that
H1(Ω) such that γ w =γ w , then we obtain by integra-
0 1 0 2 v :=1 uα,
tion by parts
i |Ω∩ωi i
whichbelongsto(L2(Rd))d,hasadivergenceinthesense
(cid:90)
of distributions, which is identified as
((w −w )div(u)+u·∇(w −w ))
1 2 1 2
Ω (cid:90) 1 α div(u)+1 u·∇α
= γ (w −w )(u·n).
|Ω∩ωi i |Ω∩ωi i
0 1 2
∂Ω which also belongs to L2(Rd). As a consequence, v ∈
(cid:124) (cid:123)(cid:122) (cid:125) i
=0 H (Rd) and its support is in Ω∩ω which is an open
div i
star-shaped subset by assumption. In order to simplify
This shows that, for u∈(C∞(Ω¯))d for all w∈H1(Ω), by
the notations we assume that the open subset is a star-
taking w =w and w =R (γ (w)), we get
1 2 0 0 shaped domain with respect to 0. We now introduce
(cid:90) the family of functions defined by the homothetic ratio
(cid:104)u·n,γ 0 w(cid:105) = (wdiv(u)+u·∇w) θ ∈(0,1)
(cid:90)Ω (cid:16)x(cid:17)
= (R 0 ((γ 0 (w))div(u)+u·∇R 0 ((γ 0 (w))) vθ i (x)=v i θ .
Ω
= X u (γ 0 (w))=(cid:104)γ n u,γ 0 w(cid:105) H−2 1 ,H 1 2 . T M h o e re c o o v m er p i a t ct is s c u l p ea p r or t t ha o t f v e θ ac c h on fu v n er c g t e io s n to vθ i v is in in H Ω ( ∩ R ω d i ) .
i i div
This holds for any regular function and the proof is as θ goes to 1. For a fixed ε >0, we may find θ ∈(0,1)
concluded by density, using the continuity of γ . (cid:4) such that
n
(cid:107)v −vθ(cid:107) ≤ε.
i i Hdiv(Ω)
Theorem 1.28 LetΩbeaLipschitzcontinuousbounded
But since vθ has a compact support in Ω∩ω, we may
open subset of Rd and let us denote H (Ω) the closure i i
0,div useaconvolutionprocessthatallowsustoregularizethe
of (D(Ω))d in H (Ω). Then
div function and prevent the support of the function from
spreading out of Ω∩ω. Thus there exists η >0 such
H (Ω)=Ker(γ ). i
0,div n
that
Proof of Theorem 1.28. It is clear that H 0,div (Ω)⊂ ρ η (cid:63)vθ i ∈(D(Ω∩ω i ))d,
K
op
e
e
r(
r
γ
a
n
t
)
or
a
.
s
L
(
e
D
t
(
u
Ω
s
)
p
)d
ro
⊂
ve
K
t
e
h
r(
a
γ
t
n )
Ke
b
r
y
(γ
d
)
efi
⊂
n
H
ition
(
o
Ω
f
)
t
.
he trace (cid:107)vθ i −ρ η ∗vθ i (cid:107) Hdiv ≤ε.
n 0,div As a consequence, we obtain
Let u ∈ H (Ω) such that γ (u) = 0. Since Ω is
div n (cid:107)v −ρ ∗vθ(cid:107) ≤2ε.
bounded and Lipschitz continuous, we can prove that i η i Hdiv
there exists a finite open covering of Ω¯ by open subsets Thisprocessallowsustoapproximateeachv
i
byfunctions
ω, i∈{1,...,m}, such that ω ∩Ω is a star-shaped subdo- of (D(Ω))d for the H −norm. Using the properties of
i i div
main of Rd. We now introduce aC∞ partition of unity α, we get
i
m m
(α) subordinate to this open covering: there exists a
i i u=∑uα =∑v.
family {f} such that i i
i i=1,...,m i=1 i=1
∀i∈{1,...,m}, f ∈C∞(Rd), As the sum is finite, the homothetic mapping combined
i
with the regularization may be used on each v, which
i
∀i∈{1,...,m}, supp(f)⊂ω, allows us to conclude. (cid:4)
i i
8 Introducci´on al m´etodo de los elementos finitos
2. Weak formulation of elliptic problems 3. L is continuous:
Solving a PDE leads to different questions: ∀u∈H, |L(u)|≤(cid:107)L(cid:107)(cid:107)u(cid:107) .
H
the solution or the coefficients of the PDE may be
We consider the abstract problem
not regular enough to guarantee a classical sense
(cid:26)
to the equation; Find u∈H such that
(P)
a(u,v)=L(v), ∀v∈H.
the solution may be regular but the functional
spacemaynothavesuitablepropertiestoguarantee Problem (P) admits a unique solution. Moreover,
existence and / or uniqueness of the solution in
(cid:107)L(cid:107)
this space. (cid:107)u(cid:107) ≤ .
H
α
Thus we define a weaker notion of solution, even if
If a is symmetric, then u is the unique minimizer on H
wehaveinmindthatitshouldmatchtheclassicalnotion
of the functional
when regularity is met. The general method consists in
proceeding this way: 1
J(v)= a(v,v)−L(v).
2
to find a solution in a functional space which is
Proof of Theorem 2.1.
weaker than the one that was primarily targetted;
Symmetric case I. Assume that a(·,·) is symmetric.
to determine a mathematical formulation by using Let us prove that the variational problem and the mini-
test functions and formal integration by parts; mization problems are equivalent.
to ensure that 1) classical solutions are weak solu- Writing v=u+v−u, we have
tions, 2) weak solutions with additional regularity
1
properties are classical solutions. J(v) = (a(u,u)+2a(u,v−u)+a(v−u,v−u))
2
−L(u)−L(v−u)
The difficulties are the following ones:
= J(u)+(a(u,v−u)−L(v−u))
the choice of the functional space is crucial: it is 1
+ a(v−u,v−u).
non trivial and not necessarily unique; 2
If u is a solution of a(u,·)=L, we have
if the notion of solution is too weakened, the exis-
tence issue is easier but the uniqueness properties 1
J(v)−J(u)= a(v−u,v−u)≥α(cid:107)v−u(cid:107)2,
may not hold or be harder to prove;
2
if the notion of solution is not weakened enough, hence J(u)=min J(v) and it is the unique solu-
v∈V
the uniqueness issue is easier but the existence of tion of the minimization problem.
the solution may be too hard to prove.
Conversely if u∈V is a solution of
2.1 Lax-Milgram theorem
J(u)≤J(v), ∀v∈V,
Many problems in applied mathematics arise out
of a variational formulation. In the case of so-called then for all h∈V and for all t∈R, we have J(u+
elliptic partial differential equations, the basic existence th)≥J(u), i. e.
and uniqueness result is based on an abstract theorem,
t2
the Lax-Milgram theorem, which provides a powerful t(a(u,h)−L(h))+ a(h,h)≥0, ∀t∈R.
guideline in the analysis of these problems. 2
Necessarily we get a(u,h)=L(h), for all h∈V, i. e.
Theorem 2.1 (Lax-Milgram) LetH beaHilbertspace,
a(u,·)=L.
a(·,·) a bilinear form on H, L a linear form on H. We
assume that Symmetric case II. The well-posedness of the varia-
tional problem can be proved with two methods:
1. a(·,·) is continuous:
By assumption, a(·,·) is a scalar product on H
∀u,v∈H, |a(u,v)|≤(cid:107)a(cid:107)(cid:107)u(cid:107) (cid:107)v(cid:107) . which is equivalent to the usual scalar product on
H H
H. Then, (H,a(·,·)) is the same topological space
2. a(·,·) is coercive: as (H,(·,·) H ) and the linear form L is continuous
on this new Hilbert space. The result follows from
∃α >0, ∀u∈H, a(u,u)≥α(cid:107)u(cid:107)2. the Riesz representation theorem.
H
Introducci´on al m´etodo de los elementos finitos 9
We directly study the minimization problem by Remark 2.2 The Lax-Milgram theorem provides suffi-
consideringaminimizingsequenceandprovingthat cient conditions to find a unique solution of an abstract
it is a Cauchy sequence by using the parallelogram problem. These conditions are not necessary! For in-
law. stance in finite dimension, i.e. H =Rn, the continuity
assumptions are obvious and the coercivity assumption is
General case. The well-posedness of the variational expressed as a condition over the matrix that represents
problem can be proved as follows. For all u∈H, the the operator. Indeed denoting {e} the canonical
i i=1,...,n
form v∈H(cid:55)→a(u,v) is continuous so that there exists a basis of Rn, X =(x) the coordinates of u∈Rn (i.e.
i i=1,...,n
unique Au∈H such that u=∑n
i=1
x
i
e
i
), we denote A=(a(e
j
,e
i
))
ij
so that we have
a(u,u)=(AX,X)Rn where (·,·)Rn is the usual scalar prod-
a(u,v)=(Au,v) H , ∀v∈H, uct on Rn. Then, by assumption of coercivity
a
is
s
c
a
le
c
a
o
r
n
t
s
h
eq
a
u
t
ence of the Riesz representation theorem. It
2
1(cid:0) (AX,X)+(X,AtX) (cid:1)
Rn
= (AX,X)Rn
= a(u,u)
A is linear; ≥ α(cid:107)u(cid:107)2 Rn =α(cid:107)X(cid:107)2 Rn .
Aiscontinuous: ifonetakesv=Auinthecontinuity Thus coercivity of a(·,·) means that A+At is s.p.d. The
assumption of a we find theorem then becomes: if A+At is s.p.d. then A is in-
vertible. This is clearly a sufficient condition but not a
(cid:107)Au(cid:107)2 =a(u,Au)≤(cid:107)a(cid:107)(cid:107)u(cid:107) (cid:107)Au(cid:107) , necessary one.
H H H
so that In the problems that will be considered, H is the
functional space (L2, H1, H1, etc.), u denotes the (weak)
0
(cid:107)Au(cid:107) ≤(cid:107)a(cid:107)(cid:107)u(cid:107) , ∀u∈H, solution of the problem and functions v serve as test
H H
functions. Besides,
A is injective: indeed, by using the coercivity prop-
theLax-Milgramtheoremrequiressomeconstraints:
erty of a, we find that
in particular, the test functions and the solution
should belong to the same functional space. This
(Au,u) =a(u,u)≥α(cid:107)u(cid:107)2, ∀u∈H,
H H isthereasonwhythederivationoftheweakformu-
lation relies on an equilibrium between the deriva-
and thus
tives of the solution and the derivatives of the test
functions.
(cid:107)Au(cid:107) ≥α(cid:107)u(cid:107) , ∀u∈H.
H H
The regularity of the functions in H cannot be
In particular, we have Au=0⇒u=0.
completely independent from the bilinear form a.
If the functions in H are too regular, the coerciv-
By the Riesz representation theorem, L can be repre-
ity property will not be obtained; conversely if
sented by an element (cid:96)∈H and we finally have to prove
the functions in H are not sufficiently regular, the
that there exists u∈H such that Au=(cid:96). Let ρ >0 and
continuity of a will not be obtained.
T : H (cid:55)→ H − Consider a(u,v)= (cid:82) u(−∆v). Then ∆v has
Ω
u (cid:55)→ Tu=u−ρ(Au−(cid:96)). to be defined, which leads us to define H =
H2(Ω)∩H1(Ω). The bilinear form is continu-
0
Our problem reduces to the proof of existence of a fixed-
ous, since
point for T. In a Hilbert space, this can be achieved by
showing that T is a contraction. |a(u,v)| ≤ (cid:107)u(cid:107) (cid:107)∆v(cid:107)
L2 L2
≤ (cid:107)u(cid:107) (cid:107)v(cid:107)
L2 H2
(cid:107)Tu−Tv(cid:107)2 H = (cid:107)u−v(cid:107)2 H +ρ2(cid:107)Au−Av(cid:107)2 H ≤ (cid:107)u(cid:107) H (cid:107)v(cid:107) H .
−2ρ(u−v,A(u−v))
H
≤ (cid:107)u−v(cid:107)2 +ρ2(cid:107)a(cid:107)2(cid:107)u−v(cid:107)2 Unfortunately the coercivity is missing: if
H H
−2ρα(cid:107)u−v(cid:107)2 u∈H we have
H
≤ (1−2ρα+ρ2(cid:107)a(cid:107)2)(cid:107)u−v(cid:107)2.
H a(u,u) = (cid:82) u(−∆u)
Ω
(cid:82)
= udiv(−∇u)
For ρ sufficiently small, T is a contraction, which con- Ω
cludes the proof. (cid:4) = (cid:82) ∂Ω u(−∇u)·n+ (cid:82) Ω |∇u|2
= (cid:82) |∇u|2.
Ω
10 Introducci´on al m´etodo de los elementos finitos
Clearly there is no α >0 such that The variational problem admits a unique solution u.
What are the regularity properties of the weak solution?
(cid:107)∇u(cid:107)2 ≥α(cid:107)u(cid:107)2
What is the link with the initial problem?
L2 H
Note that ∇u∈(L2(Ω))d and D(Ω)⊂H so that we
since it would imply that H2(Ω)∩H1(Ω)= can choose v∈D(Ω) as a test function:
0
H1(Ω).
0 (cid:90) (cid:90)
− Consider a(u,v)= (cid:82) ∇u∇v and H =H1(Ω). ∇u·∇φ = fφ, ∀φ ∈D(Ω).
Ω Ω Ω
The continuity of the bilinear form is guar-
By definition, the divergence of ∇u is equal to −f in the
anteed but the coercivity is missing because
sense of distributions. Then u is a solution of −∆u= f
a(u,u)=0 implies that u is a constant func-
in the sense of distributions. Actually it is possible to
tion. Then u≡1 is a counter example for the
prove the following regularity result:
existence of a coercivity constant.
Theorem 2.3 (Elliptic regularity) AssumethatΩis
2.2 Example 1: Poisson problem aC2 boundeddomainofRd. Let f ∈L2(Ω)andu∈H1(Ω)
Homogeneous Dirichlet boundary conditions. As- 0
the unique variational solution of the Poisson problem
sume that f ∈L2(Ω). We consider the following PDE (cid:0) (1)(cid:1)
with homogeneous Dirichlet conditions P . We have
problem: w
u∈H2(Ω),
(cid:26)
(cid:0) (1)(cid:1) −∆u = f in Ω,
P s u = 0 on ∂Ω. (cid:107)u(cid:107) H2 ≤C(cid:107)f(cid:107) L2 , where C is a constant which only
depends on Ω.
Consider a regular test function and let us deal with
The proof of this theorem is technical and voluntar-
formal computations. Multiplying by v, integrating over
ily omitted. Interestingly all the second order partial
Ω and integrating by parts, we get
derivatives of u are functions in L2. But the theorem
(cid:90) (cid:90) (cid:90) contains an important regularity assumption on the do-
∇u·∇v− v(∇u·n)= fv.
main. Thisconditioncanbeweakened(forinstance, ifΩ
Ω ∂Ω Ω
isconvexandpolygonaltheresultisstillvalid)butsome
Now let us discuss this equality:
counter-examples do exist otherwise: typically if Ω has
a re-entrant corner, one may find variational solutions
Integrals over Ω only deal with derivatives of order
in H1(Ω)\H2(Ω).
1 at most. Thus looking for the continuity and 0
coercivity of the bilinear form leads us to consider Example. Consider the domain defined in polar coor-
(a subspace of) H1(Ω). dinates by Ω={(r,θ),r≤1,0≤θ ≤α}, as in Fig. 1.
No boundary condition on ∇u·n is prescribed. But
we target the definition of a functional space that
containsthesolutionuandthetestfunctionsv. As
Ω
the solution should be zero on the boundary, we
may impose this condition on the test functions
α
as well, hence killing the boundary term. The
resulting functional space is therefore H1(Ω).
0
The weak problem (or variational problem) associated
(cid:0) (1)(cid:1)
to the strong problem P is
s
 Find u∈H1(Ω) such that
 (cid:90) 0 (cid:90) Figure 1. The domain Ω
(cid:0)
P
(1)(cid:1)
∇u·∇v= fv,
w
 Ω for all v∈ Ω H
0
1(Ω). Thefunctionu˜:(r,θ)(cid:55)→rα π sin(π
α
θ)isharmonic. Thus
u˜ satisfies
(cid:26)
−∆u˜ = 0 in Ω,
(cid:0) (1)(cid:1)
Exercise 2 Prove that the variational problem P
w u˜ = g on ∂Ω.
admits a unique solution.
where g is a continuous function on ∂Ω satisfying:
Exercise 3 Let f ∈Lp(Ω), p∈[1,+∞]. Which values of
g(r,α)=g(r,0)=0, 0≤r≤1.
p can be considered in order to apply the same method
as above? Define χ ∈C∞(R2) such that
ε
Introducci´on al m´etodo de los elementos finitos 11
χ (r,θ)=1 for 0≤r≤ 1, The Lax-Milgram cannot directly be applied to this formu-
ε 2
lation: H1(Ω) is not a vector space, let alone a Hilbert
χ (r,θ)=0 for 1+ε ≤r. g
ε 2 space! Nevertheless this formulation does not require
and define u:=u˜χ . Thus u satisfies the introduction of the lift of the boundary term, whose
ε
computation would be difficult in practice; moreover this
(cid:26)
−∆u = f ε in Ω, formulation is used in practical computations.
u = 0 on ∂Ω.
Exercise 4 Prove that the solution u of the problem
with (cid:0) (2(cid:48)(cid:48))(cid:1)
P is also the unique solution of the minimisation
w
f ε :=−∆u˜∈L2(Ω), problem
J(u)= inf J(v),
supp(f
ε
)⊂Ω∩{(r,θ),
2
1 ≤r≤
2
1+ε}.
v∈Hg 1(Ω)
Moreover, u≡u˜ on Ω∩{(r,θ),0≤r≤ 1}. In particular, with
2 1(cid:90) (cid:90)
because of the behaviour of u (or u˜) near the corner, we J(v)= |∇v|2− fv.
can prove that u∈H1(Ω)\H2(Ω) for α >π. (cid:3) 2 Ω Ω
Remark 2.5 The elliptic regularity properties proved in
Non-homogeneousDirichletboundaryconditions.
Theorem 2.3 can be extended to the Poisson problem with
Assume that f ∈L2(Ω) and g∈H 1 2(∂Ω). We consider non-homogeneous Dirichlet boundary conditions if we as-
the following PDE problem: 3
sume furthermore that g∈H2(Ω) which is, by definition,
(cid:0) (2)(cid:1)
(cid:26)
−∆u = f in Ω,
the image of H2(Ω) by the trace operator.
P
s u = g on ∂Ω.
Remark 2.6 We consider the Poisson problem defined
The choice of the functional space for g relies on the on a unit square Ω=]0,1[2 with a source term f ≡0. We
fact that the functional space for the variational formu- consider Dirichlet boundary conditions: for this purpose,
lation is likely to be H1(Ω), according to the previous we denote
example. The trace of the solution should be in H 1 2(∂Ω). Γ:=]0,1[×{0}
Dealing with less regular boundary data would lead us and consider the problem
outside the Lax-Milgram framework.

By Theorem 1.13, there exists R 0 g∈H1(Ω) such that  −∆u = f in Ω,
γ (R g)=g. We define u˜=u−R g so that the problem u = 0 on Γ,
0 0 0
(cid:0) (2)(cid:1)  u = 1 on ∂Ω\Γ.
P is equivalent to the following one
q
(cid:26) The boundary term
(cid:0) P s (2(cid:48))(cid:1) −∆u u ˜ ˜ = = 0 f+∆(R 0 g) i o n n Ω ∂ , Ω. (cid:26) 0 if x∈Γ,
g(x)=
1 if x∈∂Ω\Γ.
AsR g∈H1(Ω),wehave∇(R g)∈(L2(Ω))d and∆(R g)=
0 0 0
div(∇(R 0 g))∈H−1(Ω) by Proposition 1.7. Thus the vari- does not belong to H 1 2(∂Ω) (see Exercise 1). As a con-
ational formulation of
(cid:0)
P
(2(cid:48))(cid:1)
reduces to sequence, we cannot use the lift operator to define a
s
variational formulation in H1(Ω). In fact the solution
(cid:0) P ( w 2(cid:48))(cid:1)
  (cid:90) Fin
∇
d
u˜
u˜
·∇
∈
v˜
H
=
0 1( (cid:90) Ω)
f
s
v˜
u
+
ch
(cid:104)∆
t
(
h
R
a
0
t
g),v˜(cid:105) H−1,H1 ,
o
o
f
f
t
H
hi
1 2
s
(∂
p
O
ro
)
b
)
l
.
em
In
c
t
a
e
n
re
n
st
o
i
t
ng
b
l
e
y
l
,
on
w
g
h
t
e
o
n
H
u
1
s
(
in
Ω
g
)
t
(
h
b
e
y
fi
de
n
fi
it
n
e
it
e
io
le
n
-
 Ω for all v˜∈ Ω H1(Ω). 0 ment method, the discretization of this problem leads to
0
a well-posed problem. But when considering the solution
This variational formulation falls into the scope of the u , then (cid:107)u (cid:107) explodes as h goes to 0, illustrating the
h h H1
Lax-Milgram theorem, hence u˜ is uniquely defined. Let ill-posedness of the (continuous) variational problem in
us remark that the duality term can be expressed as: H1(Ω). See also the Problem given in Section 7.3.
(cid:90)
(cid:104)∆(R g),v˜(cid:105) =− ∇(R g)·∇v˜. Non-homogeneousNeumannboundaryconditions.
0 H−1,H1 0
0 Ω
AssumethatΩisconnected, f
∈L2(Ω)andg∈H−1
2(∂Ω).
Remark 2.4 Considering H g 1(Ω):={u∈H1(Ω),γ 0 u= We consider the following PDE problem:
g}, the function u=u˜+R g is the unique solution of
0 (cid:26)
(cid:0) (3)(cid:1) −∆u = f in Ω,
 Find u∈H1(Ω) such that P s ∇u·n = g on ∂Ω.
(cid:0) (2(cid:48)(cid:48))(cid:1)
 (cid:90) g (cid:90)
P w ∇u·∇v= fv, The choice of the functional space for g is quite natural:
 Ω
for all v∈
Ω
H1(Ω). the functional space for the variational formulation is
0
12 Introducci´on al m´etodo de los elementos finitos
likely to be (a subspace of) H1(Ω), according to the Using the compatibilty condition we get
previous examples, so that ∇u∈(L2(Ω))d. As we ask for
(cid:90) (cid:90)
div(∇u)=∆u=−f ∈L2(Ω), if a solution exists, we will ∇u·∇v= fv+(cid:104)g,v(cid:105) . (2)
necessarily get ∇u∈H , which allows us to give a weak Ω Ω
H−1
2,H
1
2
div
sense to the normal trace at the boundary of ∇u·n in Taking test functions φ ∈D(Ω), the influence of the
the space H−1 2(∂Ω). boundary terms is dropped and we obtain, as in the case
In this problem, compatibility conditions emerge: of Dirichlet boundary conditions, −∆u= f in the sense
of distributions. Since ∇u∈(L2(Ω))d and f ∈L2(Ω), the
If the problem admits a solution, then integrating
equation states that ∇u∈H , hence the normal trace
div
over Ω we obtain (the data are assumed to be ∇u·n is defined in H− 2 1 (∂Ω) and by the Stokes formula,
regular):
see Proposition 1.26,
(cid:90) (cid:90) (cid:90) (cid:90)
(cid:90) (cid:90)
f = (−∆u)=− ∇u·n=− g.
∇u·∇v+ div(∇u)v=(cid:104)∇u·n,v(cid:105) . (3)
Ω Ω ∂Ω ∂Ω Ω Ω H−1 2,H 1 2
Existence of a solution requires a necessary condi- By comparison between (2) and (3), as f =−∆u, we
tion. If
g∈H−1
2(∂Ω), the compatibility condition obtain
writes ∇u·n=g, on ∂Ω
(cid:90)
f =−(cid:104)g,1(cid:105) .
Ω
H−1
2,H
1
2
in a weak sense.
The solution cannot be unique: we may add any
Exercise 6 We consider the Poisson problem with non-
constant to a solution, thus defining another solu-
homogeneous Fourier (or Robin) boundary conditions:
tion. An additional condition is required in order
to select a unique solution. A natural way, since Ω (cid:26) −∆u = f in Ω,
is assumed to be connected, consists in fixing the ∇u·n+αu = g on ∂Ω,
constant by imposing
with α >0.
(cid:90)
u=0.
Define the variational formulation.
Ω
Is the problem well-posed?
In the general approach we choose a regular test
function v and proceed as before. The boundary value
Let us present and briefly discuss more sophisticated
of the solution is not prescribed so that no condition is
models.
imposed on the test functions v. By contrast we impose
that u has zero mean value so that the same condition 2.3 Example 2: General linear elliptic operators
should be imposed to the test functions. We finally Letx(cid:55)→K (x)∈Rd×d beaboundedmeasurablemap-
obtain the variational formulation ping. We assume that K is symmetric positive definite
 Find u∈H˜1(Ω) such that and uniformly coercive:
 (cid:90) (cid:90)
(cid:0) P ( w 3)(cid:1)  Ω ∇u
fo
·
r
∇
a
v
ll
=
v∈
Ω
H
f
˜
v
1(
+
Ω
(cid:104)
)
g
.
,v(cid:105) H−2 1 ,H 1 2 , ∃α >0, (K (x)ξ,ξ)≥α|ξ|2, ∀ξ ∈Rd, for a.e. x∈Ω.
We consider the problem
Exercise 5 Prove that the variational problem admits (cid:0) (4)(cid:1) (cid:26) −div(K ∇u) = f in Ω,
a unique solution. P s u = g on ∂Ω,
The variational problem admits a unique solution. It 1
with g∈H2(∂Ω). The associated variational problem is
is possible to get a formulation with test functions in
H1(Ω) instead of H˜1(Ω). Indeed, for any v∈H1(Ω), we  Find u∈H1(Ω) such that
consider v˜=v−m(v) where
m(v)=|Ω|−1(cid:82)
Ω v. Then we (cid:0) P w (4)(cid:1)
 (cid:90)
(K ∇u)·
g
∇v)=
(cid:90)
fv,
get
(cid:90) (cid:90)

fo
Ω
r all v∈H1(Ω).
Ω
∇u·∇v˜= fv˜+(cid:104)g,v˜(cid:105) . 0
Ω Ω
H−1
2,H
1
2 The adaptation to the non-homogeneous case is straight-
Using ∇v=∇v˜,
forward. In the Neumann case, the difficulty only relies
(cid:90) (cid:90) (cid:18)(cid:90) (cid:19) on the understanding of the boundary condition which
∇u·∇v = fv−m(v) f should be read as
Ω Ω Ω
+(cid:104)g,v(cid:105) H−2 1 ,H 1 2 −m(v)(cid:104)g,1(cid:105) H−2 1 ,H2 1 . (K ∇u)·n=g.
Introducci´on al m´etodo de los elementos finitos 13
1 construction of T, this proves that u is non-negative a.e.
on Ω. (cid:4)
The weak maximum principle may admit equivalent
0.5
versions in the discrete framework: in particular the
weak maximum principle holds in the case of a P1 finite
element approximation, see Proposition 5.12 whereas it
−1 −0.5 0.5 1 is not valid in the P2 approximation.
2.4 Example 3: Reaction-diffusion.
−0.5
We consider the problem
(cid:26)
−∆u+ηu = f in Ω,
−1
∇u·n = g on ∂Ω,
Figure 2. The nonlinear function T
with η >0. The condition η >0 is important because
there exists η <0 and source terms f for which no so-
Let us conclude this subsection with an important lution exists (this is related to the existence of positive
property of elliptic problems: the weak maximum princi- eigenvalues of the operator −∆). When dealing with
ple. Dirichlet boundary conditions, there is no difficulty and
the variational formulation can be derived in straightfor-
Theorem 2.7 (Weak maximum principle) Letx(cid:55)→
ward way. In the case of Neumann boundary conditions,
K (x)∈Rd×d be a bounded measurable mapping. We as-
it is different: integrating over Ω,
sumethatK issymmetricpositivedefiniteanduniformly
(cid:90) (cid:90) (cid:90)
coercive. Let f ∈L2(Ω) and g∈H2 1 (∂Ω). Let u∈H1(Ω) f =η u− g
the unique solution of (cid:0) P (4)(cid:1) . Ω Ω ∂Ω
w
If f and g are non-negative a.e., then u is non- so that there is no requirement such as the compatibility
negative a.e. condition on the data. Moreover, the mean value of
u is prescribed and cannot be fixed. The variational
Proof of Theorem 2.7. Let T ∈C1(R;R) be a nonde- formulation is
creasing function, with bounded derivative, such that  Find u∈H1(Ω) such that
T(s)=0 if and only if s≥0, see Figure 2.  (cid:90) (cid:90) (cid:90)
Asu∈H1(Ω),byTheorem1.9wededucethatT(u)∈ ∇u·∇v+η uv= fv,
H1(Ω) and γ 0 T(u)=T(γ 0 u)=T(g) almost every where.

fo
Ω
r all v∈H1(Ω
Ω
).
Ω
Since g ≥ 0 and by construction of T, we have that
Exercise 7 Prove that the above variational problem
T(g)=0 and thus T(u)∈H1(Ω). We can therefore take
0 admits a unique solution.
T(u) as a test function in the variational formulation of
the problem:
2.5 Example 4: Convection-diffusion.
(cid:90) (cid:90) Let f ∈L2(Ω) and b∈(C1(Ω¯))d. We consider the
K ∇u·∇(T(u))= fT(u).
problem
Ω Ω
(cid:26)
We have ∇T(u)=T(cid:48)(u)∇u and, then −∆u+b·∇u = f in Ω,
u = 0 on ∂Ω,
(cid:90) (cid:90)
T(cid:48)(u)(K ∇u,∇u)= f T(u). The order of derivative for the convection term b·∇u
Ω(cid:124)(cid:123)(cid:122)(cid:125)(cid:124) (cid:123)(cid:122) (cid:125) Ω(cid:124)(cid:123)(cid:122)(cid:125)(cid:124)(cid:123)(cid:122)(cid:125)
is lower than the one of the diffusion term. Thus the
≥0 ≥0 ≥0 ≤0
functionalspaceisH1(Ω)andthevariationalformulation
0
Theneachintegralisequalto0andtheintegrandsvanish writes
almost everywhere. By the coercivity assumption on K ,
 Find u∈H1(Ω) such that
it follows that  (cid:90) 0(cid:90) (cid:90)
∇u·∇v+ (b·∇u)v= fv,
T(cid:48)(u)|∇u|2=0, almost everywhere, 
fo
Ω
r all v∈H1(
Ω
Ω).
Ω
0
and thus
The bilinear form considered here is not symmetric and
this is unavoidable due to the advection term. The conti-
T(cid:48)(u)∇u=0, almost everywhere.
nuityofa(·,·)isobviousbutitscoercivityisquestionable
since
By Theorem 1.9, this proves that ∇(T(u))=0 and since (cid:90)
T(u)∈H
0
1(Ω), we eventually obtain that T(u)=0. By a(u,u)=(cid:107)∇u(cid:107)2 L2 +
Ω
(b·∇u)u
14 Introducci´on al m´etodo de los elementos finitos
has not necessarily the good sign. More precisely, the and the variational problem is defined as
second term should be controlled by the first one to

ensure the coercivity. For this there are two possible  F (cid:90) ind u∈H D such t (cid:90) hat (cid:90)
ways to proceed: 2µD(u):D(v)+ λ div(u)div(v)= f·v,
Method 1:
 Ω
for all v∈H D .
Ω Ω
(cid:12) (cid:12) (cid:90) (cid:12) (cid:12) This formulation is well-posed: existence and uniqueness
(cid:12) (cid:12) Ω (b·∇u)u(cid:12) (cid:12) ≤ (cid:107)b(cid:107) ∞ (cid:107)∇u(cid:107) L2 (cid:107)u(cid:107) L2 ofthesolutioncanbeprovedbyusingtheKorninequality
≤ C (cid:107)b(cid:107) (cid:107)∇u(cid:107)2 to prove the coercivity:
Ω ∞ L2
whereC Ω denotes the Poincar´e-Friedrichs constant. Proposition 2.8 (Korn inequality) Let Ω be a Lips-
Thus ifC Ω (cid:107)b(cid:107) ∞ <1, the bilinear form is coercive. chitz connected bounded domain of Rd and assume that
|Γ |>0. The general case, is more intricate.
D
Method 2, based upon an integration by parts:
There exists a constant C>0 such that
(cid:90) (cid:90) u2
− (b·∇u)u = div(b) ∀u∈H , (cid:107)∇u(cid:107) ≤C(cid:107)D(u)(cid:107) .
2
D L2 L2
Ω Ω
≤ 1
2
(cid:107)(div(b))+(cid:107) L∞C
Ω
2(cid:107)∇u(cid:107)2
L2
.
Proof of Proposition 2.8. Let us prove the inequality
in the case Γ =∂Ω, i.e. H =H1(Ω). We have
Thus if (cid:107)(div(b))+(cid:107) L∞C
Ω
2 <2 the bilinear form is D D 0
coercive. Mostimportantcasesdealwithdiv(b)≤0 (cid:90) (cid:90) 1(cid:90) 1(cid:90)
in which case the condition is obviously satisfied.
|D(u)|2= D(u):∇u= |∇u|2+ (∇u)t:∇u.
2 2
Ω Ω Ω Ω
If one of the above smallness assumptions on (cid:107)b(cid:107) L∞ or The result is proved if the last term is non-negative. We
(cid:107)div(b)+(cid:107) L∞ is satisfied, then the variational problem is write
well-posed. (cid:90) (cid:90)
(∇u)t:∇u= ∑∂u ∂ u
i j j i
Ω Ω i,j
2.6 Example 5: Linear elasticity.
We consider the PDE which describes the displace- thenweintegratebypartsusingtheboundaryconditions
ment of an elastic solid when submitted to a force field.
The domain Ω⊂Rd represents the solid at rest. The (cid:82) Ω (∇u)t:∇u = − (cid:82) Ω ∑ i,j ∂ i 2 j u j u i
vector field u:Ω→Rd represents the displacement of a = − (cid:82) ∇(div(u))·u
Ω
material point under the effect of the force field. Thus a = (cid:82) (div(u))2≥0.
Ω
material point at position x at rest is displaced at posi-
(cid:4)
tion x+u(x). We now introduce the Jacobian matrix ∇u
and the strain tensor D(u)= 1(∇u+(∇u)t). The Cauchy
2 The Korn inequality provides the coercivity of the bi-
stress tensor σ in the solid is ruled by a law which takes linearforminthevariationalformulationoftheelasticity
the form
problem.
σ =λTr(D(u))Id+2µD(u)=λ div(u)Id+2µD(u),
3. Weak formulation of saddle-point
where λ and µ are the so-called Lam´e coefficients which
problems
quantify the elastic behaviour of the solid. The equilib-
rium of the solid under the load imposed by an external
We aim at targetting mathematical problems that
force f reads
do not fall into the scope of the Lax-Milgram theorem.
−div(σ)= f,
The main result will provide necessary and sufficient
i.e. conditions for the solvability of a class of variational
−2µ div(D(u))−λ∇(div(u))= f. problems.
Let us recall the Banach theorem:
The physical boundary conditions that are classically
usedleadustoconsiderhomogeneousDirichletconditions Theorem 3.1 (Banach) LetE andF beBanachspaces
u=0 on a part Γ D of the domain models the clamping and T :E →F a continuous linear operator. If T is bi-
of the solid whereas an homogeneous Neuman condition jective, then T−1 is continuous.
σ·n=0 on Γ =∂Ω\Γ models a no-stress situation on
N D
the other part of the boundary. The natural framework The proof of the theorem is a consequence of the
is theoremoftheopenmapping,whichfollowsfromBaire’s
H ={u∈(H1(Ω))d,γ (u)=0 on Γ } lemma. It admits a corollary:
D 0 D
Introducci´on al m´etodo de los elementos finitos 15
Corollary 3.2 (Banach closed range theorem) Let If one of the properties is satisfied, the unique solution u
E and F be Banach spaces and T :E→F a continuous satisfies
linear operator. The following are equivalent:
(cid:107)u(cid:107) ≤
(cid:107)L(cid:107) W(cid:48)
.
V
α
1. There exists α >0 such that
Proof of Theorem 3.3. Since a˜(·,·) is linear and con-
∀x∈E, (cid:107)x(cid:107) E ≤α(cid:107)T(x)(cid:107) F . tinuous with respect to the variable w, the Riesz rep-
resentation theorem gives the existence of an operator
2. T is injective and its image is closed. A˜:V →W(cid:48) such that
ProofofCorollary3.2. AssumethatT isinjectiveand (cid:10) A˜v,w (cid:11) =a˜(v,w), ∀w∈W.
W(cid:48),W
itsimageisclosed. Byassumption,T(E)isclosed,sothat
T(E) is a Banach space and T is a bijective continuous As a˜(·,·) is a continuous bilinear form, A˜ is itself linear
linear operator from E onto T(E): it is an isomorphism. and continuous and its norm is controlled by (cid:107)a˜(cid:107). Let
Thus there exists α >0 such that (cid:107)T−1(y)(cid:107) ≤α(cid:107)y(cid:107) , us prove the equivalence.
E F
for all y∈T(E), i. e. (cid:107)x(cid:107) ≤α(cid:107)T(x)(cid:107) , for all x∈E.
E F
Conversely, assume that there exists α >0 such that
Assume that for any continuous linear form L on
W, there exists a unique u∈V such that
∀x∈E, (cid:107)x(cid:107) ≤α(cid:107)T(x)(cid:107) . (4)
E F
a˜(u,w)=L(w), ∀w∈W.
From this inequality T is obviously injective. Let us
(cid:0) (cid:1)
prove that T(E) is closed. Let T(x ) be a sequence in
n n i.e. with the notation above
T(E)whichconvergestosomey∈F;(T(x )) isaCauchy
n n
sequenceinF . Inequality(4)andthelinearityofT imply ∀L∈W(cid:48), ∃!u∈V, A˜u=L.
that (x ) is a Cauchy sequence in E which is complete.
n n
Hence (x ) converges to some x∈E. By continuity of T, Then A˜ is bijective. By Banach’s theorem (see
n n
we have y=T(x) and in particular y∈T(E). Thus T(E) Theorem 3.1), A˜−1 is a continuous operator. Thus
is closed. (cid:4) there exists α−1>0 such that for all L∈W(cid:48) the
unique u∈V such that a˜(u,·)=L satisfies
3.1 Banach-Neˇcas-Babuˇska theorem
In some situations that we will illustrate later, it is (cid:107)u(cid:107) V ≤α−1(cid:107)L(cid:107) W(cid:48) .
necessary to deal with variational formulations for which
the unknown u and the test function v do not belong to
Let us consider v∈V. We note L(w)=a˜(v,w) so
the same space. In this case, the Lax-Milgram theorem
that v is the unique solution of a˜(v,·)=L. Hence
is inoperant. Moreover, even if u and v belong to the
a˜(v,w)
same space, the Lax-Milgram theorem only deals with (cid:107)v(cid:107) ≤α−1sup .
V
(cid:107)w(cid:107)
coercive bilinear forms and do not say anything on the w∈W W
non-coercive case.
This inequality holds for any v∈V and therefore
The following result is a generalisation of the Lax-
Eq. (5) holds.
Milgram theorem that gives necessary and suffisant well-
Assumenowthat,forsomew∈W,wehavea˜(v,w)=
posedness conditions in such cases.
0 for all v∈V. We introduce the continuous linear
Theorem 3.3 (Banach-Neˇcas-Babuˇska) Let V and form L onW defined as L(w(cid:48))=(w,w(cid:48)) W . Applying
W be Hilbert spaces and a˜(·,·) a bilinear continuous form the assumption to v=A˜−1L, we get
on V×W. Then the following properties are equivalent:
0=a˜(A˜−1L,w)= (cid:10) A˜A˜−1L,w (cid:11) =L(w)=(cid:107)w(cid:107)2 ,
W(cid:48),W W
ForanycontinuouslinearformLonW,thereexists
a unique u∈V such that hence w=0. This proves Eq. (6).
a˜(u,w)=L(w), ∀w∈W.
Conversely, assume that Eqs. (5) and (6) hold.
Let us show that Eq. (6) implies that Im(A˜) is
The following conditions are satisfied:
dense in W(cid:48). This is a consequence of the Hahn-
(cid:18) a˜(v,w) (cid:19) Banachtheorem,seeTheorem1.25,whichprovides
∃α >0, inf sup ≥α, (5)
a characterization of the density of a subspace of a
v∈V w∈W (cid:107)v(cid:107) V (cid:107)w(cid:107) W
Banach space: let us consider a continuous linear
(cid:18) (cid:19) form φ ∈(W(cid:48))(cid:48) which is zero on Im(A˜). AsW is a
∀v∈V, a˜(v,w)=0 ⇒ w=0. (6)
Hilbert space, it is reflexive and φ is represented
16 Introducci´on al m´etodo de los elementos finitos
by an element w∈W as φ(L)=(cid:104)L,w(cid:105) . The The second equation is often referred as the constraint
W(cid:48),W
assumption implies that, for all v∈V, we have andtheunknownscalarfield pistheLagrange multiplier
associated to the constraint. This comes from the fact
0=φ(A˜v)= (cid:10) A˜v,w (cid:11) =a˜(v,w)=0. that in the symmetric case the variational problem is
W(cid:48),W
equivalent to the Euler-Lagrange problem which consists
By Eq. (6), we obtain w=0 and thus φ =0 which in minimizing the functional
shows that Im(A˜) is dense inW(cid:48). Now let us deal
1
with Eq. (5), which can be written as a(v,v)−L(v)
2
(cid:107)A˜v(cid:107)
W(cid:48)
≥α(cid:107)v(cid:107)
V
, ∀v∈V,
on the constrained space
which implies in particular, see Corollary 3.2, that Z={v∈X, b(v,q)=G(q), ∀q∈M}.
A˜ is injective and that Im(A˜) is closed. So far the
following properties have been proved: 1) Im(A˜) is We can also see the solution of this problem as a
dense inW(cid:48) and 2) Im(A˜) is closed. Thus Im(A˜)= saddle-point (u,p) of the functional L defined by
W(cid:48): A˜ is surjective. As a consequence, since A˜ is
1
alsoinjective,thevariationalproblemiswell-posed. L(v,q)= a(v,v)+b(v,p)−L(v)−G(q),
2
which is called the Lagrangian of the problem.
(cid:4)
Remark 3.6 Thevariationalformulationcanbewritten
in terms of operators. Defining A:X →X(cid:48) as
Remark 3.4 Assume that V =W and that a˜(·,·) is α-
coercive. We first note that, for any v∈V,
(cid:104)Au,v(cid:105) =a(u,v), ∀v∈X
X(cid:48),X
sup a˜(v,w) ≥ c(v,v) ≥α(cid:107)v(cid:107) , and B:X →M(cid:48) as
V
(cid:107)w(cid:107) (cid:107)v(cid:107)
w∈V V V
(cid:104)Bv,p(cid:105) =b(v,p), ∀p∈M
M(cid:48),M
so that (5) holds. Similarly we have
the formulation is equivalent to
a˜(v,w) a˜(w,w)
sup ≥ ≥α(cid:107)w(cid:107) V ,  Find (u,p)∈X×M such that
(cid:107)v(cid:107) (cid:107)w(cid:107) 
v∈V V V Au+B(cid:48)p = L,
so that (6) holds.  Bu = G,
Therefore, the previous theorem is indeed a general-
where B(cid:48):M→X(cid:48) is the adjoint operator of B, the bidual
ization of the Lax-Milgram theorem.
of M being identified to M itself.
Remark 3.5 Inthecaseofthefinitedimensionalframe-
Remark 3.7 The variational problem can take the gen-
work, i.e. V =Rn, W =Rp and a˜(v,w)=(A˜v,w) with
eral form:
A˜∈M (R),Theorem3.3canbereadasfollows. Eq.(5)
p×n
should be read as  Find (u,p)∈X×M such that

a(u,v)+b(v,p)−b(u,q)=L(v)−G(q),
∀v∈Rn, (cid:107)A˜v(cid:107)≥α(cid:107)v(cid:107),
 for all (v,q)∈X×M.
which means that A˜ is injective. Eq. (6) states that A˜t is
DefiningV=X×Manda˜((u,p),(v,q))=a(u,v)+b(v,p)−
injective, i.e. A˜ is surjective. Clearly the two conditions
b(u,q), the well-posedness of the variational problem de-
are equivalent to the solvability of the linear system.
pends on conditions satisfied by a˜, see Banach-Neˇcas-
Babuˇska theorem (i.e. Theorem 3.3). Note also that
3.2 Saddle-point problems
a˜((u,p),(u,p))=a(u,u) so that a˜ has no chance to be co-
Let X and M be Hilbert spaces, a(·,·) a continuous
ercive on X×M as this term does not include any control
bilinear form on X×X, b a continuous linear form on
on the Lagrange multiplier p.
X×M. For all L∈X(cid:48), for all G∈M(cid:48), we aim at solving
the variational problem Theorem 3.8 (Saddle-point problem) Ifa(·,·)isco-
ercive on X, the problem (Q) is well-posed if and only if

Find (u,p)∈X×M such that

a(u,v)+b(v,p) = L(v),
the so-called inf-sup condition is satisfied:
(Q) (cid:18) (cid:19)
b(u,q) = G(q), b(v,p)

for all (v,q)∈X×M.
∃β >0,
p
i
∈
n
M
f s
v∈
u
X
p
(cid:107)v(cid:107) X (cid:107)p(cid:107) M
≥β. (7)
Introducci´on al m´etodo de los elementos finitos 17
Proof of Theorem 3.8. Assume that the problem is We now define (v,q)=(u+γu˜,p) and compute the
well-posed. By the Banach-Neˇcas-Babuˇska theorem, see term a˜((u,p),(v,q))
Theorem 3.3, this implies that the solution (u,p) contin-
a˜((u,p),(v,q))
uously depends on the data L and G. Thus there exists
a constant α−1>0 such that =a(u,u)+γa(u,u˜)+γb(u˜,p)
≥α(cid:107)u(cid:107)2 −γ(cid:107)a(cid:107)(cid:107)u(cid:107) (cid:107)u˜(cid:107) +γβ(cid:107)u˜(cid:107)2
X X X X
(cid:107)u(cid:107) X +(cid:107)p(cid:107) M ≤α−1((cid:107)L(cid:107) X(cid:48) +(cid:107)G(cid:107) M(cid:48) ). ≥ α 2 (cid:107)u(cid:107)2 X −γ2 2 (cid:107) α a(cid:107)2 (cid:107)u˜(cid:107)2 X +γβ(cid:107)u˜(cid:107)2 X ,
Let p˜∈M and let us consider L=0 and G defined by where we have used the Young’s inequality for the
G(q)=(p˜,q)
M
(note that (cid:107)G(cid:107)
M(cid:48)
=(cid:107)p˜(cid:107)
M
). In particular last step2. Then choosing γ <
(cid:107)
α
a(cid:107)
β
2
we obtain
we obtain that there exists u∈X such that
a˜((u,p),(v,q)) ≥ α(cid:107)u(cid:107)2 +γβ(cid:107)u˜(cid:107)2
2 X 2 X
b(u,q)=(p˜,q) M , ∀q∈M, ≥ α(cid:107)u(cid:107)2 +γβ(cid:107)p(cid:107)2
2 X 2 M
≥ δ(cid:107)(u,p)(cid:107)2
and X×M
(cid:107)u(cid:107) ≤C(cid:107)p˜(cid:107) . whereδ onlydependsonγ,β,α and(cid:107)a(cid:107). Moreover
X M
we have
Then
(cid:107)(v,q)(cid:107) = (cid:107)v(cid:107) +(cid:107)q(cid:107)
X×M X M
(cid:107)p˜(cid:107)2 =(p˜,p˜) =b(u,p˜)≤α−1
b(u,p˜)
(cid:107)p˜(cid:107) , ≤ (cid:107)u(cid:107) X +γ(cid:107)u˜(cid:107) X +(cid:107)p(cid:107) M
M M (cid:107)u(cid:107) X M ≤ (cid:107)u(cid:107) X +(1+γ)(cid:107)p(cid:107) M
which yields and thus
b(v,p˜)
α(cid:107)p˜(cid:107) M ≤sup (cid:107)v(cid:107) . (cid:107)(v,q)(cid:107) X×M ≤(1+γ)(cid:107)(u,p)(cid:107) X×M .
v∈X X
We finally obtain
The last inequality is exactly the inf-sup condition given
by Eq. (7).
a˜((u,p),(v,q)) δ
Conversely, assume that the inf-sup condition is sat- ≥ (cid:107)(u,p)(cid:107) X×M
(cid:107)(v,q)(cid:107) 1+γ
X×M
isfied and let us prove that the bilinear form a˜ satisfies
theconditionsgivenbyEqs.(5)and(6)inordertoapply which proves that Eq. (5) is satisfied.
Banach-Neˇcas-Babuˇska Theorem (see Theorem 3.3).
(cid:4)
Let us prove that Eq. (6) is satisfied. Assume that
(v,q)∈X×M is such that
Remark 3.10 An alternate proof of Theorem 3.3 is
a˜((u,p),(v,q))=0, ∀(u,p)∈X×M. based on a so-called artificial compressibility method. As-
sume that a(·,·) is coercive and that the inf-sup condition
We aim at proving that (v,q)=(0,0). We take is satisfied. We introduce the approximate problem:
(u,p)=(v,q) in the above equality which gives:

a(v,v)=0 hence v=0 because a is coercive on X.  Find (u ε ,p ε )∈X×M such that
Thusthepreviousequalityisreducedtob(u,q)=0 a(u ε ,v) X +b(v,p ε )−b(u ε ,q)+ε(p ε ,q) M =L(v)−G(q),
forallu∈X. Theinf-supconditiongivenbyEq.(7)  for all (v,q)∈X×M.
implies that q=0.
The bilinear form a˜ which defines this problem is obvi-
ε
ously continuous and satisfies:
Let us prove that Eq. (5) is satisfied. Let (u,p)∈
X×M. By the inf-sup condition , we have
a˜ ((v,p),(v,p))=a(v,v)+ε(p,p) , ∀v∈X,∀p∈M,
ε M
b(v,p) 2TheYoung’sinequalityreads:
β(cid:107)p(cid:107) ≤sup .
M
(cid:107)v(cid:107)
v∈X X
Proposition 3.9 (Young’s inequality) For all a>0, b>0,
There exists u˜∈X such that a2 εb2
ab≤ +
2ε 2
b(u˜,p)
for any ε>0.
≥β(cid:107)p(cid:107) .
M
(cid:107)u˜(cid:107)
X
Asaconsequence:
We can choose the norm of u˜ and take for instance γ2(cid:107)a(cid:107)2 α
γ(cid:107)a(cid:107)(cid:107)u(cid:107)X(cid:107)u˜(cid:107)X≤
2α
(cid:107)u˜(cid:107)2
X
+
2
(cid:107)u(cid:107)2
X
,
(cid:107)u˜(cid:107) X =(cid:107)p(cid:107) M . byidentifyinga:=γ(cid:107)a(cid:107)(cid:107)u˜(cid:107)X,b:=(cid:107)u(cid:107)X andε=α.
18 Introducci´on al m´etodo de los elementos finitos
so that it is coercive. By the Lax-Milgram theorem the Then we take v=u −u and q= p −p in the above
ε ε
approximate problem admits a unique solution (u ,p ). formulation and we use the coercivity of a(·,·) to get
ε ε
Note that the problem can be defined by means of opera-
tors as α(cid:107)u ε −u(cid:107)2 X +ε(p ε −p,p ε −p) M =−ε(p,p ε −p) M ,

Find u ∈X and p ∈M such that hence
 ε ε
Au +B(cid:48)p = L,
 Bu ε ε −εp ε ε = G, (cid:107)u−u ε (cid:107) X ≤ε (cid:107) α a β (cid:107) (cid:107)p(cid:107) M , (cid:107)p ε −p(cid:107) M ≤ε (cid:107) α a β (cid:107) 2 2 (cid:107)p(cid:107) M ,
We use first the inf-sup condition (7), then the first equa-
for all ε >0.
tion of the system, and finally the continuity of a and L,
to get
Corollary 3.11 (Right inversibility of B) Assumethat
(cid:107)p (cid:107) ≤ 1sup b(v,pε)
ε M β v∈X (cid:107)v(cid:107)X b satisfies the inf-sup condition (7). Then, there exists
= 1sup −a(uε,v)+L(v) a continuous linear operator Φ:M(cid:48)→X with (cid:107)Φ(cid:107)≤β−1
β v∈X (cid:107)v(cid:107)X
≤ (cid:107)a(cid:107)(cid:107)u (cid:107) + (cid:107)L(cid:107) X(cid:48). such that
β ε X β B◦Φ=Id
M(cid:48)
.
This gives us an estimate of p in terms of u . We now
ε ε In particular for any G∈M(cid:48) there exists u =Φ(G)∈X
take v=u and q=p in the approximate problem: G
ε ε
such that
a(u ε ,u ε )+ε(cid:107)p ε (cid:107)2 M =L(u ε )−G(p ε ). b(u G ,q)=G(q), ∀q∈M,
(cid:107)G(cid:107)
Using the coercivity of a(·,·), we have (cid:107)u (cid:107) ≤
M(cid:48)
.
G X
β
α(cid:107)u ε (cid:107)2 X ≤ (cid:107)L(cid:107) X(cid:48) (cid:107)u ε (cid:107) X +(cid:107)G(cid:107) M(cid:48) (cid:107)p ε (cid:107) M Such an element u G is not necessarily unique.
≤ (cid:16) (cid:107)L(cid:107)
X(cid:48)
+ (cid:107)a(cid:107)(cid:107)
β
G(cid:107) M(cid:48) (cid:17) (cid:107)u
ε
(cid:107)
X
+ (cid:107)L
β
(cid:107)2 X(cid:48).
Remark 3.12 Actually the existence of such an opera-
tor is equivalent to the inf-sup condition.
With the Young inequality, we conclude that
α (cid:107)u (cid:107)2 ≤ 1 (cid:18) (cid:107)L(cid:107) + (cid:107)a(cid:107)(cid:107)G(cid:107) M(cid:48) (cid:19)2 + (cid:107)L(cid:107)2 X(cid:48). P th r e o a o b f st o r f ac C t o p r r o o l b l l a e r m y 3.11. We apply Theorem 3.8 to
2 ε X 2α X(cid:48) β β

Find (u,p)∈X×M such that
Thus {u
ε
} and {p
ε
} are bounded in X and M respec- 
(u,v) +b(v,p) = 0,
X
tively. Up to a subsequence, they weakly converge to a
b(u,q) = G(q),
some u∈X and p∈M respectively. Obviously we may 
for all (v,q)∈X×M.
pass to the limit in the approximate problem so that (u,p)
is a solution of (Q). Uniqueness of the solution follows As (·,·) is obviously coercive on X, the theorem applies
X
by taking (u,p) as a test function in the homogeneous andwehaveauniquesolution(u ,p )∈X×M satisfying
G G
abstract problem (i.e. the one with L=0 and G=0). the above problem. Then if we take v=u in the first
G
This shows that u=0. Then the inf-sup condition implies equation, we obtain
that p=0.
Infactwecanprovethatthewholesequence{(u ,p )} (cid:107)u (cid:107)2 =−G(p ).
ε ε G X G
strongly converges to (u,p). More precisely, we can prove
that there exists C>0 which only depends on the data Besides the inf-sup condition gives
such that
(cid:18) (cid:19) (cid:18) (cid:19)
b(v,p ) (u ,v)
G G X
β(cid:107)p (cid:107) ≤sup =sup =(cid:107)u (cid:107) .
G M G X
(cid:107)u−u ε (cid:107) X +(cid:107)p ε −p(cid:107) M ≤Cε, ∀ε >0. v∈X (cid:107)v(cid:107) X v∈X (cid:107)v(cid:107) X
The difference (u −u,p −p)∈X×M satisfies Thus we get
ε ε
(cid:107)G(cid:107)
a(u ε −u,v)+b(v,p ε −p)−b(u ε −u,q)+ε(p ε ,q) M =0, (cid:107)u G (cid:107)2 X ≤(cid:107)G(cid:107) M(cid:48) (cid:107)p G (cid:107) M ≤ β M(cid:48) (cid:107)u G (cid:107) X ,
for all v∈X and for all q∈M. Taking q=0 and using
the inf-sup condition, which provides the estimate on (cid:107)u G (cid:107) X . Moreover by
construction, u depends linearly on G which gives the
G
β(cid:107)p −p(cid:107) ≤ sup b(v,pε−p) existence of the operator Φ. (cid:4)
ε M v∈X (cid:107)v(cid:107)X
≤ sup a(uε−u,v) It is now possible to determine a priori bounds for
v∈X (cid:107)v(cid:107)X
≤ (cid:107)a(cid:107)(cid:107)u −u(cid:107) . the solution of the abstract problem:
ε X
Introducci´on al m´etodo de los elementos finitos 19
Theorem 3.13 (A priori estimates) Assumethata(·,·)that L(v)=0 for all v∈Z. Then there exists a unique
is coercive on X (with α the constant of coercivity). As- p∈M such that
sume that b satisfies the inf-sup condition (7). Then
the unique solution (u,p) of the abstract problem (Q) L(v)=b(v,p), ∀v∈X,
satisfies:
and
(cid:107)u(cid:107) X ≤ (cid:107)L α (cid:107) X(cid:48) + β 1 (cid:18) 1+ (cid:107) α a(cid:107) (cid:19) (cid:107)G(cid:107) M(cid:48) , (8) (cid:107)p(cid:107) M ≤ (cid:107)L β (cid:107) X(cid:48) .
(cid:18) (cid:107)a(cid:107) (cid:19)(cid:18) 1 (cid:107)a(cid:107) (cid:19) Proof of Corollary 3.15. By Theorem 3.8 and as-
(cid:107)p(cid:107) M ≤ 1+ α β (cid:107)L(cid:107) X(cid:48) + β2 (cid:107)G(cid:107) M(cid:48) (9) sumptions on L, there is a unique (u,p)∈X×M such
that
Proof of Theorem 3.13. Let us use the properties
(cid:26)
(u,v) +b(v,p) = L(v), ∀v∈X,
of the right inverse of B that was considered in Corol- X
b(u,q) = 0, ∀q∈M.
lary3.11. Let(u,p)∈X×M bethesolutionofthesaddle-
point problem (Q). We take v=u−Φ(G) as a test func-
Thesecondequationstatesthatu∈Z. Thusifwetakev=
tion in the first equation:
uinthefirstequationweobtainbyusingtheassumption
L =0 that (cid:107)u(cid:107)2 =0 hence u=0. Thus we have
a(u,u−Φ(G))+b(u−Φ(G),p)=L(u−Φ(G)). |Z X
b(v,p)=L(v), ∀v∈X.
Note that, thanks to the second equation of the system
b(u−Φ(G),p)=b(u,p)−b(Φ(G),p)=G(p)−G(p)=0.
Moreover by the inf-sup inequality, we have:
Thus we have
b(v,p) L(v)
a(u−Φ(G),u−Φ(G))=L(u−Φ(G))−a(Φ(G),u−Φ(G)). β(cid:107)p(cid:107)
M
≤sup
(cid:107)v(cid:107)
=sup
(cid:107)v(cid:107)
=(cid:107)L(cid:107)
X(cid:48)
.
v∈X X v∈X X
Using the coercivity of a(·,·) and the estimates on Φ,
(cid:4)
(cid:107)a(cid:107) Now it is possible to prove a result which is stronger
α(cid:107)u−Φ(G)(cid:107)
X
≤(cid:107)L(cid:107)
X(cid:48)
+ (cid:107)G(cid:107)
M(cid:48)
.
than Theorem 3.8: the existence and uniqueness result
β
still holds if a(·,·) is coercive on the kernel of b.
This yields
Theorem 3.16 Theorem 3.8 still holds if we only as-
(cid:107)u(cid:107) X ≤ (cid:107)u−Φ(G)(cid:107) X +(cid:107)Φ(G)(cid:107) X sume that a(·,·) is coercive on Z.
(cid:16) (cid:17)
≤ (cid:107)L
α
(cid:107) X(cid:48) +
β
1 1+(cid:107)
α
a(cid:107) (cid:107)G(cid:107)
M(cid:48)
.
Proof of Theorem 3.16. We use the operator Φ de-
fined in Corollary 3.11 so as to find (u,p) the solution
The estimate on p is obtained with the inf-sup condition:
of the saddle-point problem as u=u˜+Φ(G) where u˜ be-
β(cid:107)p(cid:107) ≤ sup b(v,p) longstoZ,bydefinitionofΦ(G). Thusweaimatfinding
M v∈X (cid:107)v(cid:107)X
u˜∈Z which satisfies
≤ sup a(u,v)−L(v)
v∈X (cid:107)v(cid:107)X
≤ (cid:107)a(cid:107)(cid:107)u(cid:107) X +(cid:107)L(cid:107) X(cid:48) . a(u˜,v˜)=L(v˜)−a(Φ(G),v˜), ∀v∈Z.
Inserting the estimate on u into the above inequality
Since Z is a closed subspace of X, it is a Hilbert space
allows us to conclude the proof. (cid:4)
andthecoercivityassumptiononZ leadstotheexistence
Letusdiscusstheconsequencesofthepreviousresults.
and uniqueness of u˜ by the Lax-Milgram theorem. Now
we define
In particular, we present some extension of Theorem 3.8
byweakeningsomeassumptionandweconsiderthefinite
L˜(v)=−a(Φ(G)+u˜,v)+L(v), ∀v∈X.
dimensional problem.
A stronger result By definition of u˜, L˜ is zero on Z and, by Corollary 3.15
Definition 3.14 (Kernel) Thekernelofabilinearform there exists a unique p∈M such that
b is the closed subspace Z⊂X defined as
L˜(v)=b(v,p), ∀v∈X.
Z:=Ker(B)={v∈X, b(v,q)=0, ∀q∈M}.
This exactly expresses the fact that (u=u˜+Φ(G),p) is
Corollary 3.15 Assume that b satisfies the inf-sup con- the solution of our problem. The estimate on u and p
dition (7). Let L be a continuous linear form on X such readily adapts from the proof of Theorem 3.8. (cid:4)
20 Introducci´on al m´etodo de los elementos finitos
The finite dimensional case i.e.
Assume that X =Rn and M=Rp. Consider a basis ∀Q∈Rp, (cid:107)BtQ(cid:107)Rn ≥β ˜(cid:107)Q(cid:107)Rp.
(φ) (resp. (ψ) )ofX (resp. M). Anyelement
i i=1,...,n i i=1,...,p As a consequence, since all the previous steps are equiva-
u∈X and p∈M can be decomposed on these bases as
lent, we have proved that the following are equivalent:
follows
n p
1. b satisfies the inf-sup condition;
u=∑Uφ, p= ∑Pψ.
i i i i
i=1 j=1 2. ∃β ˜ >0, ∀Q∈Rp, (cid:107)BtQ(cid:107)Rn ≥β ˜(cid:107)Q(cid:107)Rp.
Denoting byU the vector (U ,...,U )t∈Rn and by P the
1 n Let us conclude the proof in two steps:
vector (P,...,P )t∈Rp, we will use this type of notation
1 p
when it is necessary. Although the norms are equivalent The inf-sup condition leads to the inequality that
in a finite dimensional space, it is useful to introduce the obviously implies that Bt is injective.
following specific ones. For anyV ∈Rn,
Conversely, assume that Bt is injective. This im-
(cid:32) (cid:33)1 pliesthatQ∈Rp(cid:55)→(cid:107)BtQ(cid:107)Rn isanormonRp. Since
n 2 n
(cid:107)V(cid:107)Rn := ∑V
i
2 , (cid:107)V(cid:107)
X
:=(cid:107)∑V
i
φ
i
(cid:107)
X
. allthenormsonafinitedimensionspaceareequiv-
alent, we deduce that there exists α >0 such that
i=1 i=1
A similar notation can be introduced for M. Note that ∀Q∈Rp, (cid:107)Q(cid:107)Rp ≤α(cid:107)BtQ(cid:107)Rn.
the basis (φ) may differ from the canonical one
i i=1,...,n Thus we have proved that item 2. is satisfied with
(in particular it is not necessarily orthonormal) so that
β ˜ =1/α, hence item 1. is satisfied. This concludes
the norms (cid:107)·(cid:107)
X
and (cid:107)·(cid:107)Rn may differ (although they are
the proof.
equivalent).
Define F =((cid:104)L,φ (cid:105) ,...,(cid:104)L,φ (cid:105) )t ∈Rn and the
1 X(cid:48),X n X(cid:48),X (cid:4)
following matrices
Moreover we can prove the following result:
A=[a(φ ,φ)] , B=[b(φ ,ψ)]
j i i,j=1,...,n j i i=1,...,p, j=1,...,n
Theorem 3.18 The following are equivalent:
and assuming, for the sake of simplicity, that G≡0, the
1. A is coercive on Z=Ker(B),
problem consists in studying the linear system
2. ∃ε >0, A+At+1BtB is s.p.d.
(cid:18) A Bt (cid:19)(cid:18) U (cid:19) (cid:18) F (cid:19) ε
= .
B 0 P 0 Proof of Theorem 3.18.
Assume that property 1. holds. We proceed by
Proposition 3.17 (Inf-sup condition in finite dimension)
reductio ad absurdum. Assume that property 2. is false.
The inf-sup condition (7) is equivalent to the injectivity
Thusforanyε>0thereexistsu suchthat(cid:107)u (cid:107)=1and
ε ε
of Bt (hence to the surjectivity of B).
1
2(Au ,u )+ (cid:107)Bu (cid:107)2≤0. (10)
Proof of Proposition 3.17. The inf-sup condition ε ε ε ε
states that there exists β >0 such that
The sequence {u } converges, up to an extraction, to an
ε
b(v,q) element u with (cid:107)u(cid:107)=1. Moreover,
∀q∈M, sup ≥β(cid:107)q(cid:107) ,
M
v∈X (cid:107)v(cid:107) X (cid:107)Bu (cid:107)2≤2ε(cid:107)A(cid:107)(cid:107)u (cid:107)=2ε(cid:107)A(cid:107)−−→0.
ε ε
ε→0
which after introducing the vectorsV ∈Rn and Q∈Rp
Thus Bu →0, hence Bu=0 and u∈Ker(B). As a(·,·)
representing v and q gives ε
is coercive on Ker(B) and (cid:107)u(cid:107)=1, we have (Au,u)≥α.
∀Q∈Rp, sup
(BV,Q)Rp
≥β(cid:107)Q(cid:107) ,
Thus for ε sufficiently small, we have (Au
ε
,u
ε
)>0 which
V∈Rn (cid:107)V(cid:107) X M is in contradiction with Eq. (10).
Conversely, assume that property 2. holds so that
Using the equivalence of the norms, we have there exists α >0 satisfying
∀Q∈Rp, sup
(BV,Q)Rp
≥β ˜(cid:107)Q(cid:107)Rp, ∀u, 2(Au,u)+
1
(cid:107)Bu(cid:107)2≥α(cid:107)u(cid:107)2.
V∈Rn (cid:107)V(cid:107)Rn ε
As a consequence, for u∈Ker(B),
with β ˜ >0. Then we obtain
(Au,u)≥α(cid:107)u(cid:107)2,
∀Q∈Rp,
V
s
∈
u
R
p
n
(B
(cid:107)
tQ
V
,
(cid:107)
V
R
)
n
Rn ≥β ˜(cid:107)Q(cid:107)Rp,
and property 2. is proved. (cid:4)
Introducci´on al m´etodo de los elementos finitos 21
3.3 Example 1: A very simple linear constraint The variational framework is
Consider a domain Ω and a non empty subdomain  Find (u,λ)∈H1(Ω)×R such that
B⊂Ω. Let α >0 and f ∈L2(Ω). Define the functional  (cid:90)
∇u·∇v+α
(cid:90)
uv+λ
(cid:90)
v =
(cid:90)
fv,
J(v):= 1(cid:90) |∇v|2+ α (cid:90) v2− (cid:90) fv, (Q(1)) Ω Ω (cid:90)B Ω
and the space
2
Ω
2
Ω Ω

for all (v,µ)∈H1(Ω)×
µ
R.
B
u = 0,
(cid:26) (cid:90) (cid:27) Theabovesystemclearlyfallsintothescopeofthesaddle-
V = v∈H1(Ω), v=0 .
point problems. Besides, the second equation ensures
B
that the solution (if it exists) satisfies the constraint
We consider the minimization problem which consists in
whereas the Lagrange multiplier λ in the first equation
finding a (unique) minimizer of J overV, i.e.
quantifies an external force (with support in B) that is
(cid:40)
Find u∈V such that necessary to impose this constraint: indeed we have
J(u)=minJ(v). (cid:90) (cid:90)
v∈V λ v= λ1 v
B
B Ω
As V is a closed subspace of H1(Ω) and J is a strictly
so that the first equation can be read as
convex and coercive functional, then the minimization
(cid:90) (cid:90) (cid:90)
problem admits a unique solution. But what kind of
∇u·∇v+α uv= (f−λ1 )v.
B
variationalformulationisassociatedtothisminimization Ω Ω Ω
problem? From the mathematical point of view, we may prove
that this saddle-point problem is well-posed. The main
Remark 3.19 If the space was H1(Ω) only, i.e. with- required properties are obviously satisfied and we only
out the constraint on the mean value over B, then the focus to the inf-sup condition: we aim at identifying
variational formulation would write: some β >0 such that
  (cid:90) Find u∈H1(Ω (cid:90) ) such t (cid:90) hat sup
(cid:107)
λ
v
(cid:82)
(cid:107)
B v ≥β|λ|, ∀λ ∈R
∇u·∇v+α uv= fv, v∈H1(Ω) H1

fo
Ω
r all v∈H1(Ω
Ω
).
Ω
or, after an obvious simplification (this is not possible in
general!),
This is a classical elliptic problem but it does not take (cid:82)
v
into account the constraint (cid:82) u=0! And the solution of sup B ≥β.
B (cid:107)v(cid:107)
the above (unconstrained) problem does not satisfy the v∈H1(Ω) H1
(cid:82)
constraint u=0 in general. Consider u˜≡1. As an obvious fact, u˜∈H1(Ω) and
B
(cid:82) u˜ |B|
Remark 3.20 By the Lax-Milgram theorem, a possi- B = .
ble variational formulation consists in dealing with the (cid:107)u˜(cid:107) H1 |Ω| 1 2
constraint in the functional space:
Thus we obtain

 (cid:90) Find u∈V suc (cid:90) h that (cid:90) sup (cid:82) B v ≥ (cid:82) B u˜ = |B| >0.
∇u·∇v+α uv= fv, (cid:107)v(cid:107) (cid:107)u˜(cid:107) 1
v∈H1(Ω) H1 H1 |Ω|2

fo
Ω
r all v∈V.
Ω Ω
The inf-sup condition is satisfied. As a conclusion, the
This is also a classical elliptic problem for which the con- saddle-point problem (Q(1)) is well-posed.
(cid:82)
strainton uistakenintoaccountthroughthedefinition
B
of the functional space. But the functional space is not so Exercise 8 Consider a domain Ω and a nonempty sub-
classical and, if we aim at solving this problem with the domain B⊂Ω. Let α >0 and f ∈L2(Ω). Define
finite element method, we need to define a finite dimen-
1(cid:90) α (cid:90) (cid:90)
sional subspace ofV, denotedV , thus building a basis of J(v):= |∇v|2+ v2− fv,
h
2 2
V ; itmeansinparticularthateachelementshouldsatisfy Ω Ω Ω
h
the constraint! In order to avoid such a difficulty, we aim andV is a subspace of H1(Ω) to be precised. We consider
at preserving the natural space H1(Ω) (for which finite the minimization problem which consists in finding the
dimensional subspaces are well known and easy to build) minimizer of J over V, i.e. find u such that
but there is some price to pay: relaxing the constraint in
u=argmin J(v).
the functional space requires the introduction of a new v∈V
unknown: a so-called Lagrange multiplier (associated to Define saddle-point formulations associated to the follow-
the constraint). ing constraints:
22 Introducci´on al m´etodo de los elementos finitos
1. V = (cid:8) v∈H1(Ω), v= (cid:82) v on B (cid:9) ; formulation as follows
B

2
3
.
.
V
V
=
=
(cid:8)
(cid:110)
v
v
∈
∈
H
H
1
1
(
(
Ω
Ω
)
)
,
,
v
(cid:82)
= (cid:82)
v
∂B
=
v
(cid:82)
on
v
B
o
(cid:9)
n
;
B (cid:111) . (Q (2) )
 F
(cid:90)
in
Ω
d
K
(σ
−
,
1
u
σ
)
·
∈
τ
H
+
d
(cid:90)
(cid:90)
iv
Ω
(Ω
u
)
d
×
iv(
L
τ
2
)
(Ω)
=
suc
(cid:90)
0
h
,
that
3.4 Example 2: Porous
Ω
m
\B
edium
B [b] 
for all (τ,v)∈
−
H
d
Ω
iv
(
v
Ω
d
)
iv
×
(σ
L
)
2(Ω
=
).
Ω
fv,
We consider the same example as in section 2.3,
In this formulation, X =H (Ω) and M=L2(Ω). Here
namely the general elliptic equation −div(K ∇u)= f, div
also σ plays the role of the main unknown and u is
also refered to as the Darcy equation, and we propose an
the Lagrange multiplier but the regularity assumed on
alternativeformulationofthisproblem. Thisformulation
those unknowns are not the same (σ is more regular
is called mixed formulation and reads
and u is less regular than in the previous formulation).
(cid:26) Consequently, we introduce:
−div(σ) = f,
∇u−K −1σ = 0. (cid:90) (cid:90)
a(σ,τ)= K −1σ·τ, b(σ,u)=− udiv(σ).
Ω Ω
One possible weak formulation is the following
The bilinear form a is not coercive on X because the

Find (σ,u)∈(L2(Ω))d×H1(Ω) such that L2−norm of div(σ) is not controlled. But it is coercive
 (cid:90)
K −1σ·τ−
(cid:90)
∇u·τ =
0
0, on the kernel of b, denoted Z. Indeed Z is H 0,div (Ω)=
(Q (2) ) Ω (cid:90)Ω (cid:90) {σ∈H div (Ω), div(σ)=0}andtheL2−normisequivalent
[a]

for all (τ,v)∈(L2
Ω
(
σ
Ω)
·
)
∇
d
v
×H
=
1(Ω)
Ω
.
fv, t
c
o
on
t
d
h
i
e
tio
H
n
div
is
−
s
n
a
o
t
r
is
m
fie
o
d
n
:
Z. Let us prove that the inf-sup
0
(cid:82)
udiv(σ)
I
σ
n
p
th
la
is
ys
for
t
m
he
ula
ro
ti
l
o
e
n
o
,
f
X
t
=
he
(L
m
2(
a
Ω
in
))d
un
an
kn
d
o
M
wn
=
w
H
h 0
1(
e
Ω
re
)
a
.
s
T
u
hu
is
s
σ∈H
su
di
p
v(Ω)
Ω
(cid:107)σ(cid:107)
Hdiv
≥β(cid:107)u(cid:107)
L2
, ∀u∈L2(Ω).
the Lagrange multiplier associated with the constraint Forthis,foragivenu∈L2(Ω),letusconsiderthesolution
−divσ = f. Consequently, we introduce φ ∈H1(Ω)of−∆φ =uandwedefineσ =−∇φ ∈H (Ω).
0 div
We have
(cid:90) (cid:90)
a(σ,τ)= K −1σ·τ, b(σ,u)=− σ·∇u. (cid:107)σ(cid:107)2 =(cid:107)∇φ(cid:107)2 +(cid:107)u(cid:107)2 .
Hdiv L2 L2
Ω Ω
Wetesttheequationforφ againstuand,bythePoincar´e
AsK isuniformlyboundedandcoercive,thebilinear inequality, we find
form a is continuous and coercive on X and the bilin-
(cid:90) (cid:90)
ear form b is continuous on X×M. the well-posedness |∇φ|2= uφ ≤(cid:107)u(cid:107) (cid:107)φ(cid:107) ≤C(cid:107)u(cid:107) (cid:107)∇φ(cid:107)
L2 L2 L2 L2
depends on the inf-sup condition which writes Ω Ω
√
sup
(cid:82)
Ω
σ·∇u
≥β(cid:107)u(cid:107) , ∀u∈H1(Ω).
so that (cid:107)σ(cid:107) Hdiv ≤ 1+C2(cid:107)u(cid:107) L2 and we get
σ∈(L2(Ω))d (cid:107)σ(cid:107) L2 H 0 1 0 (cid:82)
Ω
udiv(σ)
≥ √
1
(cid:107)u(cid:107)
This inequality holds with β =1 by taking σ =∇u: in-
(cid:107)σ(cid:107) Hdiv 1+C2 L2
deed this leads to which proves the inf-sup condition.
(cid:107)∇u(cid:107)2 3.5 Example 3: Stokes problem
L2 =(cid:107)u(cid:107) .
(cid:107)u(cid:107) H 0 1 H 0 1 bou T nd h e e d s c tr o o n n n g ec f t o e r d m d u o l m at a io in n o o f f R th d e w S r t i o te k s es system in a
Thus the problem admits a unique solution. (cid:26)
−∆u+∇p = f,
div(u) = 0,
Exercise 9 Build explicitely a right inverse Φ:M(cid:48)→X
with homogeneous boundary conditions for the velocity
for the operator
field u: →Rd and an additional conditon: the pressure
B : X =(L2(Ω))d → M(cid:48)=H−1(Ω) p: →Rhaszeromeanvalue. Actually,thisstrongformu-
lation comes from the following minimization problem:
σ (cid:55)→ div(σ).
define the functional
If we formally integrate by parts the term b(σ,u) 1(cid:90) (cid:90)
in the previous equations, we can write another weak J(v):= |∇v|2− f·v,
2
Ω Ω
Introducci´on al m´etodo de los elementos finitos 23
and the space The bilinear forms are continuous and a is coercive on
X =(H1(Ω))d. The inf-sup condition writes:
V ={v∈(H1(Ω))d, div(v)=0}, 0
0
(cid:82)
pdiv(v)
and find the unique minimizer of J over V, i.e. find u sup Ω ≥β(cid:107)p(cid:107) , ∀p∈L2(Ω).
(cid:107)v(cid:107) L2 0
such that v∈(H1(Ω))d H1
0
u=argmin J(v).
v∈V
Inthisproblem, thepressure pistheLagrangemulti-
AsV is a closed subspace of (H 0 1(Ω))d and J is a strictly plierassociatedtotheincompressibilityequationdiv(u)=
convex and coercive functional, then the minimization 0. Assuming that the solution is regular and proceeding
problem admits a unique solution. But what kind of with integrations by parts, we can see easily that the
variationalformulationisassociatedtothisminimization strong formulation is recovered.
problem?
This inf-sup inequality is a consequence of the fol-
lowing result (which is rather difficult to prove in the
Remark 3.21 Ifthespacewere(H1(Ω))d only,i.e. with- general case) which is an adaptation of Corollary 3.11:
0
out the constraint on the divergence, then the variational
formulation would write: Lemma 3.23 For any function p∈L 0 2(Ω) there exists
v∈(H1(Ω))d suchthatdiv(v)=p. Besideswecanchoose
 Find u∈(H1(Ω))d such that v such 0 that
 (cid:90) 0 (cid:90)
∇u:∇v = f·v, (cid:107)v(cid:107) H1 ≤C(cid:107)p(cid:107) L2,
0

for
Ω
all v∈(H1(Ω))
Ω
d. where C>0 only depends on Ω.
0
Here we used the notation A:B=∑
i,j
a
i,j
b
i,j
for the inner
A proof of this lemma can found in [10, 3, 14].
product in the set of matrices.
Theaboveequationisaclassicalellipticproblembutit
4. Basic principles of the Galerkin
doesnottakeintoaccounttheconstraintonthedivergence
approximation
!
4.1 Elliptic problems: Galerkin approximation
Remark 3.22 By the Lax-Milgram theorem, a possi-
LetV be a Hilbert space, a(·,·) a coercive continuous
ble variational formulation consists in dealing with the
bilinear form and L a continuous linear form. Thus the
constraint in the functional space:
problem
 Find u∈V such that  Find u∈V such that
 (cid:90) (cid:90)
(P)

a(u,v)=L(v),
∇u:∇v= f·v,

fo
Ω
r all v∈V.
Ω  forall v∈V.
admits a unique solution thanks to the Lax-Milgram
This is also a classical elliptic problem which does take theorem (Theorem 2.1). We aim at studying strategies
into account the constraint on the divergence. But the that allow us to describe the solution by approximation,
functional space is not so classical and, if we aim at by means of computations. This pragmatic constraint
solving this problem with the finite element method, we leads us to target approximation procedures in a finite-
need to define a finite dimensionalsubspaceofV, denoted dimesional framework. Different methods can be de-
V h , thus building a basis ofV h ; it means in particular that scribed: we will focus on the Galerkin approximation
each element should satisfy the constraint! In order to and the Petrov-Galerkin approximation.
avoid such a difficulty, we aim at preserving the natural We introduce a finite-dimensional subspace V ⊂V
h
space (H1(Ω))d (for which finite dimensional subspaces andlookingforanapproximatesolutioninthissubspace.
0
are well known) but there is some price to pay: relax- Thus we define the approximate problem
ing the constraint in the functional space requires the

introduction of a new unknown: a so-called Lagrange  Find u h ∈V h such that
multiplier (associated to the constraint). (P h ) a(u h ,v h )=L(v h ),
 forall v ∈V .
h h
The variational framework is

Find (u,p)∈(H1(Ω))d×L2(Ω) such that
 (cid:90)
∇u:∇v−
(cid:90) 0
pdiv(v)
0
=
(cid:90)
f·v,
Exerc
(P
ise
) i
1
s
0
equiv
1
a
.
le
P
n
r
t
o
t
v
o
e
a
th
fi
a
n
t
it
t
e
h
-
e
di
a
m
p
e
p
n
ro
si
x
o
i
n
m
a
a
l
t
l
e
in
p
e
r
a
o
r
bl
s
e
y
m
s-
(Q(3)) Ω (cid:90)Ω Ω h
tem to be determined.

for all (v,q)∈(
Ω
H
q
0 1(
d
Ω
iv
)
(
)
u
d
)
×L
=
0 2(Ω
0
).
,
2. Prove that (P h ) is well-posed.
24 Introducci´on al m´etodo de los elementos finitos
We may notice that: to u¯. Let us prove that u¯=u. For this, let us fix
somev∈V. Byassumption,thereexistsasequence
Subscript h refers to a mesh size or more generally
{v } of elements inV such that
h
to the quality of the approximation ofV.
• v ∈V , for all h,
h h
Other approximations may be defined: it is possi-
• lim (cid:107)v−v (cid:107) =0.
ble to replace a(·,·) by a bilinear form a (·,·) (for h→0 h V
h
instanceusinginterpolationformulafortheapprox-
Let us select v as a test function in the approxi-
h
imation of the integrals formula); it is also possible
mate problem:
to consider spacesV which are not included inV
h
(theapproximationissaidtobenon-conforming)in a(u ,v =L(v ).
h h) h
which case an extension of the continuous bilinear
form a(·,·) is required in order to be defined on Using the“strong-weak convergence”argument4,
V ×V . The well-posedness becomes questionable wepasstothelimitintheleft-handside. Passingto
h h
in these cases. the limit in the right-hand side as well, we obtain:
It is possible to consider two finite-dimensional a(u¯,v)=L(v).
spaces V and W and look for a solution u ∈V
h h h h
This result holds for any v∈V and, as the solution
with test functions inW . This is called a Petrov-
h
oftheinitialproblemisunique,u¯=u. Itshowsalso
Galerkin approximation (which will be studied in
that the sequence {u } admits a unique adherent
the next subsection). The well-posedness of the h
value (or closure point) in V for the weak topol-
approximateproblembecomesquestionableaswell.
ogy. Therefore the whole sequence {u } weakly
h
The interest of such an approximation only makes converges to u (by Theorem 4.2).
sense if we may guarantee that the solution of the ap-
proximate problem u is indeed an approximation of the
h
Step 2. Strong convergence of u to u. Let
solution u. Thus the error has to be estimated in order h
us prove that {u } strongly converges to u. Let
toensurethattheprocessisvalid. Notethatbylinearity h
us choose u as a test function in the approximate
we have h
problem. We have
∀v ∈V , a(u−u ,v )=0.
h h h h
The error e h :=u−u h is a−orthogonal toV h . This is the a(u h ,u h )=L(u h )−−→L(u)=a(u,u).
h→0
basis which will alow us to perform the analysis of the
convergence of the method. Theorem 4.2 Let H be a Hilbert space and {un} a bounded se-
quence in H. Then
Lemma 4.1 (Error estimate) Under the approxima- • there exists a least one subsequence unk which weakly con-
bility property of V , i.e. verges;
h
• if, furthermore, the set of weak limits reduces to a single
∀v∈V, limd(v,V
h
)=0. element, then the whole sequence {un}n weakly converges to
h→0 this element .
then {u
h
} converges to u in V. Moreover, 4The“strong-weakconvergence”argumentreliesonthefollowing
proposition:
(cid:107)a(cid:107) (cid:107)a(cid:107)
(cid:107)u−u (cid:107) ≤ inf (cid:107)u−v (cid:107) = d(u,V ).
h V h V h Proposition 4.3 Let E be a normed vector space. We consider
α vh∈Vh α
a sequence {xn}n of elements in E, and x∈E. Assume that {xn}n
weakly converges to x. Then,
Proof of Lemma 4.1. Let us proceed in three steps.
(i) (xn) is bounded;
Step 1. Weak convergence of u h to u. Ap- (ii) if (cid:107)fn−f(cid:107) E(cid:48)→0, then fn(xn)→f(x);
plying the Lax-Milgram theorem for (P ) not only
h
provides the existence and uniqueness result for Inparticular,theproofofitem(ii)(combinedwithitem(i))allows
ustoprovethe“strong-weakconvergence”argumentinourspecific
its solution but also provides an estimate on u ,
h case:
namely
(cid:107)a(cid:107)
|a(uh,vh)−a(u˜,v)| = |a(uh,vh)−a(uh,v)+a(uh,v)−a(u˜,v)|
(cid:107)u
h
(cid:107)
V
≤ (cid:107)L(cid:107)
V(cid:48)
. ≤ |a(uh,vh)−a(uh,v)|+|a(uh,v)−a(u˜,v)|
α ≤ |(a(uh,vh−v)|+|a(uh−u˜,v)|
Thus the sequence {u } is bounded inV and, as a
≤ (cid:107)a(cid:107)(cid:107)uh(cid:107)V(cid:107)vh−v(cid:107)V+|a(uh−u˜,v)|.
h (cid:124)(cid:123)(cid:122)(cid:125)(cid:124) (cid:123)(cid:122) (cid:125) (cid:124) (cid:123)(cid:122) (cid:125)
consequence3, there exists u¯∈V such that, up to a (∗) (∗∗) (∗∗∗)
subsequence still denoted h, {u
h
} weakly converges Byitem(i),(∗)isbounded. Besides(∗∗)goesto0as{vh}(strongly)
convergestovand(∗∗∗)goesto0as{uh}weaklyconvergestou˜
3Wehave: inV. Thusa(uh,vh)convergestoa(u˜,v).
Introducci´on al m´etodo de los elementos finitos 25
Then we get and the approximate problem is well-posed if, and only
if, there exists α >0 such that
a(u −u,u −u) = a(u ,u )−a(u ,u) h
h h h h h
−a(u,u )+a(u,u), (cid:32) (cid:33)
h a(v ,w )
h h
inf sup ≥α .
whichgoesto0ash→0. Bycoercivityofa,thelast vh∈Vh wh∈Wh (cid:107)v h (cid:107) V (cid:107)w h (cid:107) V h
convergence results implies that (cid:107)u −u(cid:107) −−→0.
h V
h→0
In this case, the approximate problem admits a unique
Step3. Estimate(C´ea’slemma). Letusprove
solution u which satisfies
h
the estimate. Taking v −u in the orthogonality
h h
equation of e h :=u−u h , we have
(cid:107)u (cid:107) ≤
(cid:107)L(cid:107) V(cid:48)
.
h V
α
0=a(e ,v −u )=a(e ,v −u)+a(e ,e ). h
h h h h h h h
Then we get Note that u h admits an a priori bound only if α h does
not tend to 0 when h tends to 0.
α(cid:107)e (cid:107)2 ≤(cid:107)a(cid:107)(cid:107)e (cid:107) (cid:107)v −u(cid:107) .
h V h V h V
Lemma 4.4 (Error estimate) Assume that
This inequality holds for any v ∈V so that the
h h
proof is concluded.
dim(V )=dim(W ),
h h
(cid:32) (cid:33)
(cid:4) a(v ,w )
h h
∀h>0, ∃α >0, inf sup ≥α .
This lemma shows that the approximation error ex- h vh∈Vh wh∈Wh (cid:107)v h (cid:107) V (cid:107)w h (cid:107) V h
pressed in theV−norm e is directly related to the dis-
h
tance between V and V h . Thus it is necessary to build Then we have
suitable approximation spaces V that allow us to esti-
h (cid:18) (cid:19)
mate the distance between the solution u andV . (cid:107)a(cid:107)
h (cid:107)u−u (cid:107) ≤ 1+ inf (cid:107)u−v (cid:107) .
h V h V
α h vh∈Vh
4.2 Elliptic problems: Petrov-Galerkin approximation
Let us consider a generalized version of the Galerkin Assume furthermore that
approximation: we consider two finite-dimensional sub-
spaces ofV, namelyV andW . We assume that those a uniform inf-sup condition holds:
h h
spaces have the same dimension, which is a mandatory
condition to expect the underlying linear problem to be ∃α >0, ∀h>0, α h ≥α,
well-posed. The approximate problem reads
 the approximability property of V holds:
Find u ∈V such that h
 h h
(P˜ ) a(u ,w )=L(w ),
h h h h
 for all w ∈W .
∀v∈V, limd(v,V
h
)=0.
h h h→0
The coercivity of a(·,·) onV×V is not sufficient to en-
sure existence and uniqueness of a solution for this ap- Then {u h } converges to u in V:
proximate problem. The well-posedness of the problem
is ensured by the two conditions of the Banach-Neˇcas- lim(cid:107)u−u h (cid:107) V =0,
h→0
Babuˇska theorem (see Theorem 3.3, page 15). Actually,
in finite dimension, the two conditions are equivalent5 Proof of Lemma 4.4. The well-posedness of the ap-
proximate problem is ensured by the two conditions of
5In the case of the finite dimensional framework, consider a
basis (φi)i=1,...,n (resp. (ψi)i=1,...,n) ofVh (resp. Wh). Any element the Banach-Neˇcas-Babuˇska theorem (see Theorem 3.3,
uh∈Vh andwh∈Wh canbedecomposedonthesebasesasfollows: page15)and,infinitedimensionwithdim(V
h
)=dim(W
h
),
uh=∑n i=1 Uiφi,wh=∑n j=1 Wiψi. WedenoteU thevector(U 1,...,Un)t∈ the two conditions are equivalent. Thus u h is uniquely
Rn andW thevector(W 1,...,Wn)t∈Rn andwedefinethevectorF=
determined.
((cid:104)L,ψ1 (cid:105),...,(cid:104)L,ψn(cid:105))t and the following matrix A=[a(φj,ψi)]i,j=1,...,n.
TheproblemconsistsinstudyingthelinearsystemAU=F. Besides the error e h :=u−u h satisfies the orthogonal-
Eq.(5)shouldbereadas(seealsoProposition3.17,page ity equation
20,forasimilarproof)
∃α˜ >0, ∀V∈Rn, (cid:107)AV(cid:107)Rn≥α˜(cid:107)V(cid:107)Rn, a(e h ,w h )=0, ∀w h ∈W h . (11)
whichmeansthatAisinjective;
Eq.(6)statesthatAt isinjective,i.e. Aissurjective. Let v h ∈V h . We have
Clearlyforan×n linear systemthetwoconditionsareequivalent
andanyofthemprovidesthewell-posedness. e h =u−u h =(u−v h )+(v h −u h ).
26 Introducci´on al m´etodo de los elementos finitos
Using first the inf-sup condition, then (11) and finally 4.3 Saddle-point problems and Galerkin approxima-
the continuity of a, we get tion
Let X and M be two Hilbert spaces. We consider, as
1 a(v h −u h ,w h ) in section 3.2, the following problem:
(cid:107)v −u (cid:107) ≤ sup
h h V
α (cid:107)w (cid:107)
=
1 hw
s
h
u
∈W
p
h a(v h − h u, V w h )   F
a
in
(u
d
,v
(
)
u
+
,p
b
)
(
∈
v,
X
p)
×M
=
su
L
ch
(v)
t
,
hat
α (cid:107)w (cid:107)
hwh∈Wh h V
b(u,q) = G(q),
≤
(cid:107)a(cid:107)
(cid:107)u−v h (cid:107) V .

for any (v,q)∈X×M.
α
h
Here L and G are continuous linear forms over X and
Thus we obtain
M respectively. We have seen that this problem is well
(cid:18) (cid:107)a(cid:107) (cid:19) posedifa(·,·)iscoerciveonX (oronthekernelofb)and
(cid:107)e (cid:107) ≤ 1+ (cid:107)u−v (cid:107) .
h V h V b satisfies the inf-sup condition
α
h
(cid:18) (cid:19)
b(v,p)
Thisinequalityholdsforanyv h ∈V h . Finallytheuniform inf sup ≥β >0.
control on α and the approximability property of V p∈M v∈X (cid:107)v(cid:107) X (cid:107)p(cid:107) M
h h
allow us to conclude the proof. (cid:4)
If we now consider X and M two finite-dimensional
h h
subspaces of X and M respectively, we may define an
In the Petrov-Galerkin approximation, different prop-
approximate problem:
erties are required:

Find (u ,p )∈X ×M such that
control of the approximation error associated to 
a(u ,v
h
)+
h
b(v ,
h
p )
h
= L(v ),
V , h h h h h
h
b(u ,q ) = G(q ),

for any (v ,q )
h
∈X
h
×M .
h
controloftheconstantintheinf-supcondition: sub- h h h h
spacesV andW should not be too a−orthogonal
h h
as h goes to 0.
Remark 4.6 Note that a Petrov-Galerkin approach is
Example. Let us consider the standard example of the possible by using test functions v h and q h in other spaces
problem −u(cid:48)(cid:48)= f with Dirichlet boundary conditions in thanX h andM h . Thesubsequentanalysisismoreintricate
1D:V =H1(]0,1[), a(u,v)= (cid:82)1u(cid:48)v(cid:48). so that we do not want to enter the details here.
0 0
We take a one-dimensional subspaceV ⊂V gener- Let us discuss the existence and convergence issue.
h
ated by p(x)=1−|2x−1| (its gradient is equal to What can we say about this approximate problem?
2 on [0,1/2[ and −2 on [1/2,1]).
If a(·,·) is coercive on X, then a is coercive on X
h
with the same constant of coercivity. In order to
We take a one-dimensional subspaceW ⊂V gen-
h
guarantee that the approximate problem is well-
erated by q(x)=sin(4πx) (its gradient is equal to
posed, it suffices for the inf-sup condition to be
4πcos(4πx)).
satisfied:
Observe that the inf-sup condition is not satisfied for (cid:32) (cid:33)
b(v ,p )
this problem since a(v h ,w h )=0 for any v h ∈V h ,w h ∈W h . inf sup h h ≥β h >0. (12)
Indeed, we have ph∈Mh vh∈Xh (cid:107)v h (cid:107) X (cid:107)p h (cid:107) M
(cid:90) 1 Because of the finite dimensional framework, a
a(p,q) = p(cid:48)q(cid:48) compactness argument allows us to show that this
0 (cid:32) (cid:90) 1 (cid:90) 1 (cid:33) condition is satisfied if, and only if,
2
= 8π cos(4πx)dx− cos(4πx)dx
0 2 1 1) p h ∈M h (cid:27) ⇒p =0.
= 0. 2) ∀v ∈X , b(v ,p )=0 h
h h h h
(cid:3) If we consider the restriction B(cid:48) of operator B:
h
M→X(cid:48) as an operator from M onto X(cid:48), then the
h h
above condition states that B(cid:48) should be injective
h
Remark 4.5 Even if a(·,·) is symmetric the resulting (see also Proposition 3.17, page 20). In partic-
Petrov-Galerkin approximate problem is not necessarily ular, the dimension of M should be lower than
h
symmetric. the dimension of X . Thus, the inf-sup condition
h
Introducci´on al m´etodo de los elementos finitos 27
is not satisfied if M is too big with respect to X . with (cid:107)B(cid:107)=(cid:107)b(cid:107). Moreover, we have
h h
If the discrete inf-sup condition is satisfied, there
exists a unique solution (u h ,p h )∈X h ×M h of the b(Ψ h v,q h ) =
(cid:10)
b(Φ h ((Bv) |Mh ),q h
(cid:11)
)
a
b
p
o
p
un
ro
d
x
s
i
:
mate problem and we have the following =
= (cid:10)
B
(B
h
v
Φ
)
h (B
,
v
q
) |M
(cid:11)
h ,q h M
h
(cid:48),Mh
|Mh h M
h
(cid:48),Mh
(cid:107)u
h
(cid:107)
X
≤
(cid:107)L(cid:107) X(cid:48)
+
1 (cid:18)
1+
(cid:107)a(cid:107) (cid:19)
(cid:107)G(cid:107)
M(cid:48)
,
=
=
(cid:104)
b
B
(v
v
,
,
q
q h
)
(cid:105)
.
M(cid:48),M
α β α h
h
The claim is proved. (cid:4)
(cid:18) (cid:19)(cid:18) (cid:19)
(cid:107)a(cid:107) 1 (cid:107)a(cid:107)
(cid:107)p
h
(cid:107)
M
≤ 1+
α β h
(cid:107)L(cid:107)
X(cid:48)
+
β h 2
(cid:107)G(cid:107)
M(cid:48)
.
Remark 4.9 We will see that the existence of such an
operator with a norm which does not depend on h is
If a(·,·) is coercive only on the kernel of b, then
a necessary and sufficient condition for the spaces X
nothing guarantees that it is coercive on Z the h
h and M to satisfy a uniform inf-sup condition for b (see
kerneloftherestrictionb:X ×M →R. Indeed,we h
h h Lemma 6.1 (Fortin’s lemma), page 45).
donothaveingeneraltheinclusionZ ⊂Z beacuse
h
an element v ∈Z is such that b(v ,p )=0 for
h h h h Let us now focus on the error estimate.
all p ∈M but there is no reason why b(v ,p)=
h h h
0 for any p∈M\M h . Thus, it is necessary to Lemma 4.10 (Error estimate) Assume that a is co-
impose to a(·,·) a coercivity constraint on Z h as ercive on V and that the discrete inf-sup condition (12)
a supplementary condition in order the discrete is satisfied, then we have
problem to be well-posed.
(cid:18) (cid:19)(cid:18) (cid:19)
(cid:107)a(cid:107) (cid:107)b(cid:107)
(cid:107)u−u (cid:107) ≤ 1+ 1+ d(u,X )
Then we have the convergence result (the proof read- h X h
α β
h
ily adapts from the proof of Lemma 4.1): (cid:107)b(cid:107)
+ d(p,M ),
h
α
Lemma 4.7 (Convergence) If there exists β >0 such
thatβ ≥β forallh>0andifd(v,X )→0andd(q,M )→ (cid:107)a(cid:107) (cid:18) (cid:107)a(cid:107) (cid:19)(cid:18) (cid:107)b(cid:107) (cid:19)
h h h
(cid:107)p−p (cid:107) ≤ 1+ 1+ d(u,X )
0 for all v∈X and for all q∈M, then (u h ,p h )→(u,p) h M β h α β h h
in X×M when h goes to 0. (cid:18) (cid:107)b(cid:107) (cid:107)a(cid:107)(cid:107)b(cid:107) (cid:19)
+ 1+ + d(p,M ).
h
β β α
h h
Let us focus on error estimates. We establish the
following result: Proof of Proposition 4.10. We introduce
Proposition 4.8 Assume that b satisfies the discrete e :=u−u , π =p−p .
h h h h
inf-sup condition (12) for the spaces X and M . For all
h h
h>0, there exists a continuous linear operator Ψ := We may observe that:
h
X →X
h
such that (cid:107)Ψ
h
(cid:107)≤ (cid:107)
β
b
h
(cid:107) and
(cid:26) a(e h ,v h )+b(v h ,π h ) = 0, ∀v h ∈X h ,
b(e ,q ) = 0, ∀q ∈M .
∀v∈X, ∀q ∈M , b(Ψ v,q )=b(v,q ). h h h h
h h h h h
Let us proceed in two steps:
Proof of Proposition 4.8. Usingtheinf-supcondition
(12) and Corollary 3.11, there exists a continuous right 1. The first equation is rewritten, for any q ∈M , as
h h
inverse Φ :M(cid:48) →X to the operator
h h h
a(e ,v )+b(v ,p−q )=b(v ,p −q ), ∀v ∈X .
h h h h h h h h h
B : X → M(cid:48)
h h h
v (cid:55)→ b(v ,·) By using forst the discrete inf-sup condition, then
h h
the equation above, and finally the continuity of a
with a norm which is bounded by 1/β . We define, for and b, we have
h
all v∈X,
1 b(v ,p −q )
h h h
Ψ h v=Φ h ((Bv) |Mh ). (cid:107)q h −p h (cid:107) M ≤ β
hv
s
h
u
∈X
p
h
(cid:107)v
h
(cid:107)
X
By construction, 1 a(e h ,v h )+b(v h ,p−q h )
= sup
β (cid:107)v (cid:107)
hvh∈Xh h X
1 (cid:107)B(cid:107) 1
(cid:107)Ψ
h
v(cid:107)
X
≤
β h
(cid:107)(Bv)
|Mh
(cid:107)
M h (cid:48)
≤
β h
(cid:107)v(cid:107)
X
, ≤
β h
((cid:107)a(cid:107)(cid:107)e
h
(cid:107)
X
+(cid:107)b(cid:107)(cid:107)p−q
h
(cid:107)
M
).
28 Introducci´on al m´etodo de los elementos finitos
By the triangle inequality, we have, for all q ∈M , and then
h h
(cid:107)π h (cid:107) M ≤(cid:107)p−q h (cid:107) M +(cid:107)q h −p h (cid:107) M , (cid:107)u−u h (cid:107) X ≤ (cid:107)u−(v h +r h )(cid:107) X +(cid:107)(v h +r h )−u h (cid:107) X
(cid:18) (cid:19)
(cid:107)a(cid:107)
hence ≤ 1+ (cid:107)u−(v h +r h )(cid:107) X
α
(cid:18)
(cid:107)b(cid:107)
(cid:19)
(cid:107)a(cid:107)
(cid:107)b(cid:107)
(cid:107)π h (cid:107) M ≤ 1+ d(p,M h )+ (cid:107)e h (cid:107) X . + α d(p,M h ).
β β
h h
Besides, the definition of r and the properties of
We have thus obtained an estimate on the error π h
h
operator Ψ imply
in function of the error e . h
h
2. Letv h ∈X h . Wedefiner h =Ψ h (u−v h ), whereΨ h is (cid:107)u−(v h +r h )(cid:107) X ≤ (cid:107) (cid:18) u−v h (cid:107) X (cid:19) +(cid:107)r h (cid:107) X
the operator defined in (the proof of) Proposition (cid:107)b(cid:107)
≤ 1+ (cid:107)u−v (cid:107) .
h X
4.8. By definition, we have that β h
b(u−v
h
−r
h
,q
h
)=0, ∀q
h
∈M
h
. This holds for all v
h
∈X
h
and we thus obtain
(cid:18) (cid:19)(cid:18) (cid:19)
As b(e ,q )=0 for all q ∈M , we get (cid:107)a(cid:107) (cid:107)b(cid:107)
h h h h (cid:107)u−u (cid:107) ≤ 1+ 1+ d(u,X )
h X h
α β
h
b(u
h
−(v
h
+r
h
),q
h
)=0, ∀q
h
∈M
h
. (13)
(cid:107)b(cid:107)
+ d(p,M ).
h
α
Thus we choose (v +r )−u as a test function in
h h h
the first equation and we get The pressure estimate is obtained by using the
above estimate.
a(e ,(v +r )−u )+b((v +r )−u ,π )=0.
h h h h h h h h
Since,by(13),(v +r )−u isb−orthogonaltoM ,
h h h h (cid:4)
we may replace π in the second term by p−q ,
h h
with an arbitrary q ∈M : The estimate depends not only on the approxima-
h h
tion error for every space X and M but also on the
h h
a(e ,(v +r )−u )+b((v +r )−u ,p−q )=0.
h h h h h h h h dependency of the constant β in the inf-sup condition
h
Then we deal with the quantity A :=a((v +r )− with respect to the discretization parameter. Let us now
h h
study how approximation spaces (V on the one hand,
u ,(v +r )−u ). On the one hand, by coercivity, h
h h h h
X and M on the other hand) can be built.
h h
α(cid:107)(v +r )−u (cid:107)2 ≤|A|. (14)
h h h X
4.4 Approximation spaces
On the other hand, as u h =u−e h , Some principles rule the choice of approximation
spaces V and a basis (φ) of such spaces. Let us note
A = a((v +r )−u+e ,(v +r )−u ) h i i
= a((v
h
+r
h
)−u,(v
h
+r
h
)−u
h
)
h that finding a solution u
h
=∑
j
u
j
φ
j
of a variational prob-
h h h h h lem consists in solving a linear system with matrix A
+a(e ,(v +r )−u )
h h h h defined by a =a(φ ,φ). Inpractive, itis thus necessary
= a((v +r )−u,(v +r )−u ) ij j i
h h h h h to:
−b((v +r )−u ,p−q ),
h h h h
compute the coefficients,
We obtain
build the most simple matrix, i.e. the related sys-
|A| ≤ (cid:107)a(cid:107)(cid:107)u−(v +r )(cid:107) (cid:107)(v +r )−u (cid:107)
h h X h h h X tem should be“easily”solved.
+(cid:107)b(cid:107)(cid:107)v +r −u (cid:107) (cid:107)p−q (cid:107) . (15)
h h h X h M
The definition of the space and the choice of a basis is
Combining Eqs. (14) and (15), we get
crucial. Let us discuss some examples:
(cid:107)a(cid:107)
(cid:107)(v h +r h )−u h (cid:107) X ≤ (cid:107)u−(v h +r h )(cid:107) X IfwedefineV h asthesetofpolynomialfunctionsof
α degree less than N, with its canonical basis defined
(cid:107)b(cid:107)
+ (cid:107)p−q (cid:107) , by the monomials, then the related matrix is likely
h M
α
to be dense. Of course, if we choose a basis of
where q h ∈M h is arbitrary. Hence, polynomials which are orthogonal for the scalar
productdefinedbya(whenaissymmetric,positive
(cid:107)a(cid:107)
(cid:107)(v +r )−u (cid:107) ≤ (cid:107)u−(v +r )(cid:107) definite), then the matrix is diagonal and solving
h h h X h h X
α
the related linear system is easy. This can possibly
(cid:107)b(cid:107)
+ d(p,M h ), done by using a Gram orthonormalisation process.
α
Introducci´on al m´etodo de los elementos finitos 29
An efficient method consists in defining the ap- is an isomorphism from V onto RN+2. In particular
h
proximation space as the subspace generated by dim(V )=N+2.
h
the eigenfunctions of the operator that defines the
PDE. If the solution is regular, we can prove under Proof of Lemma 5.1. In 1D, H1(Ω)⊂C0(Ω¯). Con-
suitable assumptions that the method is quite effi- versely, continuous functions that are affine on each ele-
cient: this is the very basis of the so-called spectral ment belong to H1(Ω). The properties of the mapping,
methods. i.e. Φ is linear and bijective, follow from the fact that a
piecewise affine function is uniquely defined by its values
Example. We denote V the space generated by
N at the nodes of the mesh. (cid:4)
the first N eigenfunctions of the Dirichlet-Laplace
operator in 1D (i.e. x(cid:55)→sin(kπx) on ]0,1[, then we
have (Parseval’s identity): Remark 5.2 Thechoiceofaconformingapproximation
space may have important consequences: assume that we
C
∀u∈Hm(]0,1[), d(u,V
N
)≤
Nm
k (cid:107)u(cid:107) Hm. a
V
r
,
e
u
inte
∈
re
P
st
1
e
}
d
i
i
s
n
a
V
n
=
ap
H
pr
2
o
(
x
Ω
im
).
a
T
tio
h
n
en
sp
w
a
e
ce
ca
w
n
it
s
h
ho
d
w
im
t
e
h
n
a
s
t
io
{
n
u∈
2
|Ki
(cid:3) (it is the set of affine functions over the whole domain)!
Thus it is clear that this approximation has a very limited
interest for the numerical approximation of a variational
This method has a major drawback, as we only formulation dealing with H2(Ω).
knowtheeigenfunctionsoftheoperatorinalimited
number of cases. In the other cases, we use the AsΦisbijective,anyelementu∈V canbeidentified
h
eigenfunctions of another operator with the secret to Φ(u)∈RN+2. The elements of Φ(u) are refered to as
hope that it will work fine. Besides, the matrix degrees of freedom in the approximation spaceV .
h
is dense, which may lead to heavy computational When the degrees of freedom take the form u (cid:55)→
costs. u(a) with a∈Ω¯, we refer the method to Lagrange finite
elements. The points a are the nodes associated to the
In the next section, we will focus on the finite ele- i
approximation space. In the case of P1 finite elements,
mentmethod. Themainideaconsistsincuttingthe
the nodes a coincide with the points x which define the
domain into small pieces or elements and defining i i
mesh. However, this is not always the case as we will see
the approximation space as a set of piecewise reg-
below for instance for the P2 elements.
ular functions with a particular structure on each
element. Piecewisepolynomialsareclassicallyused
Definition 5.3 We denote e for i=0,...,N+1 the vec-
in this prospect. i
tors of the canonical basis of RN+2. We denote φ the
i
shapefunctionassociatedtothenodex suchthatΦ(φ)=
5. Examples of finite element spaces i i
e. Thus the functions φ ∈V are defined by the property
i i h
5.1 Finite elements in 1D: P1 finite element
φ(x )=δ , ∀i,j∈{0,...,N+1},
ApproximationspaceP1 in1D.WeconsiderΩ=]0,1[ i j ij
et we target the definition of a suitable approximation
see Figure 3.
space for V =H1(Ω). For this we mesh the domain Ω.
In the 1D framework: the domain is divided in segments Letusestimatetheapproximationerrorassociatedto
[x i ,x i+1 ], i∈{0,...,N} so that x i <x i+1 and x 0 =0 and V h . For this let us introduce the notion of interpolation
x N+1 =1. Wedefinethemeshsizeh:=sup i |x i+1 −x i |and operator. Wedenotebyv(cid:55)→|v| Hk theseminormonHk(Ω),
we denote by K i :=[x i ,x i+1 ] the cells of the mesh. defined by
Let us consider the set of piecewise affine functions: (cid:32) (cid:33)1
2
V h ={u∈V, u |Ki ∈P1}, |v| Hk =
|α
∑
|=k
(cid:107)∂αv(cid:107)2 L2 ,
where P1 is the set of polynomials of degree 1. Notice with the consistent convention:
thatweconsideraconformingapproximationspacesince,
by construction,V h ⊂V. H0(Ω)=L2(Ω), |v| H0 =(cid:107)v(cid:107) L2 .
Lemma 5.1 The space V writes
h
V h ={u∈C0(Ω¯), u |Ki ∈P1}, Definition 5.4 (Interpolation operator I
h
1) Thein-
terpolation operator I1 from V onto V is defined as
and, moreover, the mapping h h
Φ:u(cid:55)→(u(x ),...,u(x )) ∀u∈V,
I1u=Φ−1(cid:0)
u(x ),...,u(x )
(cid:1)
0 N+1 h 0 N+1
30 Introducci´on al m´etodo de los elementos finitos
φ
i−1
φ
i
φ
i+1
x x x
i−1 i i+1
Figure 3. P1 finite element in 1D: global shape functions φ i−1 , φ i and φ i+1 .
i.e. Proof of Proposition 5.5. Thebasicideareliesonthe
analysis of I1u−u on each element of the mesh. Let
N+1 h
∀u∈V, ∀x∈Ω¯, I1u(x)= ∑ u(x)φ(x). i∈{0,...,N} and let x∈K i .
h i i
i=0 Step 1. Derivation of estimates (16) and (17). For
x∈[x,x ] we have
Let us notice that if u∈H1(Ω), then I1u∈H1(Ω) i i+1
0 h 0
and thus u(x −x)+u (x−x)
I1(x)= i i+1 i+1 i (21)
V h,0 :=V h ∩H 0 1(Ω) h h i
is a conforming approximation space for H1(Ω). Let us with u =u(x) and h =x −x. Thus
0 i i i i+1 i
now derive the estimates on I1.
h (u −u(x))(x −x)+(u −u(x))(x−x)
We illustrate the shape of the P1 interpolation for a I1(x)−u(x)= i i+1 i+1 i ,
h h
given function in Figure 5 (solid black line). i
so that we obtain by the Cauchy-Schwarz inequality,
e T rt h ie e s or h e o m ld: 5.5 (Properties of I h 1) Thefollowingprop- (cid:12) (cid:12) I h 1(x)−u(x) (cid:12) (cid:12) ≤ ≤ | (cid:12) (cid:12) (cid:12) u (cid:90) i − x u u (cid:48)( ( t x ) ) d | t + (cid:12) (cid:12) (cid:12)+ |u (cid:12) (cid:12) (cid:12) i+ (cid:90) 1 x − i+1 u u (x (cid:48)( ) t | )dt (cid:12) (cid:12) (cid:12)
1. There exists C>0 such that (cid:12) xi (cid:12) (cid:12) x (cid:12)
∀u∈V, (cid:107)I h 1u−u(cid:107) L2 ≤Ch|u| H1 , (16) ≤ 2h i 1 2 (cid:18)(cid:12) (cid:12) (cid:12) (cid:12) (cid:90) xi xi+1(cid:12) (cid:12)u(cid:48)(t) (cid:12) (cid:12) 2 dt (cid:12) (cid:12) (cid:12) (cid:12) (cid:19) 2 1
∀u∈V, (cid:12) (cid:12) I h 1u−u (cid:12) (cid:12) H1 ≤C|u| H1 . (17) and then
2. There exists C>0 such that
(cid:90)
xi
xi+1(cid:12)
(cid:12) I h 1(x)−u(x) (cid:12) (cid:12) 2 dx≤4h2 i
(cid:18)(cid:12)
(cid:12) (cid:12) (cid:12)
(cid:90)
xi
xi+1(cid:12)
(cid:12)u(cid:48)(t) (cid:12) (cid:12) 2 dt
(cid:12)
(cid:12) (cid:12) (cid:12)
(cid:19)
∀u∈V∩H2(Ω), (cid:107)I1u−u(cid:107) ≤Ch2|u| , (18)
h L2 H2 and, by summation,
∀u∈V∩H2(Ω), (cid:12) (cid:12) I h 1u−u (cid:12) (cid:12) H1 ≤Ch|u| H2 . (19) (cid:107)I h 1u−u(cid:107) L2 ≤2h(cid:107)u(cid:48)(cid:107) L2 =2h|u| H1 , (22)
which is the estimate described in Eq. (16).
3. We have
Besides, a consequence of the above estimate is that
∀u∈V, lim(cid:107)I1u−u(cid:107) =0.
h H1 (cid:107)I1u(cid:107) ≤C(cid:107)u(cid:107) .
h→0 h L2 H1
In particular, for all u∈V, limd(u,V )=0. Back to Eq. (21), we have
h
h→0 (cid:12) (cid:12)
Remark 5.6 Theestimate (19)cannotbeimprovedeven (cid:12) (cid:12)(I h 1u)(cid:48)(x) (cid:12) (cid:12) = (cid:12) (cid:12) (cid:12) u i+1 h − i u i(cid:12) (cid:12) (cid:12)
e i u f r ∈ e u d H i i s n m m + t 1 h o ( e r Ω e f ) o r , l e l g o u w la in r g . B es e t s im id a e t s e E : q fo . r (1 a 6 l ) l – m (1 ∈ 9) {0 ca ,1 n }, be fo g r at a h ll - = ≤ h 1 1 i (cid:12) (cid:12) (cid:12) (cid:12) (cid:90) (cid:18) x (cid:90) i xi+ x 1 i+ u 1 (cid:48) (cid:12) (cid:12) ( u t) (cid:48)( d t t ) (cid:12) (cid:12) (cid:12) (cid:12) (cid:12) (cid:12) 2 dt (cid:19) 2 1 ,
(cid:107)I h 1u−u(cid:107) L2 +h (cid:12) (cid:12) I h 1u−u (cid:12) (cid:12) H1 ≤Chm+1|u| Hm+1 . (20) h i 2 1 xi
Introducci´on al m´etodo de los elementos finitos 31
by the Cauchy-Schwarz inequality, hence We deduce
(cid:90) xi+1(cid:12) (cid:12)(I h 1u)(cid:48)(x) (cid:12) (cid:12) 2 dx≤ (cid:90) xi+1(cid:12) (cid:12)u(cid:48)(t) (cid:12) (cid:12) 2 dt. (cid:90) xi+1(cid:12) (cid:12) I h 1−u (cid:12) (cid:12) 2 ≤ (cid:90) xi+1 R2 i + (cid:90) xi+1 R2 i+1 (23)
xi xi xi xi xi
T
Th
h
u
u
s
s
w
w
e
e
o
h
b
a
t
v
a
e
in
(cid:107)(I h 1u)(cid:48)(cid:107) L2 ≤(cid:107)u(cid:48)(cid:107) L2 , i.e. (cid:12) (cid:12) I h 1u (cid:12) (cid:12) H1 ≤|u| H1 . Let us now estimate (cid:82)
x
x
i
i+1R2
i
. First we have
(cid:12) (cid:12) I h 1u−u (cid:12) (cid:12) H1 ≤ (cid:12) (cid:12) I h 1u (cid:12) (cid:12) H1 +|u| H1 ≤2|u| H1 , (cid:12) (cid:12)R2 i (x) (cid:12) (cid:12)≤ 2 1(cid:90) 1(cid:12) (cid:12)u(cid:48)(cid:48)(x+t(x i −x)) (cid:12) (cid:12) 2 (x i −x)4dt
0
which is the estimate described in Eq. (17).
≤
h3
i
(cid:90) x
(cid:12) (cid:12)u(cid:48)(cid:48)(cid:12) (cid:12) 2 (24)
2 xi
Remark 5.7 The estimate proves that if u∈V, then
I {I h 1
h
u 1u w } e i a s k b ly ou c n o d n e v d e i r n ge H s 1 t ( o Ω u ), i t n he H re 1( i Ω s ) a w su h b e s n eq h ue → nce 0. {h A
n
} s ≤ h 2 3 i (cid:90) xi xi+1(cid:12) (cid:12)u(cid:48)(cid:48)(cid:12) (cid:12) 2 ,
suchthath →0and{I1u}weaklyconvergestosomeu∗
n hn which yields
in H1(Ω). By Eq. (22) the strong limit of I1u in L2 is u.
hn
w B e y c u o n n iq c u lu e d n e es t s ha o t f t t h h e e l w im ea i k t i l n im t i h t e in sen H s 1 e o o f f t d h i i s s tr s i e b q u u ti e o n n c s e , (cid:90) xi xi+1 R2 i ≤ h 2 4 i (cid:90) xi xi+1(cid:12) (cid:12)u(cid:48)(cid:48)(cid:12) (cid:12) 2 ,
is also u, hence u∗=u. By uniqueness of the adherent
value (or closure point), the whole sequence I1u weakly ans the same estimate for R i+1 . Putting this in-
h
converges to u in H1, see Theorem 4.2. In fact we will equality into Eq. (23), we get
prove below that I1u strongly converges to u in H1.
h (cid:90) xi+1(cid:12)
(cid:12) I h 1u−u (cid:12) (cid:12) 2 ≤h4 i
(cid:90) xi+1(cid:12)
(cid:12)u(cid:48)(cid:48)(cid:12) (cid:12) 2 .
Step 2. Derivation of estimates (18) and (19). By
xi xi
Eq. (21), which provides Eq. (18) by summation over i.
u −u
(I1u)(cid:48)(x)−u(cid:48)(x)= i+1 i −u(cid:48)(x). We write (∗∗):=(I1u)(cid:48)(x)−u(cid:48)(x) as:
h h h
i
Using Taylor’s formula, we have (∗∗)= u i+1 −u i −u(cid:48)(x)= R i+1 (x)−R i (x) ,
h h
u = u(x)+(x −x)u(cid:48)(x)+R(x), i i
i i i
u = u(x)+(x −x)u(cid:48)(x)+R (x), and then, by (24),
i+1 i+1 i+1
with (cid:12) (cid:12)(I1u)(cid:48)(x)−u(cid:48)(x) (cid:12)
(cid:12)
2
h
1(cid:90) 1 2
R(x):= (1−t)u(cid:48)(cid:48)(x+t(x −x))(x −x)2dt. ≤ (|R(x)|2+|R (x)|2)
We obt
i
ain the
2
fo
0
llowing estimates
i
:
i
≤h
h
i
2 i(cid:90) x
(cid:12) (cid:12)
i
u(cid:48)(cid:48)(t) (cid:12) (cid:12) 2 dt
i
+
+1
h i
(cid:90) xi+1(cid:12)
(cid:12)u(cid:48)(cid:48)(t) (cid:12) (cid:12) 2 dt.
We write (∗)=I1u(x)−u(x) as:
xi x
h
Thus,
(u −u(x))(x −x)+(u −u(x))(x−x)
(∗)=
i i+1 i+1 i
(x −x)u(cid:48)(x)(x −x h ) i +(x −x)u(cid:48)(x)(x−x) (cid:90) xi+1(cid:12) (cid:12)(I h 1u)(cid:48)−u(cid:48)(cid:12) (cid:12) 2 ≤h2 i (cid:90) xi+1(cid:12) (cid:12)u(cid:48)(cid:48)(t) (cid:12) (cid:12) 2 dt,
= i i+1 i+1 i xi xi
h
i
(cid:124) (cid:123)(cid:122) (cid:125) which provides Eq. (19) by summation over i.
=0
R(x)(x −x)+R (x)(x−x)
+
i i+1 i+1 i
h Step3. Convergence in H1. By density of H2(Ω) in
i
H1(Ω),theproofmaybeconcluded. Foreveryu∈H1(Ω),
hence, by Jensen’s inequality6,
and any n≥1, there exists u ∈C∞(Ω) such that
(n)
(cid:12)
(cid:12)
I1(x)−u(x) (cid:12)
(cid:12)
2
h 1
≤ R2 i (x)(x i+1 −x)+R2 i+1 (x)(x−x i ) (cid:107)u(cid:48)−u(cid:48) (n) (cid:107) L2 < n , ∀n≥1.
h
i
≤R2 i (x)+R2 i+1 (x). Since I1 is a linear mapping, and using the uniform
h
6Byconvexityofx(cid:55)→x2,wehave,forτ∈[0,1], estimate (17), we have for any n≥1 and any h>0
(a(1−τ)+bτ)2≤(1−τ)a2+τb2.
C
(cid:107)(I1u)(cid:48)−(I1u )(cid:48)(cid:107) ≤C(cid:107)u(cid:48)−u(cid:48) (cid:107) ≤ ,
h h (n) L2 (n) L2 n
32 Introducci´on al m´etodo de los elementos finitos
whereCdoesnotdependonh. Bythetriangleinequality, Straightforward computations lead to the following
and (19), it comes properties:
(cid:107)u(cid:48)−(I h 1u)(cid:48)(cid:107) L2 ≤ (cid:107)u(cid:48)−u(cid:48) (n) (cid:107) L2 +(cid:107)u(cid:48) (n) −(I h 1u (n) )(cid:48)(cid:107) L2 Proposition 5.9 (Properties of T i ) For any function
+(cid:107)(I1u)(cid:48)−(I1u )(cid:48)(cid:107) φ ∈H1(K i ),
h h (n) L2
≤ C n +Ch (cid:12) (cid:12)u (n) (cid:12) (cid:12) H2 . (cid:107)φ◦T(cid:107) =√ 1 (cid:107)φ(cid:107) , |φ◦T| = (cid:112) h |φ| .
i L2(Kˆ)
h
L2(Ki) i H1(Kˆ) i H1(Ki)
i
It follows that, for any n≥1,
Moreover we have
C
limsup(cid:107)u(cid:48)−(I h 1u)(cid:48)(cid:107) L2 ≤ n . (I h 1u)◦T i =I 0 1(u◦T i ). (29)
h→0
Now let us derive the estimates:
Letting n→∞, we conclude that
We apply Eq. (25) to φ =u◦T and use (29):
i
limsup(cid:107)u(cid:48)−(I1u)(cid:48)(cid:107) ≤0, (cid:107)(I1u)◦T −u◦T(cid:107) ≤C|u◦T| ,
h L2 h i i L2(Kˆ) i H1(Kˆ)
h→0
then with the change of variables
which proves the claim. (cid:4)
(cid:107)I1u−u(cid:107) ≤Ch |u| ,
From the reference element Kˆ to element K.
h L2(Ki) i H1(Ki)
i
By summation over i, we get the estimate (16).
The previous analysis is done on each cell K sepa-
i
rately and then global estimates are obtained by summa- The other proofs can be adapted in a similar way
tionoverallthecells. Inviewofthegeneralisationofthe to derive estimates (17), (19) and (18).
analysis to higher dimensions and more general approxi-
As a conclusion, the estimate of the interpolation error
mation spaces, it is interesting to rewrite the previous
over a fixed interval Kˆ allows us to derive the local
analysis by means of changes of variable that transform
estimate over the elements of the mesh.
each element K into a single reference element Kˆ. In
i
this strategy, we only need to analyse the interpolation Example of P1 approximation of an elliptic prob-
properties on the reference element, and to analyse the lem in 1D. Consider Ω=]0,1[ and
properties of the change of variables. (cid:26) −(K u(cid:48))(cid:48)+αu = f, in Ω,
The advantages are twofold: 1) computations are
u = 0, on {0,1},
easier and 2) the method applies for higher order finite
elements in higher dimension! withα≥0, f ∈L2(Ω), K ∈L∞(Ω)andinf(K )>0. The
Let us give the main idea of the process in the case corresponding variational formulation writes
of the P1 finite element in 1D that we just analysed 
Find u∈V such that
before. We consider the unit interval Kˆ =[0,1] as a 
(P) a(u,v)=L(v),
reference element and we denote by I1 the Lagrange
0  for all v∈V,
interpolation operator of degree 1 on this interval with
the nodes {0,1}. If we assume that there exists C>0 withV =H1(Ω) and
0
such that
(cid:90) 1 (cid:90) 1
a(u,v)= K u(cid:48)v(cid:48)+α uv,
∀v∈H1(Kˆ), (cid:107)I1v−v(cid:107) ≤C|v| , (25) 0 0
0 L2(Kˆ) H1(Kˆ)
(cid:90) 1
∀v∈H1(Kˆ), (cid:12) (cid:12) I 0 1v−v (cid:12) (cid:12) H1(Kˆ) ≤C|v| H1(Kˆ) , (26) L(v)=
0
fv.
∀v∈H2(Kˆ), (cid:107)I 0 1v−v(cid:107) L2(Kˆ) ≤C|v| H2(Kˆ) , (27) Problem(P)admitsauniquesolutionbytheLax-Milgram
∀v∈H2(Kˆ), (cid:12) (cid:12) I 0 1v−v (cid:12) (cid:12) H1(Kˆ) ≤C|v| H2(Kˆ) , (28) t s h tr e a o c r t em pr . o T bl h e e m G c a o l n e s r i k s i t n s i a n pp so ro lv x i i n m g a t t h io e n fo o l f lo t w he in e g ll p ip r t o i b c le a m b-

then we can deduce immediately the results stated in Find u ∈V such that
 h h,0
Theorem 5.5. Indeed, for i∈{0,...,N} we recall the no- (P ) a(u ,v )=L(v ),
h h h h
tation K i =[x i ,x i+1 ] and we introduce the affine mapping  for all v h ∈V h,0 .
that transforms any cell K to the unit cell Kˆ =[0,1]:
i
Problem (P ) admits a unique solution u by the Lax-
h h
Milgram theorem. By Theorem 5.5 we have d(u,V )≤
Definition 5.8 (Affine mapping T i ) Weintroducethe h,0
affine change of variables
(cid:107)u−I
h
1u(cid:107)
V
→0 as h→0. Combined with C´ea’s lemma,
see Lemma 4.1, we deduce the convergence of u towards
h
T : Kˆ → K u without any additional assumption. Moreover, we can
i i
t (cid:55)→ (1−t)x +tx . estimate the error as follows.
i i+1
Introducci´on al m´etodo de los elementos finitos 33
Theorem 5.10 (P1 error estimate) Assume that the hence the result. (cid:4)
solution of (P) is regular, i.e. u∈H2(Ω), then
Actuallytheaboveresultissomehowgeneralandnot
(cid:107)a(cid:107) particular to P1 approximation.
(cid:107)u−u (cid:107) ≤C h|u| .
h V
α
H2
Practical aspects related to the computation of
the approximate solution.
Insomecasestheellipticproblemhassomeregularity
propertieswhichimplythat,ifthesourcetermisL2 then
thesolutionisH2. Inthecurrentcasethispropertyholds Exercise 11 Let {φ i } i=1,...,N be a basis for V h,0 . Prove
ifAissufficientlyregular(Lipschitzcontinuityisenough) that (P ) is equivalent to a linear system (to be deter-
h
and we get the elliptic regularity property: there exists mined): find U ∈ RN such that A·U = b, where A ∈
C>0 such that the unique solution of the variational M N×N (R) and b∈RN.
problem belongs to H2(Ω) and satisfies
Afunctionu
h
∈V
h,0
takestheformu
h
=∑N
i=1
u
i
φ
i
,since
(cid:107)u(cid:107) H2(Ω) ≤C(cid:107)f(cid:107) L2(Ω) . the degrees of freedom corresponding to boundary nodes
are 0. Hence, this solution is completely determined by
The error estimate becomes:
U :=(u) . The variational formulation then takes
i i=1,...,N
the form A·U =b with
(cid:107)u−u (cid:107) ≤Ch(cid:107)f(cid:107) .
h V L2(Ω)
A=(a(φ ,φ)) , b=(L(φ)) .
Let us discuss the derivation of estimates in a weaker j i 1≤i,j≤N i 1≤i≤N
norm (e.g. in L2(Ω)). In order to derive a new estimate, In our example, matrix A splits into A(r)+αA(m)
weneedtoassumefurthermorethattheadjoint problem7
(cid:90) 1 (cid:90) 1
satisfies a so called elliptic regularity property: there A = K φ(cid:48)φ(cid:48)+α φφ
existsC>0suchthatforallv∈L2(Ω)theuniquefunction ij
0
i j
0
i j
(cid:124) (cid:123)(cid:122) (cid:125) (cid:124) (cid:123)(cid:122) (cid:125)
φ ∈V such that
v A(r) A(m)
i,j i,j
a(w,φ )=(v,w) , ∀w∈V
v L2 where A(r) is the so-called rigidity matrix whereas A(m)
satisfies is the so-called mass matrix. In the case of the P1 finite
element, integrals are zero as soon as |i−j|>1 because
φ v ∈H2(Ω), (cid:107)φ v (cid:107) H2(Ω) ≤C(cid:107)v(cid:107) L2(Ω) . the supports of φ i and φ j are disjoint in that case. Thus
the remaining computations are the following ones:
In our example this property is clearly satisfied be-
cause the adjoint problem is identical to the initial one A (r) = − 1 (cid:90) xi K ,
by symmetry of the bilinear form a. i,i−1 h2
i−1 xi−1
A (r) =
1 (cid:90) xi
K +
1 (cid:90) xi+1K
,
e a
T jo
r p t
h i
p y
n e
r .
t
o
o
T x
p r
i
r e
h m
o
e
m b
a n
l
t
e
i t
5 m
o h
.
n e
1 o 1
s u
f
o h
( (
lu
P A
s t a
)
i
u
t o
s
i
b
n s
a
f
t i
y u
n is - fi
o
N e
f
s i
(
t
P
t s h
)
c e
a
h
n
e e l
d
) lip
i
A
t
t
s
i s c s
P
u r
1
m eg
fi
e u
n
l t
i
a h
te
r a i t t
e
y
l
t
e
h p
m
e r
e
o a
n
p d
t
- -
A A
i
i
(
(
,
,
r
m
i
i
)
+ ) 1 = = − (cid:90)
h2 i−
h x
1
i 2 i
1
φ
(cid:90)
x
x
i
i x − i+ 1
φ
1K
= , h i
h
−
2 i
1
xi
(cid:107)u−u h (cid:107) L2 ≤Ch(cid:107)u−u h (cid:107) H1 . A ( i, m i− ) 1 = (cid:90) xi x − i+ 1 1 φ i− 2 1 = i h i−1 6 +h i ,
In particular, if u∈H2(Ω), Theorem 5.10 leads to i ( , m i ) (cid:90) xi x − i+ 1 1 i 3 h i
(cid:107)u−u h (cid:107) L2 ≤Ch2|u| H2 . A i,i+1 = xi φ i φ i+1 = 6
Proof of Theorem 5.11. Denote e =u−u ∈V. Tak- with suitable adaptations for i=1 and i=N.
h h
ing v=w=e in the adjoint problem, we get
h
Proposition 5.12 The matrix A is tridiagonal, sym-
(cid:107)e h (cid:107)2 L2(Ω) =a(e h ,φ eh ). metric and positive-definite. Moreover it satisfies the
discrete maximum principle
As the error e :=u−u is a−orthogonal toV , we have
h h h
A−1≥0.
(cid:107)e (cid:107)2 = a(e ,φ −I1φ )
h L2(Ω) h eh h eh
≤ (cid:107)a(cid:107)(cid:107)e (cid:107) (cid:107)φ −I1φ (cid:107) ProofofProposition5.12. Thefirstpartfollowsfrom
h V eh h eh H1 the fact that A is a Gram matrix8 of (φ) inV for
≤ Ch(cid:107)e (cid:107) (cid:107)φ (cid:107) i i=1,...,N
h V eh H2
≤ Ch(cid:107)e h (cid:107) V (cid:107)e h (cid:107) L2(Ω) , 8A Gram matrix G of a set of vectors (v 1,...,vn) in an inner
productspaceistheself-adjointmatrixofinnerproducts,whose
7Thismeansthattheunknownisnowthesecondvariableof entriesaregivenbyGij=(vi,vj). AGrammatrixispositivesemi-
thebilinearformaandthetestfunctionisthefirstvariableofa. definite.
34 Introducci´on al m´etodo de los elementos finitos
some scalar product. The discrete maximum principle the existence of a Lagrange interpolation polynomial on
consists in showing that A is a M-matrix9. (cid:4) each K. (cid:4)
i
In practical computations, integrals are numerically (cid:127)Although the degree of the polynomials has been
computed with quadrature formula. This may induce
increased, we do not build a conforming approximation
additional work in order to guarantee that this process spaceforH2 sincethecontinuity of the derivativesatthe
does not induce a loss of precision.
interfaces would be required.
5.2 Finite elements in 1D: P2 finite element Each of the coordinates functions of Φ is a linear
Approximation space P2 in 1D. Assume that the form onV h which is called degree of freedom. They all
solution of a problem is much more regular (e.g of class consist in evaluating the function at some point, which
C∞) than it is expected from the variational formulation leads to the Lagrange terminology. The definition of the
of the problem. The P1 finite element method does not shapefunctionsfortheP2 finiteelementfollowsthesame
allow us to get a better precision: indeed the precision rule as for the P1 finite element, up to the dimension
of the interpolation operator which is associated to the modifications.
approximation space does not increase when increasing
The shape functions (φ) and (φ ) are defined by
the regularity of the interpolated function. In order i i i+ 2 1 i
to take advantage from the regularity of the solution
φ(x ) = δ , ∀j∈{0,...,N+1},
(withoutmodifyingthemesh)itisnecessarytoadaptthe i j ij
φ(x ) = 0, ∀j∈{0,...,N},
approximation space. Instead of considering piecewise i j+1
2
affine functions, we now consider piecewise quadratic
φ (x ) = 0, ∀j∈{0,...,N+1},
functions. i+ 2 1 j
φ (x ) = δ , ∀j∈{0,...,N},
Using the same notations as before, we introduce the i+1 j+1 ij
2 2
center of the elements x = xi+xi+1, for i=0,...,N. Let
i+ 2 1 2 see Figure 4. Thus
us now consider the set of piecewise quadratic functions:
the support of φ is K ∪K;
i i−1 i
V ={u∈V, u ∈P2},
h |Ki
the support of φ is K.
i+1 i
where P2 is the set of polynomials of degree 2. 2
Lemma 5.15 The space V writes Definition 5.16 (Interpolation operator I2) Thein-
h h
terpolation operator I2 from V onto V is defined as
V ={u∈C0(Ω¯), u ∈P2}, h h
h |Ki
N+1 N
and, moreover, the mapping I h 2u(x)= ∑ u(x i )φ i (x)+∑u(x i+1 )φ i+1 (x),
i=0 i=0 2 2
Φ:u(cid:55)→(u(x ),u(x ),u(x ),u(x ),...,u(x ),u(x ))
0 1
2
1
2
3 N+1
2
N+1
for all u∈V, for all x∈Ω.
is an isomorphism from V h onto R2N+3. In particular Let us notice that if u∈H1(Ω), then I2u∈H1(Ω)
dim(V
h
)=2N+3.
andthusV ∩H1(Ω)isaconform
0
ingapproxim
h
ations
0
pace
h 0
for H1(Ω). As before, I2 is a continuous projection
ProofofLemma5.15. TheinjectivityofΦcomesfrom 0 h
of H1(Ω) into itself and we can derive the following
thefactthatapolynomialofdegree2withthreedistinct
interpolation properties:
roots is necessary zero. Surjectivity of Φ emerges from
9Werecallthedefinition: Theorem 5.17 (Properties of I
h
2) There exists C>
0 such that, for all m∈{0,1,2}, for all u∈Hm+1(Ω),
Definition 5.13 A so-called M-matrix which satisfies the follow-
ing conditions: (cid:107)I h 2u−u(cid:107) L2 +h (cid:12) (cid:12) I h 2u−u (cid:12) (cid:12) H1 ≤Chm+1|u| Hm+1 .
it is a Z-matrix, i.e. off-diagonal entries are less than or
equal to zero; Remark 5.18 Noticethatifu∈H2(Ω)theinterpolation
the real part of the eigenvalues are positive. result does not provide a better estimate than P1 finite
elements. Theuseofsuchelementshouldbemotivatedby
Besideswerecallthefollowingproperty
theconstructionofanapproximatesolutionforasolution
Proposition 5.14 The following are equivalent: which belongs to H3(Ω).
A is a non-singular M-matrix;
A is inverse-positive. That is, A−1 exists and A−1≥0. Proof of Theorem 5.17. The proof is similar to the
proof of Theorem 5.5. We can also use the technique of
Introducci´on al m´etodo de los elementos finitos 35
φ
i−1
2
φ
i
φ
i+1
2
x x x x x
i−1 i−1 i i+1 i+1
2 2
Figure 4. P2 finite element in 1D: shape functions φ i−1 , φ i and φ i+1 .
2 2
The original function
P2 interpolant on 6 elements
P1 interpolant on 6 elements
P2 interpolant on 3 elements
Figure 5. A smooth function (dashed line) and different kind of interpolations.
36 Introducci´on al m´etodo de los elementos finitos
the change of variables by reducing the study to the in- • for l=k−1=[i−1,1],
terpolationpropertiesoftheoperatorontheunitdomain
[0,1]. (cid:4) a = (cid:90) xi φ(cid:48)φ(cid:48) ,
k,k−1 i i−1
Example of P2 approximation of an elliptic prob- xi−1 2
lem in 1D. Considering the P2 approximation space as
• for l=k−2=[i−1,0],
V andV =V ∩H1(Ω). We obtain the convergence in
h h,0 h 0
t u h ∈ e V g . eneral case because d(u,V h,0 )→0 as h→0 for all a k,k−2 (cid:90) xi φ i (cid:48)φ i (cid:48) −1 .
xi−1
Theorem 5.19 (P2 error estimate) Assume that the
Ifk=[i,1]thesupportofψ isK. Asaconsequence
solution u∈V of the problem belongs to H3(Ω). Then we k i
theonlycoefficientsl forwhicha maybenon-zero
have kl
(cid:107)u−u (cid:107) ≤ Ch2|u| , are:
h H1(Ω) H3(Ω)
(cid:107)u−u (cid:107) ≤ Ch3|u| .
h L2(Ω) H3(Ω) • for l=k=[i,1],
P
fro
r
m
oof
th
o
e
f
a
T
b
h
ov
e
e
or
a
e
n
m
aly
5
si
.
s
19
w
.
he
T
r
h
ea
e
s
fi
t
r
h
s
e
t p
se
r
c
o
o
p
n
e
d
rty
pr
f
o
o
p
ll
e
o
r
w
ty
s
a k,k =
(cid:90) xi+1(cid:12)
(cid:12) (cid:12) φ i (cid:48) +1
(cid:12)
(cid:12) (cid:12)
2
,
follows from the Aubin-Nitsche trick, see the proof of
xi 2
Theorem 5.11. (cid:4)
• for l=k+1=[i+1,0],
We illustrate the differences between various interpo-
lations of a same function in Figure 5. a =
(cid:90) xi+1
φ(cid:48) φ(cid:48) ,
Practical aspects related to the computation of k,k+1 xi i+ 2 1 i+1
the approximate solution. Inpracticethenumbering
of the unknowns is done continuously between 1 and • for l=k−1=[i,0],
2N+1 (we recall that x and x are not taken into
account because of the
0
bounda
N
r
+
y
1
conditions). More a =
(cid:90) xi+1
φ(cid:48) φ(cid:48).
k,k−1 i+1 i
precisely, any k∈{1,...,2N+1} can be written as k= xi 2
2i+p, with p∈{0,...,N} and p∈{0,1}. We will denote
Thus the matrix A is pentadiagonal. The linear sys-
k=[i,p]. The numbering of the basic functions writes:
tem to solve is more complicated than with the P1 ap-
(cid:26) φ, if p=0, proximation. The matrix is symmetric positive-definite
i
ψ =ψ =
k [i,p] φ , if p=1. but it is not an M-matrix and the discrete maximum
i+1
2 principle is not satisfied anymore.
In the same way the numbering of the unknowns U
k
related to the coordinates of the solution u h in the basis 5.3 Pk finite element in dimension d>1
{ψ
k
} follows the same rule.
Meshes. We assume that Ω is a bounded, connected,
Let us consider the matrix A=(a ) with
k,l kl polygonal in 2D or polyhedral in 3D.
(cid:90)
a k,l =a(ψ l ,ψ k )= ψ k (cid:48)ψ l (cid:48). Proposition 5.20 Let T be a polygonal mesh, i.e. a
Ω set of polygonal/polyhedral cells (K) K∈T such that
If k=[i,0] the support of ψ is K ∪K. As a
k i−1 i
consequence the only coefficients l for which a
k,l
Ω¯ =∪ K∈TK¯, K˚∩L˚ =0/, if K(cid:54)=L.
may be non-zero are:
Let m∈N\{0} and u a function defined on Ω. The
• for l=k=[i,0], following properties are equivalent:
a k,k =
(cid:90) xi+1(cid:12)
(cid:12)φ i (cid:48)(cid:12) (cid:12) 2 , u∈Hm(Ω);
xi−1
For all K∈T, u ∈Hm(K) and, for all K(cid:54)=L such
• for l=k+1=[i,1], |K
that the codimension of K¯∩L¯ is 1, then the trace of
a =
(cid:90) xi+1
φ(cid:48)φ(cid:48) ,
∂αu
|K
and the trace of ∂αu
|L
coincide on ∂K∩∂L,
k,k+1 i i+1 for any |α|≤m−1.
xi 2
• for l=k+2=[i+1,0], If the properties hold, then for all |α|≤m,
a k,k+2 =
(cid:90) xi+1
φ i (cid:48)φ i (cid:48) +1 , (cid:107)∂αu(cid:107) L2(Ω) = ∑ (cid:107)∂αu |K (cid:107) L2(K) .
xi K∈T
Introducci´on al m´etodo de los elementos finitos 37
T T
1 1
T
4
T
T 4 T T T
2 5 2 5
T
7
T
T T
7
3 3
T
T T
10
T T 6 T 6
8 10 8
T T
9 9
Figure 6. Admissible mesh and non-admissible mesh.
38 Introducci´on al m´etodo de los elementos finitos
This result explains how it is possible to design fi- This supremum is attained (by a finite dimension argu-
nite element spaces that are Hm−conforming when the ment): thus there exists aˆ,bˆ ∈Kˆ such that (cid:107)aˆ−bˆ(cid:107)=ρ
Kˆ
dimension is greater than 1. We take piecewise regular and
functions with additional constraint: the jumps of u and (cid:107)B (aˆ−bˆ)(cid:107)=(cid:107)T (aˆ)−T (bˆ)(cid:107)≤h ,
K K K K
its derivatives at the interfaces of the mesh have to be
hence the result. The last inequality is obtained by
zero. Then the geometrical conformity of the mesh is
exchanging the roles of K and Kˆ. (cid:4)
essential: indeed in Figure 6 the atypical node in the
non-admissible mesh cannot be associated to a degree
Theorem 5.22 Let v:K→R. Then v∈Hm(K) if, and
of freedom of the approximation space: if we consider
only if, vˆ=v◦T ∈Hm(Kˆ). Moreover for any 0≤k≤m
a P1 approximation, then the value of the approximate K
we have
solution in this particular node is related to the values
1
|K|2
at t W he e v w er il t l ic n e o s w of co t n ri s a id n e g r le a T m 10 e . sh of Ω made of simplices, |v| Hk(K) ≤C ρ K k |vˆ| Hk(Kˆ) ,
i.e. the convex hulls of d+1 points that do not belong
hk
to an hyperplane. Roughly speaking they are triangles |vˆ| ≤C K |v| .
Hk(Kˆ) 1 Hk(K)
in 2D, tetrahedra in 3D etc. |K|2
Simplicial finite element. The Pk simplicial La-
grange element. As it has been previously outlined, Remark 5.23 Let us recall that for k=0, H0=L2 and
the finite element may be defined on a reference ele- |·| =(cid:107)·(cid:107) .
H0 L2
ment. Allthegeometricalquantitiesofthemeshandthe
approximation space are based upon this object. Proof of Theorem 5.22. Let us prove the theorem for
Let us denote Kˆ the unit simplex: m=1 (the general case readily adapts).
(cid:40) (cid:41)
Case k=0. By using the change of variables
Kˆ = x∈Rd, (∀i, x ≥0), ∑x ≤1 .
i i
i (cid:90)
(cid:107)v(cid:107)2 = |v(x)|2dx
L2(K)
Proposition 5.21 (Affine mapping T
K
) Anysimplex (cid:90)K
K=conv(a 0 ,...,a d ) of the mesh is the image of Kˆ by an = |vˆ(xˆ)|2|det(B K )|dxˆ
affine mapping T K :Kˆ →K of the form = |K
Kˆ
|(cid:107)vˆ(cid:107)2 .
L2(Kˆ)
T (xˆ)=a +B xˆ
K 0 K
Case k=1. We have
where the ith column of B is defined as the coordinates
K
of a i −a 0 in the canonical basis of Rd. We have the ∇ˆvˆ=Bt K (∇v)◦T K =Bt K ∇(cid:99)v,
following properties:
hence
|det(B )|=d!|K|,
K
h2 h2
(cid:107)B K (cid:107) 2 ≤
h K
,
(cid:107)∇ˆv(cid:107)2
L2(Kˆ)
≤
ρ
K
2
(cid:107)∇(cid:99)v(cid:107)2
L2(Kˆ)
=
ρ2
K
|K|
(cid:107)∇v(cid:107)2
L2(K)
.
ρ Kˆ Kˆ Kˆ
h
(cid:107)B−1(cid:107) ≤ Kˆ . The other inequality is obtained by exchanging the roles
K 2 ρ K of K and Kˆ. (cid:4)
Here h and h denote the diameters of K and Kˆ respec-
K Kˆ
Proposition 5.24 (Local simplicial Lagrange f.e.)
tively whereas ρ and ρ denote the diameters of the
incircles of K an K d Kˆ resp K e ˆ ctively. We consider Σ⊂Kˆ the set of points defined as
(cid:18) (cid:19)
I I
ProofofProposition5.21. Letusprovetheestimates 1,..., d , ∀(I ,...,I )∈Nd, I +...+I ≤k.
1 d 1 d
on B . Using a change of variables, k k
K
(cid:90) (cid:90)
|K|= 1dx= 1|det(B
K
)|dxˆ=|det(B
K
)| (cid:12) (cid:12)Kˆ(cid:12) (cid:12), Then |Σ|=C
k
k
+d
= (
d
k+
!
d
k
)
!
!.
K Kˆ We denote (aˆ ) the elements of this set. Then
j 1≤j≤|Σ|
where the volume of the reference simplex is given by the mapping p∈Pk(cid:55)→(p(aˆ )) ∈R|Σ| is an isomor-
(cid:12) (cid:12)Kˆ(cid:12)
(cid:12)=1/d!. By definition of (cid:107)·(cid:107) 2 we have phism (in particular Pk and
j
Σ
1
h
≤
a
j
v
≤
e
|Σ
t
|
he same cardinality).
(cid:107)B K ·xˆ(cid:107) the triplet (Kˆ,Pk,Σ) is the so-called Pk simplicial
(cid:107)B (cid:107) = sup .
K 2
(cid:107)xˆ(cid:107)=ρ Kˆ ρ Kˆ Lagrange finite element.
Introducci´on al m´etodo de los elementos finitos 39
theset(aˆ ) isthesetofnodesofthisfiniteelement Definition 5.25 (Simplicial conforming mesh) Let
j j
and the linear form v∈C0(Kˆ)(cid:55)→v(aˆ ) is denoted T be a mesh made of simplicial elements K. We say
j
the degree of freedom associated to aˆ . that T is geometrically conforming if, and only if, for
j
any distinct elements K and L, E =K¯∩L¯ satisifes one
For all 1≤i≤|Σ| there exists a unique function of the following properties:
θ ∈Pk such that
i
either dim(F)≤d−2 (note that F may be empty);
θ(aˆ )=δ , ∀1≤ j≤|Σ|.
i j ij
or F is face for K and a face for L.
These functions are the so-called local shape func-
tions. Proposition 5.26 (Global simplicial Lagrange f.e.)
Let T be a simplicial conforming mesh of Ω.
Example. In 1D, the nodes of the Pk finite elements are
described in Figure 8: The set of discretization nodes is denoted Σ =
h
∪ Σ =∪ T (Σ).
P0 finite element: the node is the center of mass of K K K K
Kˆ (this element will be discussed later). We call Pk approximation space on the mesh T
the space
P1 finite element: the nodes are the vertices of Kˆ.
Figure 7 a) presents the degrees of freedom along
V :={v∈C0(Ω¯), ∀K∈T, v ∈Pk}.
with the local shape functions in this case. h |K
P2 finite element: the nodes are the vertices and For any a∈Σ there exists a unique function inV ,
h h
the center of Kˆ. Figure 7 b) presents the degrees denoted φ , such that
a
of freedom along with the local shape functions in
this case. φ (a)=1, φ (b)=0, ∀b∈Σ \{a}.
a a h
These functions are the so-called global shape func-
(cid:3)
tions of the approximation space. They form a
basis for V .
Example. In 2D, the nodes of the Pk finite elements are h
described in Figure 8: For any a∈Σ the mapping v∈C0(Ω¯)(cid:55)→v(a) is a
h
continuous linear form which is called a degree of
P0 finite element: the node is the center of mass of
freedom associated to node a.
Kˆ (this element will be discussed later).
The spaceV satisfies
P1 finite element: the nodes are the vertices of Kˆ. h
P2 finite element: the nodes are the vertices and V h ={v∈H1(Ω), ∀K∈T, v |K ∈Pk}.
the center of the edges of Kˆ.
Moreover the link between the local and global shape
P3 finite element: the nodes are the vertices, the functions is given by:
center of mass and the points located at 1/3 and
2/3 in each edge of Kˆ. Proposition-Definition 5.27 (Shape functions) Let
a∈ Let a∈Σ and let K∈T such that a∈K.
h
(cid:3) There exists a unique J(a,K)∈{1,...,|Σ|} such that
a=T (aˆ )(wesaythatJ(a,K)isthelocalindex
K J(a,K)
Example. In 3D, the nodes of the Pk finite elements are of node a in the element K).
described in Figure 9:
We have
P1 finite element: the nodes are the vertices of Kˆ.
(φ ) ◦T =θ ,
a |K K J(a,K)
P2 finite element: the nodes are the vertices and
the center of the edges of Kˆ. Remark 5.28 The function θ J(a,K) is the local shape
function associated to the node J(a,K) in Kˆ.
(cid:3) Local interpolation operator. Global interpola-
tion operator.
40 Introducci´on al m´etodo de los elementos finitos
P1 element P2 element
1 1
θ
1
θ
2
θ
1
θ
2
θ
3
aˆ aˆ aˆ aˆ aˆ
1 2 1 2 3
1 1
Figure 7. Local shape functions for the P1 and P2 elements in 1D
aˆ
3
P0 reference element P1 reference element
aˆ
1
aˆ aˆ
1 2
aˆ aˆ
6 10
P2 reference element P3 reference element
aˆ aˆ
8 9
aˆ aˆ
4 5
aˆ aˆ aˆ
5 6 7
aˆ aˆ aˆ
1 2 3
aˆ aˆ aˆ aˆ
1 2 3 4
Figure 8. Nodes of the Pk finite elements in 2D
Introducci´on al m´etodo de los elementos finitos 41
aˆ aˆ
4 P1 reference element 10 P2 reference element
aˆ
aˆ 9
7
aˆ
8
aˆ aˆ
2 aˆ 6
aˆ 4
1
aˆ
1
aˆ
aˆ 5
2
aˆ aˆ
3 3
Figure 9. Nodes of the Pk finite elements in 3D
Definition 5.29 (Local interpolation operator) We TherestrictionofIkvtoafaceF ofthemeshonly
h
define the local interpolation operator depends on the degrees of freedom associated to
the nodes of face F. If the values of these degrees
Ik : C0(Kˆ) → Pk
0 of freedom are zero, then (Ikv) ≡0. Thus the
vˆ (cid:55)→ Ikvˆ h |F
0 proof is concluded by taking F ⊂∂Ω.
with
|Σ|
Ikvˆ(xˆ)=∑vˆ(aˆ)θ(xˆ). (cid:4)
0 i i
i=1 The interpolation operators have a major drawback:
Ikvˆ is the unique polynomial in Pk which coincides with theyapplytocontinuousfunctionsonly. Butfunctionsin
0
vˆ on the nodes of the reference element. H1(Ω) are not necessarily continuous in dimension d≥2.
Nevertheless for d=2 or d=3, H2(Ω) is embedded in
Definition 5.30 (Global interpolation operator) We the space of continuous functions so that these operators
define the global interpolation operator may be used.
Ik : C0(Ω¯) → V Analysis of the interpolation error. Let us start
h h
v (cid:55)→ Ikv with two general tools.
h
with
Lemma 5.32 (Deny-Lions) LetU aboundedLipschitz
I h kv(x)= ∑ v(a)φ a (x). domain of Rd and k∈N. We denote Pk the set of poly-
a∈Σh
nomials of degree k on U. There exists a constant C>0
I h kv is the unique function in V h which coincides with v such that
on the nodes of the discretization.
∀u∈Hk+1(Ω), inf (cid:107)u−π(cid:107) ≤C|u| .
Hk+1(U) Hk+1(U)
The operators are linked by the following formula: π∈Pk
Lemma 5.31 Proof of Lemma 5.32. For any multi-index α ∈Nd
such that |α|≤k, we denote f the linear form defined
α
For any K∈T, on Hk+1(U) as
(cid:90)
(Ikv) ◦T =Ik(v◦T ). f (v)= ∂αv.
h |K K 0 K α
U
If v∈C0(Ω¯), v=0 on ∂Ω, then I1v=0 on ∂Ω. The dimension of the set of such multi-indices is exactly
h
In particular I1 is an interpolation operator that the dimension of Pk.
h
maps H1()∩C0(Ω¯) into V =V ∩H1(Ω).
0 h,0 h 0 We first prove that the linear mapping
Proof of Lemma 5.31.
F :π ∈Pk(cid:55)→(f (π)) ∈Rdim(Pk) (30)
Notice that (Ikv) ◦T and Ik(v◦T ) are two α |α|≤k
h |K K 0 K
elements of Pk which coincide on the nodes of the is bijective. Using the dimension argument, we
reference element. By uniqueness of the Lagrange just have to prove that it is injective. Assume
interpolation polynomial, the property is proved. that a non-zero polynomial π ∈Pk is such that
42 Introducci´on al m´etodo de los elementos finitos
(f (π)) =0. Wecanfindanon-zeromonomial Proof of Lemma 5.33. Forallu∈Hk+1(U)andforall
α |α|≤k
with maximal index in π. But then ∂απ is a non- π ∈Pk, we have
zero constant and (cid:82) ∂απ cannot be zero...
U
(cid:107)Φu(cid:107) =(cid:107)Φ(u−π)(cid:107) ≤(cid:107)Φ(cid:107)(cid:107)u−π(cid:107) .
E E Hk+1(U)
Let us prove that there existsC>0 such that, for
all u∈Hk+1(Ω), Taking the infimum over π and using the Deny-Lions
Lemma (see Lemma 5.32) we get
(cid:32) (cid:33)
(cid:107)u(cid:107) Hk+1(U) ≤C |u| Hk+1(U) + ∑ |f α (u)| . (31) (cid:107)Φu(cid:107) E ≤C|u| Hk+1(U) .
|α|≤k
(cid:4)
Assume that the property is false. Then there
existsasequence{u n }ofelementsinHk+1(U)such Definition 5.34 (Regular mesh)
that
(cid:107)u (cid:107) =1, (32) Let T be a mesh of Ω. We define
n Hk+1(U)
h h
1 K K
|u | + ∑ |f (u )|≤ . (33) σ K = , σT = sup .
n Hk+1(U) α n n ρ K K∈T ρ K
|α|≤k
By Eq. (32) we can extract a sequence (u φ(n) ) n A family of meshes (T h ) h of Ω is regular if there
which weakly converges in Hk+1(U) to a function exists a constant C>0 such that
u. Moreover by compactness, (u ) strongly con-
φ(n) n
verges to u in Hk(U) (see the Rellich-Kondrachov ∀h>0, σT ≤C.
h
theorem). By Eq. (33) all the derivatives of order
Remark 5.35 The regularity property is equivalent to
k+1of(u ) tendto0. Thisprovesthatthepar-
φ(n) n
the following constraints:
tial derivatives of u of order k+1 are zero, so that
u∈Pk. Moreover passing to the limit in f (u ),
α φ(n) The volume of each cell is of order hd:
we get: f (u)=0 for all |α|≤k. From the first K
α
item, we deduce that u=0. ∃C>0, ∀h>0, ∀K∈T , |K|≥Chd.
h K
Since Eq. (32) leads to (cid:107)u (cid:107) →1, by strong
φ(n) Hk(U)
convergencewehave(cid:107)u(cid:107) Hk(U) =1whichcontradicts The diameter of the incircle is uniformly bounded
the property u=0. from below by h :
K
Let u∈Hk+1(U). As the map F defined in (30) is ∃C>0, ∀h>0, ∀K∈T , ρ ≥Ch .
h K K
surjective there exists π˜ ∈Pk such that
We deduce from the last two lemmas the following
∀|α|≤k, f (u−π˜)=0.
α interpolation theorem:
Then we obtain
Theorem 5.36 (Interpolation operator) LetΩbea
inf (cid:107)u−π(cid:107) boundedLipschitzdomainofRd,k∈N. Let0≤m≤kand
π∈Pk
Hk+1(U)
we assume that m+1>d/2 so that Hm+1(Ω)⊂C0(Ω¯).
≤(cid:107)u−π˜(cid:107)
Hk+1(U)
 
Local interpolation estimate. For l≤m+1, there
≤C|u−π˜|
Hk+1(U)
+ ∑ |f
α
(u−π˜)| existsC>0suchthat,forallK∈T,∀v∈Hm+1(K),
|α|≤k(cid:124) (cid:123)(cid:122) (cid:125)
=0 (cid:12) (cid:12)
=C|u−π˜|
Hk+1(U)
=C|u|
Hk+1(U)
. (cid:12)
(cid:12)
v−I
h
kv(cid:12)
(cid:12) Hl(K)
≤Cσ
K
lh
K
m+1−l|v|
Hm+1(K)
. (34)
(cid:4) Global interpolation estimate. For l∈{0,1}, there
exists C>0 such that, for all v∈Hm+1(Ω),
Lemma 5.33 (Bramble-Hilbert) LetU beabounded
(cid:12) (cid:12)
Lipschitz domain of Rd, k∈N and Φ a continuous linear (cid:12)v−Ikv(cid:12) ≤Cσlhm+1−l|v| . (35)
operator from Hk+1(U) onto some normed vector space
(cid:12) h (cid:12)
Hl(Ω)
T Hm+1(Ω)
E. If Φ≡0 on Pk then there exists C>0 such that
Let us recall that for k=0, H0=L2 and |·| =(cid:107)·(cid:107) .
H0 L2
∀u∈Hk+1(U), (cid:107)Φu(cid:107) ≤C|u| . Proof of Theorem 5.36.
E Hk+1(U)
Introducci´on al m´etodo de los elementos finitos 43
The global estimate, see Eq. (35), is deduced from Proof of Theorem 5.37. In the case m+1≥d/2,
local estimates (34) combined with Proposition the theorem is a consequence of the properties of the
5.20,seepage36. Therestrictionl∈{0,1}isessen- Lagrange interpolation operator, see Theorem 5.36 with
tial here because functions inV are not in Hl(Ω) l =1. Note that the norms |·| and (cid:107)·(cid:107) are
h H1(Ω) H1(Ω)
forl≥2. Butthelocalestimateholdsforl≤m+1. equivalent since u−u ∈H1(Ω).
h 0
Letusprovethelocalestimateforl≤m+1. Bythe In the case m+1<d/2 it is necessary to build other
Bramble-Hilbert lemma, as the local interpolation interpolationoperatorswhichovercomethedifficultiesre-
operatorIkistheidentityonPk,thenthemapping lated to the continuity argument. Among operators that
0
havestabilityandinterpolationproperties,letusmention
Φ:vˆ∈Hm+1(Kˆ)(cid:55)→vˆ−Ikvˆ∈Hl(Kˆ)
0 the Cl´ement operator [7] (which fails at preserving the
is zero on Pk. Moreover it is a continuous linear Dirichlet boundary conditions) and the Scott-Zhang in-
operator(becausetheembeddingHm+1(Kˆ)⊂C0(Kˆ) terpolation operator [16] (which preserves homogeneous
is continuous). By the Bramble-Hilbert lemma, boundaryconditions). Theconstructionismoreintricate
there existsC>0 such that and is not given here and we refer the reader to [9] for
an overview on this issue. (cid:4)
∀vˆ∈Hm+1(Kˆ), (cid:107)vˆ−Ikvˆ(cid:107) ≤C|vˆ| .
0 Hl(Kˆ) Hm+1(Kˆ)
5.4 Other classical finite elements
Now we use Theorem 5.22, see page 38. Let v∈
Hm+1(K). We define vˆ=v◦T and we get The Qk Lagrange finite element. Considering a
K
mesh of Ω which is made of quadrilaterals in 2D, par-
1
(cid:12) (cid:12)v−I h kv (cid:12) (cid:12) Hl(K) ≤ C |K ρl |2 (cid:12) (cid:12) (cid:12) v◦T K −I h kv◦T K (cid:12) (cid:12) (cid:12) Hl(Kˆ) a p l o le ss le ib p l i e pe to ds bu in ild 3 ? D. What kind of finite elements is it
K
1 We cannot hope for a degree of freedom on each
|K|2 (cid:12) (cid:12)
≤ C (cid:12)vˆ−Ikv(cid:12) vertex of the mesh with piecewise P1 functions. Thus
ρl (cid:12) 0 (cid:12) Hl(Kˆ)
K it is necessary to enlarge the space of polynomials that
1
≤ C(cid:48)
|K|2
|vˆ| should be considered:
ρl Hm+1(Kˆ)  
K
≤ C(cid:48)(cid:48) h ρ m K K + l 1 |v| Hm+1(K) Qk(Rd) =   u= α∈Nd, ∑ supαi≤k a α x 1 α1...x d αd  
≤ C(cid:48)(cid:48)σ K l hm K +1−l|v| Hm+1(K) . = Pk(R)⊗...⊗Pk(R),
which are the polynomials with all partial degrees less
(cid:4)
than k. Note that, in 1D, Qk=Pk for any k.
The definition of a regular mesh ensures that the
The Q1 element is defined by 4 coefficients in 2D, 8
global interpolation estimate leads to an optimal ap-
coefficients in 3D. This corresponds to the number of
proximation error estimate, see Eq. (35), i.e. as it is
vertices for a quadrilateral in 2D, parallelepiped in 3D.
expected for the approximation space V built upon a
h More precisely,
regular triangulation. Thus we get the following error
estimate. Q1(R2)=span(1,x ,x ,x x ),
1 2 1 2
Theorem 5.37 (Pk error estimate) Leta(·,·)beabi- Q1(R3)=span(1,x 1 ,x 2 ,x 3 ,x 1 x 2 ,x 1 x 3 ,x 2 x 3 ,x 1 x 2 x 3 ).
linearformonH1(Ω)whichiscontinuousandcoercive; L We consider the reference element Kˆ =[0,1]d as the unit
0
acontinuouslinearformonH1(Ω). Let(T ) bearegular cube in Rd.
0 h h
family of simplicial meshes of Ω. Let V be the Pk La-
h
grange approximation space built upon these meshes and Remark 5.38 Notice that the restriction of a function
V =V ∩H1(Ω). We assume that the unique u∈H1(Ω) in Qk to an hyperplane parallel to the axes is a function
sa h t ,0 isfyin h g 0 0 in Pk.
a(u,v)=L(v), ∀v∈H1(Ω)
0 Proposition 5.39 (Qk Lagrange finite element) We
belongs to Hm+1(Ω) for some m≤k. Denote u h the solu- consider Σ⊂Kˆ the set of points defined as
tion of the approximate problem built upon V . There
h,0 (cid:18) (cid:19)
exists C>0 which only depends on Ω, a(·,·), sup h (σT h ) I 1,..., I d , ∀(I 1 ,...,I d )∈Nd, ∀j∈{1,...,d}, I j ≤k.
such that k k
(cid:107)u−u (cid:107) ≤Chm|u| .
h H1 Hm+1(Ω) Then |Σ|=(k+1)d.
If furthermore the adjoint problem admits an elliptic We denote (aˆ ) the elements of this set. Then
j 1≤j≤|Σ|
regularity property, then the mapping p∈Qk(cid:55)→(p(aˆ )) ∈R|Σ| is an isomor-
j 1≤j≤|Σ|
(cid:107)u−u (cid:107) ≤Chm+1|u| . phism(inparticularQk andΣ havethesamecardinality).
h L2 Hm+1(Ω)
44 Introducci´on al m´etodo de los elementos finitos
the triplet (Kˆ,Qk,Σ) is the so-called Qk Lagrange This space is conforming in L2(Ω) (but not in H1(Ω)).
finite element. Inthecaseofregularfunctions,thedegreeoffreedom
inacellisthevalueofthefunctionatthecenterofmassof
theset(aˆ ) isthesetofnodesofthisfiniteelement
j j thecell. ItispossibletodefinetheLagrangeinterpolation
and the linear form v∈C0(Kˆ)(cid:55)→v(aˆ j ) is denoted operator I0 as done previously10 and then get suitable
h
the degree of freedom associated to aˆ .
j estimates. However, for this particular approximation
space, there exists an interpolation operator which is
For all 1≤i≤|Σ| there exists a unique function
θ ∈Qk such that
muchsimplerandwhichappliestoanyfunctioninL2(Ω).
i
Definition 5.41 For any function v∈V, we define a
θ(aˆ )=δ , ∀1≤ j≤|Σ|.
i j ij piecewise constant function J0v whose value on each
h
These functions are the so-called local shape func- cell K is
|K|−1(cid:82)
v:
K
tions.
J0 : V → V
h h (cid:82)
Example. In 2D or 3D, the nodes of the Q1 finite ele- v (cid:55)→ J0v:= ∑ K v 1 .
ments are described in Figure 10. h |K| K
K∈Σ
(cid:3) Proposition 5.42 TheoperatorJ0 istheL2-orthogonal
h
projection on V . Moreover (without regularity assump-
h
The notion of regularity of the mesh is slightly mod- tion on the mesh, provided that the cells are convex), for
ified: in particular for a quadrilateral, the diameter of all 0≤m≤1, there exists C>1 such that
the incircle for a triangle is replaced by
∀v∈Hm(Ω), (cid:107)v−J0v(cid:107) ≤Chm|v| .
h L2(Ω) Hm(Ω)
ρ =min(ρ ,ρ ,ρ ,ρ )
K T1 T2 T3 T4
This finite element is often used in the discretization
where T denote the four triangles obtained from the four of the pressure in the Stokes problem.
i
vertices of the quadrilateral.
Let us consider a mapping T :Kˆ →K such that 6. Finite elements for saddle-point
K
problems
T (aˆ )=a , ∀j∈{1,...|Σ|}.
K j j
Intheprevioussection,finiteelementspaceswerecon-
The mapping T K cannot be affine, except if K is a paral- sideredforcoerciveproblems. Howeverwhenconsidering
lelogram. In the general case, the mapping is quadratic: non-coercive problems such as saddle-point problems, it
T K ∈(Q1)d. In particular the Jacobian matrix is not is necessary to ensure the compatibility of the approx-
constant anymore. imation spaces X and M , in the sense that a uniform
h h
Thus the approximation space is defined as inf-sup inequality has to be satisfied.
As already pointed out, in the finite dimensional
V h ={v∈C0(Ω¯), ∀K∈T, v◦T K ∈Qk}, framework,positivityoftheinf-supconstantisequivalent
to the injectivity of the operator B(cid:48) :M →X(cid:48) (which, in
which is not equivalent to the condition“v ∈Qk, for all h h h
|K thecaseoftheStokesproblem,isnothingbutthediscrete
K”, except if the cells are parallelograms (in which case
pressure gradient), and thus to the well-posedness of the
T is affine). The interpolation operator is defined as
K discrete problem. In that case, we can define
previously. Moreover under regularity assumptions on
the mesh we obtain the following interpolation result: (cid:32) (cid:33)
b(v ,q )
h h
β = inf sup >0.
h
Proposition 5.40 For a family of regular quadrilateral qh∈Mh vh∈Xh (cid:107)v h (cid:107) X (cid:107)q h (cid:107) M
meshes, there exists a constant C>0 such that, for all
0≤m≤k and for all 0≤p≤m,
10Forinstance,in1D,thespaceVh writes
Vh={u∈L2(Ω), u
|Ki
∈P0},
∀v∈Hm+1(Ω), (cid:107)v−I h kv(cid:107) Hp(Ω) ≤C σ hm−p+1|v| Hm+1(Ω) . andthemapping
A conforming L2 element: the discontinuous ele-
Φ:u(cid:55)→(u(x
1 2
),u(x
3 2
),...,u(x
N+1 2
)))
ment P0 =Q0. We note P0 =Q0 the set of constant isanisomorphismfromVhontoRN+1. Inparticulardim(Vh)=N+1.
functions. Then, from a quadrilateral or simplicial mesh, ThentheinterpolationoperatorI h 0 fromV ontoVh isdefinedas
wecaneasilybuildthesetofpiecewiseconstantfunctions: N
∀u∈V, ∀x∈Ω, I
h
0u(x)=∑u(x
i+1
)φ
i+1
(x).
V ={u∈L2(Ω), u ∈P0}. i=0 2 2
h |Ki
Introducci´on al m´etodo de los elementos finitos 45
aˆ
6
aˆ
aˆ aˆ 5
3 4 aˆ
8
aˆ
7
aˆ
2
aˆ
1
aˆ aˆ aˆ
1 2 4
aˆ
3
Figure 10. Nodes of the Q1 finite elements: in 2D and 3D.
Thus we need to be able to prove that B(cid:48) is injective have
h
on the one hand and that β h does not go to 0 as h goes b(v,q ) b(Π v,q )
h h h
to 0 on the other hand. This last property is called the β(cid:107)q h (cid:107) M ≤ sup =sup
(cid:107)v(cid:107) (cid:107)v(cid:107)
v∈X X v∈X X
inf-sup stability of the numerical method.
b(Π v,q )
h h
≤ Csup
(cid:107)Π v(cid:107)
v∈X h X
b(v ,q )
6.1 Fortin’s lemma h h
≤ C sup ,
(cid:107)v (cid:107)
We often consider conforming approximation spaces vh∈Xh h X
for X and M which satisfy the inf-sup condition. In that
which states the uniform inf-sup condition for b on
case the validity of a uniform discrete inf-sup condition X ×M with a constant β.
is given by the following result: h h C
Assume that the uniform inf-sup condition is satis-
Lemma 6.1 (Fortin) Let b:X×M→R be a continu- fied with a constant β ¯. Then there exists a unique
ous bilinear form and X ⊂X, M ⊂M two finite dimen- (u ,q )∈X ×M such that
h h h h h h
sional subspaces. We assume that b satisfies the inf-sup (cid:26)
(u ,v )+b(v ,p ) = 0, ∀v ∈X ,
condition on X×M: h h h h h h
b(u ,q ) = G(q ), ∀q ∈M ,
h h h h h
(cid:18) (cid:19)
b(v,q) and (u ,q ) continuously depends on G with the
∃β >0, inf sup ≥β. h h
q∈M v∈X (cid:107)v(cid:107) X (cid:107)q(cid:107) M estimate (see Theorem 3.13)
2
Then b satisfies a uniform inf-sup condition on X h ×M h (cid:107)u h (cid:107) X ≤ ¯ (cid:107)G(cid:107) M(cid:48) .
β
if, and only if, there exists a continuous linear operator
Π :X →X and a C>0, independent of h, such that Let v∈X. We choose the linear form G as
h h
∀q∈M, G(q)=b(v,q),
∀v∈X, (cid:107)Π v(cid:107) ≤C(cid:107)v(cid:107)
h X X
whose norm is bounded by (cid:107)b(cid:107)(cid:107)v(cid:107) . Then we find
X
and an element u h ∈X h which linearly depends on v,
such that
∀q ∈M , b(v,q )=b(Π v,q ). 2(cid:107)b(cid:107)
h h h h h (cid:107)u (cid:107) ≤ (cid:107)v(cid:107) ,
h X ¯ X
β
In the literature, the operator Π is usually called the
h and
Fortin operator.
b(u ,q )=b(v,q ), ∀q ∈M .
h h h h h
Thus the operator Π :v(cid:55)→u satisfies the desired
Proof of Lemma 6.1. Let us proceed in two steps. h h
properties.
Assume that there exists such a continuous linear
operator Π :X →X . Then, for all q ∈M , we (cid:4)
h h h h
46 Introducci´on al m´etodo de los elementos finitos
6.2 Stokes problem Since v is 0 at the boundary, we have by the Stokes
h
For the sake of simplicity, we consider only here the formula (see Proposition 1.26, page 6),
2D case. We review the most classical conforming finite (cid:90)
element for the Stokes problem. div(v h )q¯=0, ∀q¯∈R.
Ω
WeshallconsidertheunitsquareΩ=]0,1[2 equipped
Thus Eq. (36) also holds for piecewise constant test func-
with either a uniform rectangular mesh or a uniform
tions with non-zero mean values. In practice we thus
triangular (simplicial) mesh obtained by dividing all the
have a condition which writes
rectangles into two isometric parts.
(cid:90)
The geometry of all the finite elements that we pro- div(v )=0, ∀K∈T.
h
pose to analyse here is summarized in Figure 11. K
Sincev ∈(P1)2oneachcellK,v takestheformv (x,y)=
6.2.1 The P1−P0 element (cid:0) aK+b h Kx+cKy,aK+bKx+cKy (cid:1) h on K, hence di h v(v ) =
Consider now the uniform triangle mesh of Ω. We bK 1 +cK 1 is a 1 cons 2 tant. 2 As 2 a consequence v ∈Ker h (B )
consider the following approximation spaces 1 2 h h
if, and only if, div(v )=0 in a distribution sense (this
h
X ={v∈(H1(Ω))2, ∀K∈T, v◦T ∈(P )2}, property does not hold for any discretization of the pres-
h 0 K 1 sure!).
M h ={v∈L 0 2(Ω), ∀K∈T, v◦T K ∈P 0 }. Let us now investigate the consequences on v h . Let
K be a triangle with nodes that are numbered 1, 2 and
Observe that the degrees of freedom for the velocity field
are exactly the same as for the Q1 element. However, 3, and let v∈(P1)2 on K, see Figure 12. By the Stokes
formula, the divergence free condition on K writes
the approximation space X is not the same as before,
h
since the fields in X are linear on each triangle whereas (cid:90)
h ∑ (v·n)=0.
the in the previous section the fields in X were bilinear
h σ σ
on each rectangle.
As v is affine, the integral along the edge is equal to the
We also observe that, for a same number of vertices
value of the function at the middle of the edge (weighted
in the mesh, the number of degrees of freedom for the
bythelengthoftheedge),whichisequaltothehalf-sum
pressure is twice the one of the previous section.
of the degrees of freedom of the corresponding nodes.
Proposition 6.2 (P1−P0 is unstable) TheP1−P0 fi- Denoting m i and n i the measure and the outward normal
unitvectoroftheedgeattheoppositeofnodei, ityields
nite elements are not inf-sup stable for the Stokes prob-
lem. m v 1 +v 2 ·n +m v 1 +v 3 ·n +m v 2 +v 3 ·n =0
3 3 2 2 1 1
2 2 2
Proof of Proposition 6.2. Let us remark that that is to say
there are 2NM elements and thus d(p)=2NM−1; v ·(m n +m n )+v ·(m n +m n )
1 2 2 3 3 2 1 1 3 3
there are (N+1)(M+1) nodes, including (N− +v 3 ·(m 1 n 1 +m 2 n 2 )=0.
1)(M−1)interiornodes,henced(v)=2(N−1)(M−
Applying the Stokes formula to constant vector fields
1).
in the triangle, we find that the following equality is
satisfied
Then
m n +m n +m n =0,
1 1 2 2 3 3
d(p)−d(v) = (2NM−1)−(2(N−1)(M−1))
whichleadsusbacktothefreedivergenceequationwhich
= 2(N+M)−3
becomes
> 0
m v ·n +m v ·n +m v ·n =0.
1 1 1 2 2 2 3 3 3
As d(p)>d(v) the kernel of B(cid:48) is not reduced to 0. In
h It means in particular that if v =v =0 then v and
fact, it means that the kernel of B(cid:48) is very large! This 1 2 3
h n are orthogonal. Thus if K is a triangle with an edge
choice of approximation spaces is thus far from being 3
at the boundary, then only one degree of freedom is
inf-sup stable.
at the interior of the domain: the orientation of the
We may prove that the kernel of B (which contains velocity field at this node is parallel to the boundary; if
h
the functions with discrete free divergence) is {0}, i.e. thesamedegreeoffreedomistheinteriornodeofanother
the only velocity field v ∈X which is likely to be a trianglewithanedgeattheboundary,weobtainanother
h h
solution of the system is the null function. orthogonality condition which proves that the velocity is
zero.
By definition, v ∈Ker(B ) if
h h
Thisreasoningappliestostructuredtriangularmeshes
(cid:90) and proves the so-called locking effect. (cid:4)
div(v )q =0, ∀q ∈M . (36)
h h h h
Ω
Introducci´on al m´etodo de los elementos finitos 47
Q1−P0 P1−P0
P1−P1 P1−P1
b
P2−P1
Figure 11. Comparison of various elements for the Stokes problem on a square domain. Degrees of freedom for
velocity ( ) and pressure ()
48 Introducci´on al m´etodo de los elementos finitos
v 3 Thenbytheranktheorem,thedimensionofthekernel
of B(cid:48) is at least
h
n
2 n
1
d(p)−d(v) = (NM−1)−(2(N−1)(M−1))
m m
2 1 = −NM+2(N+M)
m
3 v
2
v whichisnegative(exceptforcoarsemeshes). Thusd(p)<
1
n 3 d(v) and considerations on the size of the approximation
Figure 12. Notations in a triangle element. Three spaces are not sufficient to conclude: the kernel of B(cid:48)
h
degrees of freedom for the velocity field. has to be investigated in details in order to show that the
inf-sup condition is not satisfied.
6.2.2 The Q1−P0 element Proof of Proposition 6.3. Werecallthattheoperator
Here we consider the uniform cartesian mesh. The B(cid:48) is defined by
h
cells are thus denoted by K with i∈{1,...,N} and j∈
ij
{1,...,M}. B(cid:48) : M → X(cid:48)
h h h
To simplify some computations, we assume that N p (cid:55)→ B(cid:48)p =b(·,p )
h h h h
and M are even and we set N=2n, M=2m. The mesh
size in the x direction is denoted by h=1/N and the one i.e.11
in the y direction is denoted by k=1/M. We introduce
(cid:90)
the functional spaces ∀v ∈X , (cid:10) B(cid:48)p ,v (cid:11) = div(v )p
h h h h h X
h
(cid:48),Xh
Ω
h h
X ={v∈(H1(Ω))2, ∀K∈T, v◦T ∈(Q1)2},
h 0 K and we aim at proving that B(cid:48) is not injective. More
h
precisely, we shall prove that
M ={v∈L2(Ω), ∀K∈T, v ∈P0},
h 0 |K
The set of degrees of freedom for such discretization dim(Ker(B(cid:48) h ))=1.
spaces is represented in Figure 11.
This element is the most simple that one can think The velocity field v is described by its two components
of on a Cartesian grid. However, we will show that the v:=(v(1),v(2)). We denote p ij the discrete pressure in
(j)
discrete inf-sup condition is not satisfied by this finite eachelementandv , for j∈{1,2}, thecomponents
i−1 j−1
element. 2 2
of the discrete velocity at node (i−1,j−1). We can
2 2
Proposition 6.3 (Q1−P0 is unstable) TheQ1−P0 fi- compute
nite elements are not inf-sup stable for the Stokes prob-
(cid:90) N M (cid:18)(cid:90) (cid:19)
lem. div(v )p =∑∑ p div(v ) .
h h ij h
Ω i=1j=1 Kij
Remark 6.4 As it was already pointed out, we consider
the restriction B(cid:48) of operator B:M→X(cid:48) as an operator Each cell has four vertices that we locally number coun-
h
from M onto X(cid:48). Then the inf-sup condition states terclockwise starting from the lower left corner (from 1
h h
that this operator should be injective. In particular, the to 4). The edges are also numbered:
dimension of M should be lower than the dimension of
h
(1)
X . Thus, the inf-sup condition is not satisfied if M is ∂K denotes the edge 1→2,
h h ij
too big with respect to X .
h
Let us denote d(p) (resp. d(v)) the number of degrees ∂K (2) denotes the edge 2→3,
ij
of freedom for the pressure (resp. for the velocity). Let
us remark that (3)
∂K denotes the edge 3→4,
ij
there are NM elements and thus d(p)=NM−1 (as
(4)
the mean value of the pressure is zero); ∂K denotes the edge 4→1.
ij
there are (N+1)(M+1) nodes, including (N− 11Bydefinition,wehave,forallvh∈Xh,
1)(M−1) interior nodes (that are the only ones to
be considered as velocity degrees of freedom because (cid:10) B(cid:48) h ph,vh (cid:11) X h (cid:48),Xh = (cid:104)B(cid:48)ph,vh (cid:105) X(cid:48),X
of the homogeneous Dirichlet conditions). Hence, = (cid:104)Bvh,ph (cid:105) M(cid:48),M
= b(vh,ph)
since the velocity is a two-dimensional vector field, = (cid:82)
Ω
div(vh)ph.
we have d(v)=2(N−1)(M−1) in 2D.
Introducci´on al m´etodo de los elementos finitos 49
We have Thus, b(v ,p )=0 for all v ∈X if, and only if, δ p=
h h h h x
δ p=0, i.e.
y
(cid:90) (cid:90) 4 (cid:90)
div(v )= v ·n= ∑ v ·n.
h h h
Kij ∂Kij (cid:96)=1 ∂K i ( j (cid:96)) p ij = p i−1j−1 , ∀i,j
p = p , ∀i,j.
i−1j ij−1
Let us compute the first term:
As p ∈M , the mean value of p is zero, hence
 (cid:16) (cid:17)  h h h
(cid:90) ∂K i ( j 1) v h ·n = = − (cid:90) x i (cid:90) x − i+ 2 1 x 2 1 i+  2 1 v ( v v 2 ( ( h h ) 2 1 ( ) ) x (cid:16) , x x y , , y y j j − − ) 2 2 1 1 d (cid:17) x. · (cid:18) − 0 1 (cid:19) dx We thus obtain a sp p u i r j i = ou − s p m i− o 1 d j e ,∀ w i, h j i . ch is highly oscillat-
h j−1
x i−1
2
2 ing. This so-called checkerboard mode exactly generates
the kernel of B(cid:48) =span(ψ ) with
h h
(1)
The function v (·,y ) is linear on ∂K (see Remark
h j−1 ij
5.38) so that the (exac 2 t) trapezoidal rule yields ψ h =∑∑1 Kik (−1)i+j.
i j
(cid:90) h (cid:18) (cid:19)
v ·n=− v (2) +v (2) . (cid:4)
∂K i ( j 1) h 2 i− 2 1 j−1 2 i+ 2 1 j− 2 1
One may hope to recover the stability by replacing
In the same way the other terms can be computed as M by the space M˜ obtained from M by “removing”
h h h
well:
span(ψ ), but we will see that it is not the case. More
h
(cid:90) k (cid:18) (cid:19) precisely, if we define M˜ h as the orthogonal complement
∂K i ( j 2) v h ·n=+ 2 v ( i+ 1) 2 1 j−1 2 +v ( i+ 1) 2 1 j+ 2 1 , o sa f t s is p f a y n( t ψ he h ) d i i n scr M e h te , t in h f e - n su w p e co c n an dit p io ro n v b e u t t ha u t nf X o h rt a u n n d ate M˜ ly h
not in a uniform way with respect to h.
(cid:90) h (cid:18) (cid:19)
(2) (2)
v ·n=+ v +v ,
∂K i ( j 3) h 2 i− 2 1 j+1 2 i+ 2 1 j+ 2 1 Proposition 6.5 Define
(cid:90) k (cid:18) (cid:19)
∂K i ( j 4) v h ·n=− 2 v ( i− 1) 2 1 j−1 2 +v ( i− 1) 2 1 j+ 2 1 , M˜ h :=ψ h ⊥={p h ∈M h , (p h ,ψ h ) L2 =0},
where ψ denotes the spurious mode of the Q1−P0 finite
We finally obtain: h
element. For all h>0, we have
(cid:90)
div(v )
h b(v ,p )
Kij
hk   v i ( − 2) 1 j+1 −v ( i− 2) 1 j−1 v ( i+ 2) 1 j+1 −v ( i+ 2) 1 j−1
β
h
:=
ph
i
∈
n
M
f
˜ hv
s
h
u
∈X
p
h (cid:107)v h (cid:107) H
h
1 (cid:107)p
h
h (cid:107) L2
>0.
= 2 2 2 2 + 2 2 2 2
2  k k Moreover there exists C 1 >0 and C 2 >0 such that
(1) (1) (1) (1) 
v −v v −v
i+1 j+1 i−1 j+1 i+1 j−1 i−1 j−1 C h≤β ≤C h.
+ 2 2 2 2 + 2 2 2 2 1 h 2
h h

Proof of Proposition 6.5. Thepositivityofβ follows
h
As v h =0 on the boundary, by a discrete integration by from the construction of M˜ h : the operator
parts, we have
B(cid:48) : M˜ → X(cid:48)
h h h
b(v ,p ) = −∑hkv (δ p) p (cid:55)→ B(cid:48)p =b(·,p )
h h i−1 j+1 y i−1 j−1 h h h h
i,j 2 2 2 2
−∑hku i−1 j−1 (δ x p) i−1 j−1 is injective by means of construction which, in the finite
i,j 2 2 2 2 dimensional framework, guarantees that β >0.
h
with
Let us prove the most interesting inequality. For
(cid:18) (cid:19) this we construct a function q which satisfies suitable
1 p −p p −p h
ij i−1j ij−1 i−1j−1
(δ x p) i−1 2 j−1 2 = 2 h + h , properties:
1
(cid:18)
p ij −p ij−1 p i−1j −p i−1j−1
(cid:19)
q =∑
2n
∑
2m
1 (−1)i+j
(cid:18)
E
(cid:18) i−1 (cid:19)
−
n−1 (cid:19)
,
(δ
y
p)
i−1 2 j−1 2
=
2 k
+
k
. h
i=1j=1
Kij
2 2
50 Introducci´on al m´etodo de los elementos finitos
where E denotes the floor function. By means of con- which readily adapts on an interval of width h as
struction the mean value of q is zero. Moreover,
h
6(cid:90) h(cid:12) x (cid:16) x (cid:17)(cid:12)2
(cid:90) q h ψ h = hk∑ (cid:18) E (cid:18) i−1 (cid:19) − n−1 (cid:19) a2+b2≤ h 0 (cid:12) (cid:12) a h +b 1− h ) (cid:12) (cid:12) dx.
2 2
Ω ij
2n (cid:18) (cid:18) i−1 (cid:19) n−1 (cid:19) Thus we get
= hkM∑ E −
i= n 1 −1(cid:18) 2 n−1 (cid:19) 2 n ∑ −1 (cid:12) (cid:12)∂ y v h ((2p+1)h,y) (cid:12) (cid:12) 2 ≤ 6 h (cid:90) 1(cid:12) (cid:12)∂ y v h (x,y) (cid:12) (cid:12) 2 dx
= 2hkM ∑ p− p=0 0
2
p=0
= 0. and finally integrating with respect to y,
As a consequence, q ∈M˜ . √ (cid:16) (cid:17)1
h h |b(v ,q )| ≤ 2h n 1(cid:82)1(cid:82)1|∂ v |2dxdy 2
h h √ √ h 0 0 y h
Computation of (cid:107)q h (cid:107) L2(Ω) . ≤ 2 h n(cid:107)∇v h (cid:107) L2 .
(cid:107)q
h
(cid:107)2
L2(Ω)
= hk∑
i,j
(cid:0)E(cid:0)i−
2
1(cid:1) −n−
2
1(cid:1)2 Thus we obtain, for any v
h
∈X
h
,
= 2hkM∑ n
p
−
=
1
0
(cid:0) p−n−
2
1(cid:1)2
|b(v h ,q h )|
∼ Chn3 ≤C.
(cid:107)v (cid:107)
∼ Ch−2. h H1
The inf-sup condition implies
Thus (cid:107)q (cid:107) is of order h−1 as h→0.
h L2(Ω)
|b(v ,q )|
h h
Computation of b(v h ,q h ). Let us consider an ar- β h (cid:107)q h (cid:107) L2 ≤ sup (cid:107)v (cid:107) ≤C.
bitrary v ∈X . Using the previous notations we vh∈Xh h H1
h h
compute δ q and δ q . On the one hand, δ q =0.
x h y h x h As (cid:107)q (cid:107) is of order h−1, we have β ≤Ch.
On the other hand, h L2(Ω) h
(cid:40)
0, if i=2p,
(δ
y
q
h
)
i−1 2 j− 2 1
=
2 (−1 k )j+1 , if i=2p+1. Previous examples shed a light on possible fails whe
(cid:4)
n
considering finite element approximations for the Stokes
Then we get
problem. Let us give an outline of classical stable finite
n−1 2m elements.
b(v ,q ) = 2∑ ∑h(−1)j+1v
h h 2p+1 j−1
p=0j=1 2 2 6.2.3 The P1−P1 element
n−1 m (cid:16) (cid:17) As we h b ave seen before, the main reason for the
= 2∑ ∑h v −v .
p=0r=1 2p+ 2 12r−3 2 2p+1 2 2r−1 2 instabilityoftheQ1−Q0 orP1−P0 approximationisthe
fact that the pressure approximation space is too large
Hence, by the Cauchy-Schwarz inequality, we get
in some sense compared to the velocity approximation
space.
|b(v ,q )|
h h
That is the reason why the construction of uniformly
n−1(cid:90) 1(cid:12) (cid:12)
≤2h∑ (cid:12)∂
y
v
h
((2p+1)h,y)(cid:12)dy stable approximation spaces for the Stokes problem are
p=0 0 often built starting from an unstable discretisation by
 (cid:32) (cid:33)2  2 1 using one the two following strategies:
(cid:90) 1 n−1 (cid:12) (cid:12)
≤2h ∑(cid:12)∂
y
v
h
((2p+1)h,y)(cid:12) dy
Either one can add functions (that is degrees of
0 p=0
freedom)inthevelocityapproximationspace. This
(cid:32) (cid:33)1
≤2h √ n (cid:90) 1n ∑ −1 (cid:12) (cid:12)∂ y v h ((2p+1)h,y) (cid:12) (cid:12) 2 dy 2 induces a higher computational cost.
0 p=0 Or one can remove functions (that is degrees of
As v ∈Q1, x(cid:55)→∂ v (x,y) is piecewise affine and freedom)inthepressureapproximationspace. This
h y h
induces a lower accuracy of the approximation.
moreover it is continuous for a.e. y∈Ω (precisely
for all the y’s that do not belong to the boundary
The choice of a suitable pair of approximation spaces is
of the cells). We can then use the following basic
thus a sort of tradeof between stability/accuracy/com-
inequality
putational effort.
(cid:90) 1 A very popular element that is based on the first
a2+b2≤6 |ax+b(1−x)|2dx,
strategy is the so-called mini-element, also denoted by
0
Introducci´on al m´etodo de los elementos finitos 51
P1− bubble / P1 or P1−P1, see [1]. It consists in adding Proof of Proposition 6.7. Let q ∈M \{0}. We aim
b h h
to the P1−P1 element one degree of freedom for each atprovingthatthereexistsC>0(whichdoesnotdepend
component of the velocity on the barycenters of the cells. on h) and some v ∈X (which may depend on q ) such
h h h
Let bˆ ∈H1(Kˆ) denote a function which takes the value 1 that
at the barycenter of the reference cell Kˆ, vanishes on its b(v h ,q h )
≥C(cid:107)q (cid:107) .
boundary ∂Kˆ and satisfies 0≤bˆ ≤1. Such a function is (cid:107)v h (cid:107) H1(Ω) h L2(Ω)
known as a bubble function. Define the space
Step 1. Definition of v . Foreachedgeσ ofthemesh,
h
wedenoteτ aunitvectorofthisedgeand|σ|itslength.
P1={v∈(C0(Ω¯))2, v◦T ∈(P1⊕span{bˆ})2, ∀K∈T}. σ
b K The element v ∈X is uniquely determined by defining
h h
Taking X =P1 and M =P1, the inf-sup constant does its values at the nodes as follows:
h b h
not depend on h which ensures an optimal convergence v (a)=0 if a is a vertex of the mesh;
h
rate:
v (a)=−|σ|2τ (∇q ·τ ) if a is the middle of an
h σ h σ
Theorem 6.6 (P1−P1 estimates) Let (T ) be a reg- interior edge σ;
b h h
ular family of meshes which satisfy the geometrical as-
sumption: each element K ∈T has at most one edge v h (a)=0 if a is the middle of a boundary edge.
h
on the boundary of Ω. Let X h ×M h be the approxima- Let us note that
tion spaces related to the P1−P1 approximation. Assume
b v is zero on the boundary;
that the solution (u,p) of the Stokes problem belongs to h
(H2(Ω))2×H1(Ω). Then we have the following estimate:
thedefinitionofv (a)isconsistentifaisthemiddle
h
(cid:16) (cid:17) of an interior edge. Indeed the gradient of q h is a
(cid:107)u−u h (cid:107) H1(Ω) +(cid:107)p−p h (cid:107) L2(Ω) ≤Ch (cid:107)u(cid:107) H2(Ω) +(cid:107)p(cid:107) H1(Ω) . priori constant on each element and thus it has no
trace defined on the edges. But since q is continu-
h
If furthermore the adjoint problem (which is still the ous through the edge, the tangential gradient of q
h
Stokes problem) has the elliptic regularity property in Ω is uniqueley defined on the edge.
then
We now use the following quadrature formula, which
(cid:107)u−u (cid:107) ≤Ch2 (cid:16) (cid:107)u(cid:107) +(cid:107)p(cid:107) (cid:17) . is valid for the elements in P2: for all π ∈P2, for all
h L2(Ω) H2(Ω) H1(Ω)
K∈T,
The P1−bubble / P1 were defined by Arnold, Brezzi 1 (cid:90) π(a) π(a)
π(x)dx= ∑ − ∑ ,
and Fortin (1984), see [1], and its analysis relies on the
Clement interpolation operator which satisfies Fortin’s
|K| K a∈M(K) 5 a∈S(K) 20
lemma, hence the finite element satisfies a uniform inf- whereM(K)denotesthesetoftheallthemiddlesofthe
sup condition. The mini-element is the simplest stable edges of K and S(K) denotes the set of the vertices of K
element for the Stokes system. (this formula can be proved on the reference element and
thenextendedtoanyelementwithachangeofvariables).
6.2.4 The P2−P1 (Taylor-Hood) element We thus obtain
We consider a simplicial mesh and the P2−P1 ele- (cid:90)
ments: b(v h ,q h ) = − v h ∇q h
Ω
(cid:18)(cid:90) (cid:19)
X h ={v∈(C0(Ω¯))2, ∀K∈T, v◦T K ∈(P 2 )2}∩(H 0 1(Ω))2, = −∑ v h ∇q h
K K
M ={v∈C0(Ω¯), ∀K∈T, v◦T ∈P }∩L2(Ω). (cid:32) (cid:33)
h K 1 0 1
= ∑|K| ∑ |σ|2(∇q ·τ )2 (.37)
We can prove for a quite general simplicial mesh of 5 h σ
K σ∈∂K\∂Ω
that the inf-sup constant β does not depend on h which
h
ensures an optimal convergence rate. Step 2. Estimate of |∇q |. Let K be a triangle. We
h
consider an affine function on K and denote u the value
i
Proposition 6.7 (P2−P1 finite elements) Letusas- of the function at the vertices M of K. We aim at
i
sume that each element K∈T has at most one edge on controlling the gradient of u with respect to the terms
the boundary of Ω. The spaces X h and M h satisfy a uni- u i −u j . Forthiswecanseethatthenormofvectorρ K| ∇ ∇ u u|
form inf-sup condition: the constant β only depends on
h is ρ (see the definition of ρ in Proposition 5.21). Thus
K K
the regularity of the mesh.
there exists X,Y ∈K such that
The geometrical assumption on the mesh is not re- ∇u
X−Y =ρ .
strictive. K |∇u|
52 Introducci´on al m´etodo de los elementos finitos
We denote {x
i
}
i=1,2,3
and {y
i
}
i=1,2,3
the (nonnegative!) ByStep2,eachterm∑
σ∈∂K\∂Ω
|σ|2(∇q
h
·τ
σ
)2 canbe
barycentric coordinates12 of X andY in the triangle and bounded from below by Cρ2|∇q |2 so that we get the
K h
we observe that, since u is affine, we have on the one estimate:
hand
b(v ,q ) ≥ C∑|K|ρ2|∇q |2
u(X)−u(Y)=∇u·(X−Y)=ρ |∇u| h h K h
K
K
and, on the other hand, ≥ C∑ρ2|q |2
K h H1(K)
K
u(X)−u(Y)=∑x i y j (u(M i )−u(M j ))=∑x i y j (u i −u j ). ≥ C∑h2 K |q h |2 H1(K) , (38)
i,j i,j K
as the mesh is regular.
By the Jensen inequality,
Step 4. Estimate of (cid:107)v (cid:107) . We choose K∈T and φ
ρ K 2|∇u|2 ≤ ∑ i,j x i y j (cid:12) (cid:12)u i −u j (cid:12) (cid:12) 2 a shape function such tha
h
t
H1 i
≤ |u −u |2+|u −u |2+|u −u |2.
1 2 2 3 3 1 supp(φ)∩K(cid:54)=0/.
i
Besides, since we have By Theorem 5.22, page 38,
|u 1 −u 2 |2 ≤ (|u 1 −u 3 |+|u 3 −u 2 |)2 |K| 1 2
|φ| ≤C (39)
≤ 2|u 3 −u 1 |2+2|u 2 −u 3 |2, i H1(K) ρ K
Using the definition of v , we have
the estimate still holds with two terms, up to a constant: h
(cid:16) (cid:17)
v =− ∑ |σ|2τ (∇q ·τ )) φ ,
ρ2|∇u|2≤3|u −u |2+3|u −u |2. h σ h σ I(a)
K 1 2 1 3 a∈M(K), a∈σ
Step 3. Bound from below for b(v ,q ). Let us go where I(a) denotes the global numbering of the shape
h h
backtotheestimateofb(v ,q ), seeEq.(37). Inthelast function associated to a. Combined with Eq. (39) we
h h
term, obtain
|σ|2(∇q h ·τ σ )2=|q h (a σ )−q h (b σ )|2 |v |2 ≤ ∑ C |K| |σ|4|∇q |2
h H1(K) ρ2 h
where a σ ,b σ denote the nodes associated to σ. Thus a∈M(K), a∈σ K
each term |σ|2(∇q h ·τ σ )2 can be expressed as some ≤ C|K| ρ h2 K 2 h2 K |∇q h |2.
K
|q (a )−q (b )|2. Thus with the regularity property of the mesh,
h σ h σ
|v |2 ≤Ch2 |q |2
Consequently, a
K
,b
K
,c
K
denoting the vertices of K and h H1(K) K h H1(K)
assuming that the triangles could have at most one edge and then
in ∂Ω, |v |2 ≤C∑h2 |q |2 . (40)
h H1(Ω) K h H1(K)
(∗):= ∑ |σ|2(∇q h ·τ σ )2 K
σ∈∂K\∂Ω Conclusion. Combining Eqs. (38) and (40), we have
can be calculated: (cid:32) (cid:33)1
b(v ,q ) 2
h h ≥C ∑h2 |q |2 .
if K∩∂Ω=0/ (cid:107)v (cid:107) K h H1(K)
h H1(Ω) K
(∗)=|q h (a K )−q h (b K )|2+|q h (b K )−q h (c K )|2 Now since q h ∈M h ⊂H1(Ω), its mean value is zero, so
+|q (c )−q (a )|2 that q ∈H˜1(Ω) and we have
h K h K h
(cid:32) (cid:33)1
2
if [b K ,c K ]⊂∂Ω, ∑h2 |q |2 =|q | =(cid:107)∇q (cid:107) ≥C(cid:107)q (cid:107)
K h H1(K) h H1(Ω) h L2(Ω) h L2(Ω)
K
(∗)=|q (a )−q (b )|2+|q (a )−q (c )|2.
h K h K h K h K
by the Poincar´e-Wirthinger inequality (see Theorem
12i.e. (x 1,x 2,x 3)istheuniquetripletsatisfying 1.20). We finally obtain
xi≥0,foralli=1,2,3,
b(v ,q )
h h
≥C(cid:107)q (cid:107) .
x 1+x 2+x 3=1, (cid:107)v (cid:107) h L2(Ω)
h H1(Ω)
X=x 1 M 1+x 2 M 2+x 3 M 3. Thus the uniform inf-sup condition is proved. (cid:4)
Introducci´on al m´etodo de los elementos finitos 53
Theorem 6.8 (P2−P1 estimates) Let (T ) a regu- partialdifferentialequationsin2Dor3Dwiththefiniteel-
h h
lar family of meshes which satisfy the geometrical as- ementmethod. Itsprincipleisbaseduponthediscretiza-
sumption: each element K ∈T has at most one edge tion of a variational formulation and the computation of
h
on the boundary of Ω. Let X ×M the approximation the solution of the resulting linear system. Multi-physics
h h
spaces related to the P2−P1 approximation. Assume nonlinear problems can be addressed through iterative
that the solution (u,p) of the Stokes problem belongs to schemes that rely on a linear problem to solve at the
(H3(Ω))2×H2(Ω). Then we have the following estimate: basic level.
The requirements for the user are the following ones:
(cid:16) (cid:17)
(cid:107)u−u (cid:107) +(cid:107)p−p (cid:107) ≤Ch2 (cid:107)u(cid:107) +(cid:107)p(cid:107) .
h H1(Ω) h L2(Ω) H3(Ω) H2(Ω) 1. define a domain: boundaries can be defined with a
simple parametrization;
If furthermore the adjoint problem (which is still the
Stokes problem) has the elliptic regularity property in Ω 2. defineamesh: thenumberofnodesoneachlabelled
then boundary issufficient, as the softwareowns a mesh
generator that is able to produce triangulations;
(cid:16) (cid:17)
(cid:107)u−u (cid:107) ≤Ch3 (cid:107)u(cid:107) +(cid:107)p(cid:107) .
h L2(Ω) H3(Ω) H2(Ω) 3. define approximation spaces (P0, P1, P1, P2...);
b
Proof of Theorem 6.8. The interpolation results for
Remark 7.1 At this point, FreeFem++ defines a
X and M are known: we apply Theorem 5.36, page 42,
h h finite element basis which“lives”on the mesh of
withk=2andm=2andl=1forthevelocity,k=1and
the domain.
m=1 and l=0 for the pressure):
(cid:12) (cid:12) 4. define a variational formulation: this is the most
∀v∈H3(Ω), (cid:12)v−Ikv(cid:12) ≤Ch2|v| ,
(cid:12) h (cid:12) H1(Ω) H3(Ω) specific part of the software, as a suitable syntax
is required (note that it is very close to the mathe-
∀p∈H2(Ω), (cid:107)p−Ikp(cid:107) ≤Ch2|p| . matical formulation).
h L2(Ω) H2(Ω)
From Lemma 4.7 combined with Lemma 6.7 (uniform
Remark 7.2 At this point, FreeFem++ owns all
inf-sup condition), we deduce the convergence of the
the tools leading to the corresponding discretized
method.
problem: thesoftwarefunctionalityconsistsinbuild-
From Lemma 4.10 (abstract error estimate) we get ing the matrix and the right-hand side vector asso-
ciated to 1) the bilinear / linear form, 2) the finite
(cid:18) (cid:19)(cid:18) (cid:19)
(cid:107)a(cid:107) (cid:107)b(cid:107) element space.
(cid:107)u−u (cid:107) ≤ 1+ 1+ d(u,X )
h X h
α β
h
(cid:107)b(cid:107) 5. choose a linear solver (optional): FreeFem++ owns
+ d(p,M ),
h
α different solvers, such as LU, Cholesky, Crout, CG,
GMRES, UMFPack, sparsesolver. Sparse systems
(cid:18) (cid:19)(cid:18) (cid:19)
(cid:107)a(cid:107) (cid:107)a(cid:107) (cid:107)b(cid:107)
(cid:107)p−p (cid:107) ≤ 1+ 1+ d(u,X ) canbesolvedwithsparsesolver,UMFPACK,GMRES,
h M h
β h α β h whereas full systems can be solved with LU, Crout,
(cid:18) (cid:19)
(cid:107)b(cid:107) (cid:107)a(cid:107)(cid:107)b(cid:107)
+ 1+ + d(p,M ). Cholesky. The default choice is sparsesolver
h
β h β h α (equivalenttoUMFPACKifnosparsesolverisdefined)
Fromtheseestimatescombinedwiththeaboveglobal or LU if no sparse solver is available.
interpolation estimates, we deduce the error estimate.
LUisadirectmethodcorrespondingtotheLU
The estimate in L2−norm readily adapts from the decomposition method.
Aubin-Nitsche trick. (cid:4) Crout is a direct method for symmetric sys-
tems,basedupontheLUdecompositionmethod,
7. Problems thus using specific properties due to the sym-
metric property of the matrix.
We now investigate the main results of the previ-
ous sections by means of numerical simulations. For Cholesky is a direct method for symmetric
this purpose we use a finite element solver, FreeFem++, positive-definite systems, based upon the LU
which is developed and maintained in Universit´e Pierre decomposition method, thus using specific
& Marie Curie and Laboratoire Jacques-Louis Lions [12]. properties the matrix leading to a simple de-
Before focusing on mathematical problems, let us briefly composition.
introduce FreeFem++. CG (conjugate gradient method) is an iter-
FreeFem++ is a free software designed to compute ative method for symmetric positive-definite
the solution of initial- and boundary-value problems for systems.
54 Introducci´on al m´etodo de los elementos finitos
GMRES is an iterative method for sparse sys- • Numerical results provide the estimate (cid:107)u−
tems (no additional assumption on the struc- u (cid:107) =O(h3): as (P) satisfies the elliptic reg-
h L2
tural properties of the matrix is required). It ularity property, the Aubin-Nitsche lemma
is a generalization of the conjugate gradient applies, see Lemma 5.11 and Theorem 5.19.
method.
UMFPACKisadirectmethodforsparsesystems
(no additional assumption). (cid:3)
Details (including download, documentation, exam-
ples etc.) can be found on http://www.freefem.org/.
7.2 Numerical treatment of the boundary conditions
7.1 Analysis of the convergence
Problem. Let f ≡1, α >0 and ε >0. Let us consider
Problem. WriteaFreeFem++programtosolveaPoisson
the Laplace-Robin problem:
problemwithP1 orP2 finiteelements. Quantifytheerror
in H1 and L2 norms with respect to the mesh size. (cid:3)
(cid:40) −∆u+αu = f in Ω=]0,1[2,
(P ) 1
Solution. Define u:=xy(1−x)(1−y) and f :=2y(1− ε ∇u·n+ u = 0 on ∂Ω.
ε
y)+2x(1−x). It can be checked that the function u
is the unique variational solution in H1(Ω) of −∆u=
0 1. Write the variational formulation of the problem.
f in Ω=]0,1[2. For a fixed mesh, we may compute
Write a FreeFem++ program to solve the problem
corresponding finite element solution u and we aim at
h with P1 or P2 finite elements.
estimating (cid:107)u−u (cid:107) and (cid:107)u−u (cid:107) (note that, for any
h H1 h L2
h, the error (cid:107)u−u (cid:107) should be computed on a fixed very
h
fine mesh, not on the coarse one). Assume that the error 2. Discuss the behaviour of the solution of the Robin
behaves as problem as ε goes to 0.
(cid:107)u−u (cid:107)=O(hα),
h
3. Discuss the behaviour of the solution of the Robin
where α is the order of the method in a chosen norm.
problem as ε goes to ∞.
Then we have
log((cid:107)u−u (cid:107))=αlog(h)+log(C).
h
(cid:3)
As a consequence, α is numerically determined by iden-
tifying the derivative of the linear function
Solution. Let us introduce the Laplace-Dirichlet and
log(h)(cid:55)→log((cid:107)u−u (cid:107))=αlog(h)+log(C). Laplace-Neumann problems:
h
Using different values of {h i } i with corresponding values (cid:26) −∆u+αu = f in Ω=]0,1[2,
of {(cid:107)u−u hi (cid:107)} i (to be determined by solving the PDE (P 0 ) u = 0 on ∂Ω,
problem), a linear regression, or a visual inspection, al-
lows us to identify α. (cid:26) −∆u+αu = f in Ω=]0,1[2,
(P )
∞ ∇u·n = 0 on ∂Ω.
Let us discuss the P1 approximation, see the left-
hand side of Figure 13.
At least formally, we may expect that the solution u of
ε
• Numerical results provide the estimate (cid:107)u− (P )
ε
u (cid:107) =O(h). This illustrates Theorem 5.10,
h H1
as u∈H1(Ω)∩H2(Ω). converges to the solution of (P ) when ε goes to 0,
0 0
• Numerical results provide the estimate (cid:107)u−
u h (cid:107) L2 =O(h2): as (P) satisfies the elliptic reg- converges to the solution of (P ∞ ) when ε goes to
ularity property, the Aubin-Nitsche lemma +∞.
applies, see Lemma 5.11.
Let us discuss now the P2 approximation, see the Let us use FreeFem++ as a validation tool for the
above formal asymptotics. In that prospect we need to
right-hand side of Figure 13.
definethevariationalformulationofeachproblem: itwill
• Numerical results provide the estimate (cid:107)u− allow us to define the suitable functional framework of
u (cid:107) =O(h2). This illustrates Theorem 5.19, our problems and it will be the key for the computations
h H1
as u∈H1(Ω)∩H3(Ω). with FreeFem++.
0
Introducci´on al m´etodo de los elementos finitos 55
10−2
slope 1
10−3
10−4
slope 2
10−5
10−6
10−7
10−2 10−1
h
(cid:107)
u−u(cid:107) h
P1 approximation
10−2
10−3
10−4
slope 2
10−5
H1 error
L2 error 10−6
slope 3
10−7
10−2 10−1
h
(cid:107)
u−u(cid:107) h
P2 approximation
H1 error
L2 error
Figure 13. Problem 7.1 : comparison between the P1 and P2 approximations
1. The variational formulations of the problems write: with a very small value for ε: this is a so-called
penalty method, as the Dirichlet condition is mim-
 Find u∈H1(Ω) such that
 (cid:90) (cid:90) 1(cid:90) (cid:90) icked by a penalized Robin condition. This also
(P ε ) ∇u·∇v+α uv+ uv= fv, explains how FreeFem++ is able to compute the
 for Ω all v∈H1(Ω) Ω , ε ∂Ω Ω solution of a problem with a non-homogeneous
1
condition u=g, even if g∈/H2(∂Ω).
  F (cid:90) ind u∈H 0 1(Ω) (cid:90) such th (cid:90) at The numerical results are compatible with the fol-
(P ) ∇u·∇v+α uv= fv, lowing result:
0

for
Ω
all v∈H1(Ω)
Ω
,
Ω
0 Proposition 7.3 (From Robin to Dirichlet) Let
u be the variational solution of the Laplace-Robin
 Find u∈H1(Ω) such that ε
 (cid:90) (cid:90) (cid:90) problem(P ε )andletu 0 bethesolutionoftheLaplace-
(P ∞ ) ∇u·∇v+α uv= fv, Dirichlet problem (P 0 ). Then u ε converges to u 0 in

for
Ω
all v∈H1(Ω)
Ω
.
Ω H1(Ω) as ε goes to 0.
Assume furthermore that u ∈H2(Ω). Moreover
0
Each problem is well-posed (for problem (P ), use
ε (cid:107)u −u (cid:107) converges to 0 at least at order 1/2.
the continuity of the trace operator for the math-
ε 0 H1
ematical treatment of the boundary term in the
Proof of Proposition 7.3.
bilinearform)andwewilldenoteu , u andu the
ε 0 ∞
respective solutions of the problems. We first take v=u as a test function in (P ) and
ε ε
we use the Cauchy-Schwarz inequality to deduce
2. We fix α =1 and f =1 for the computations. We
that
use a mesh 200×200 and, in fact, we compute
the error (cid:107)u −u (cid:107) . In the left-hand side of α 1(cid:90) 1
ε,h 0,h H1 (cid:107)∇u (cid:107)2 + (cid:107)u (cid:107)2 + |u |2≤ (cid:107)f(cid:107)2 , ∀ε>0.
Figure 14 we observe that, as ε goes to 0, u ε,h ε L2 2 ε L2 ε ∂ ε 2α L2
converges to u in H1(Ω) at order 1:
0,h
It follows that the family u is bounded in H1()
ε
(cid:107)u
ε,h
−u
0,h
(cid:107)
H1
(cid:39)Cε.
and that the traces γ (u ) tends to 0 in L2(∂Ω) as
0 ε
ε→0. Asaconsequence,thereexistsasubsequence
Actually this is how FreeFem++ imposes Dirichlet
u that weakly converges towards some u in H1()
boundary conditions! The software considers all εk
and moreover, this limit satisfies γ (u)=0 that is
the nodes as unprescribed (including the boundary 0
u∈H1(Ω).
nodes). Inordertoprescribeu=gattheboundary, 0
the software considers a Robin condition Taking now a test function v∈H1(Ω) in (P ), the
0 ε
boundary term disappears and we can easily pass
1 1
∇u·n+ u= g, to the limit as k goes to infinity. It follows that
ε ε
56 Introducci´on al m´etodo de los elementos finitos
10−1
10−2
10−3
10−4
10−5
10−6
slope 1
10−7
10−7 10−6 10−5 10−4 10−3 10−2 10−1
ε
(cid:107)
u−
u(cid:107)
1H
h,0
h,ε
The limit ε →0
10−1
slope −1
H1 error 10−3
10−5
10−7
10−9
10−11
102 104 106 108 1010
ε
(cid:107)
u−
u(cid:107)
1H
h,∞
h,ε
The limit ε →∞
H1 error
Figure 14. Problem 7.2. Illustrations of the convergence in the regimes ε →0 and ε →∞
u=u , the unique solution of (P ). By Theorem the inequality (41) gives
0 0
4.2, we obtain that the whole family u weakly
ε 1 ε
converges to u in H1(Ω) as ε →0. It remains to (cid:107)∇e (cid:107)2 +α(cid:107)e (cid:107)2 + (cid:107)e (cid:107)2 ≤ (cid:107)u (cid:107)2 ,
0 ε L2 ε L2 2ε ε L2(∂) 2 0 H2
show the strong convergence.
and the proof is complete. (cid:4)
We set e =u −u . We test the equation satisfied
ε ε 0
byu 0 byatestfunctionv∈H1(Ω)andwesubtract 3. We fix α =1 and f =1 for the computations. We
the weak formulation of (P ε ) to get useamesh50×50andwecomputetheerror(cid:107)u ε,h −
u (cid:107) . In the right-hand side of Figure 14 we
0,h H1
(cid:90) (cid:90) 1(cid:90)
observe that, as ε goes to +∞, u converges to
∇e ·∇v+α e v+ e v ε,h
Ω ε Ω ε ε ∂Ω ε u ∞,h in H1(Ω) at order 1:
=−(cid:104)∇u ·n,v(cid:105) , ∀v∈H1(Ω).
0 H−1/2,H1/2 C
(cid:107)u −u (cid:107) (cid:39) .
ε,h ∞,h H1
ε
Takingv=e asatestfunctioninthislastequation,
ε
we obtain
The numerical results are compatible with the fol-
lowing result:
1
(cid:107)∇e (cid:107)2 +α(cid:107)e (cid:107)2 + (cid:107)e (cid:107)2
ε L2 ε L2 ε ε L2(∂) Proposition 7.4 (From Robin to Neumann)
=−(cid:104)∇u 0 ·n,e ε (cid:105) H−1/2,H1/2 . (41) Let u ε be the variational solution of the Laplace-
Robin problem (P ) and let u be the solution of
This last quantity converges to 0 since e weakly ε ∞
ε the Laplace-Neumann problem (P ). Then u con-
converges to 0 in H1(Ω) and the first claim is ∞ ε
vergestothesolutionu asε goesto+∞. Moreover
proved. ∞
(cid:107)u −u (cid:107) converges to 0 at least at order 1.
ε ∞ H1
Assume now that u ∈H2(), which implies in par-
0
ticular that ∇u 0 ·n∈L2(∂Ω), it follows that the Proof of Proposition 7.4. We have
boundary term can be written as an integral in-
(cid:90) (cid:90) 1(cid:90) (cid:90)
stead of duality bracket and can be estimated as ∇u ·∇v+α u v+ u v= fv,
ε ε ε
follows Ω Ω ε ∂Ω Ω
(cid:12) (cid:12) (cid:90) (cid:12) (cid:12) for all v∈H1(Ω). Taking v=u ε as a test function,
(cid:12) ∇u 0 ·ne ε(cid:12) we get
(cid:12) ∂Ω (cid:12)
(cid:18)(cid:90) (cid:19)1/2(cid:18)(cid:90) (cid:19)1/2 (cid:90) (cid:90) 1(cid:90) (cid:90)
≤ ∂Ω |∇u 0 ·n|2 ∂Ω |e ε |2 Ω |∇u ε |2+α Ω u2+ ε ∂Ω |u ε |2= Ω fu ε .
ε (cid:90) 1 (cid:90)
≤ |∇u ·n|2+ |e |2, On the one hand,
0 ε
2
∂Ω
2ε
∂Ω
(cid:90) (cid:90) 1(cid:90)
by the Young’s inequality. Using this estimate in Ω
|∇u
ε
|2+α
Ω
u2+
ε ∂Ω
|u
ε
|2≥min(1,α)(cid:107)u
ε
(cid:107)2
H1
Introducci´on al m´etodo de los elementos finitos 57
and, on the other hand, 7.3 On a Dirichlet boundary term g∈/H1/2(∂Ω)
Problem. ConsiderthePoissonproblemonaunitsquare
(cid:90)
fu ≤(cid:107)f(cid:107) (cid:107)u (cid:107) . Ω=]0,1[2 with a source term f ≡1 and Dirichlet bound-
ε L2 ε H1
Ω aryconditions: forthispurpose,wedenoteΓ:=]0,1[×{0}
and consider the problem
Thus we obtain the estimate
(cid:26)
(cid:107)f(cid:107) −∆u = f in Ω,
(cid:107)u (cid:107) ≤ L2 . (42)
ε H1 min(1,α) u = g on ∂Ω,
where the boundary data is defined as
(cid:26)
Remark 7.5 Atthisstage,weprovethatu ε weakly g(x)= 1 if x∈Γ,
converges to u ∞ in H1(Ω). Indeed, {u ε } is bounded 0 if x∈∂Ω\Γ.
in H1(Ω), {u } weakly converges, up to a subse-
ε
quence, to some u¯∈H1(Ω). Passing to the limit in We recall that g does not belong to H 1 2(∂Ω), see Exer-
the variational formulation (note that γ 0 (u ε ) weakly cise 1.
converges to γ 0 (u¯) in L2(∂Ω), by continuity of the ComputetheP1 finiteelementsolutionu h anddiscuss
trace operator), we get : the behaviour of (cid:107)u (cid:107) as h goes to 0. (cid:3)
h H1
(cid:90) (cid:90) (cid:90)
∇u¯·∇v+α u¯v= fv, Solution. Letusdefinetwoproblems(P(i)),fori∈{0,1}:
Ω Ω Ω
(cid:26)
−∆u = f in Ω,
for all v∈H1(Ω). By uniqueness of the solution of (P(i))
u = g(i) on ∂Ω,
the Laplace-Neumann problem, u¯=u .
∞
with the corresponding boundary terms:
Now defining e =u −u , we use the variational
ε ε ∞ (cid:26)
0 if x∈Γ,
formulations of the two problems and, by subtrac- g(0)(x)=
tion,
0 if x∈∂Ω\Γ,
(cid:26)
(cid:90)
∇e ·∇v+α
(cid:90)
e v+
1(cid:90)
u v=0, ∀v∈H1(Ω). g(1)(x)=
0 if x∈Γ,
Ω ε Ω ε ε ∂Ω ε 1 if x∈∂Ω\Γ.
(0) (1)
Then taking v=e as a test function, we obtain We denote u and u the corresponding finite element
ε h h
solutions, see Figures 15 and 16.
(cid:90) (cid:90) 1(cid:90)
Ω |∇e ε |2+α Ω e2 ε =− ε ∂Ω u ε e ε . A tio n n al o y f s ( is P( o 0) f ) P co r n o v b e l r e g m es ( t P o (0 t ) h ). e T un h i e qu fi e ni v t a e r e ia le t m ion en a t l s so o l l u u- -
On the one hand, tion u(0)∈H1(Ω), since f ∈L2(Ω) (actually, f ∈H−1(Ω)
0
wouldbesufficient). Inourcase,thedomainbeingpolyg-
(cid:90) (cid:90)
|∇e |2+α e2≥min(1,α)(cid:107)e (cid:107)2 onal and convex, we may even prove that u(0)∈H2(Ω).
ε ε ε H1
Ω Ω As a consequence, if we use P1 finite elements, u (0)
h
and, on the other hand, strongly converges to u(0) in H1(Ω) at order 1. Figure 17
illustrates the convergence of (cid:107)u (0) (cid:107) to (cid:107)u(0)(cid:107) .
1(cid:90) C h H1 H1
− u e ≤ (cid:107)u (cid:107) (cid:107)e (cid:107) ,
ε ∂Ω ε ε ε ε H1 ε H1 Analysis of Problem (P(1)). The behaviour of the fi-
nite element solution of (P(1)) is quite different: indeed
where we have used the Cauchy-Schwarz inequality
and the continuity of the trace operator. Combin-
g(1)∈/H2 1 (∂Ω) and thus the lift operator cannot be ap-
plied. Actually the discrete linear problem is well-posed
ing the previous inequalities and the estimate on
(1)
(cid:107)u ε (cid:107) H1 , see Eq. (42), we get but the finite element solution u h does not converge to
an element in H1(Ω): problem (P(1)) admits no solution
(cid:107)e (cid:107) ≤ (cid:107)f(cid:107) L2 1 , in H1(Ω). In particular singularities concentrate at the
ε H1 min(1,α)2ε corners (0,0) and (0,1), which means that the gradient
locally explodes, see Figure 16. Figure 17 illustrates the
which concludes the proof. (cid:4) (1) (1)
divergenceof(cid:107)u (cid:107) ,asthelimitofu doesnotbelong
h H1 h
to H1(Ω).
(cid:3) Thesecomputationsprovideanexampleofthecritical
assumptions on the non-homogeneous boundary term:
58 Introducci´on al m´etodo de los elementos finitos
u0 u1
0.10 1.00
0.05 0.5
0.00 0.00
(1) (2)
(0) (1)
Figure 15. (1) finite element solution u and (2) finite element solution u . In both cases the mesh size is
h h
h=2·10−3 and the solution is computed with P1 finite elements.
grad0 grad1
0.36 350
0.18 175
0.00 0
(1) (2)
Figure 16. (1) x(cid:55)→(cid:107)∇u ( h 0) (x)(cid:107) 2 and (2) x(cid:55)→(cid:107)∇u h (1) (x)(cid:107) 2 . In both cases the mesh size is h=2·10−3 and the solution
is computed with P1 finite elements.
Introducci´on al m´etodo de los elementos finitos 59
0.2
0.15
0.1
5·10−2
0
10−2 10−1
h
)0(
(cid:107)
u(cid:107)
1H
h
Regular problem P(0)
3
2
1
0
10−2 10−1
h
)1(
(cid:107)
u(cid:107)
1H
h
Singular problem P(1)
Figure 17. Problem 7.3. Influence of the regularity of the boundary data.
if g does not belong to H2 1 (∂Ω) then the lift operator Thus the variational formulation writes
cannot be used in order to settle a classical variational
 Find u∈H˜1(Ω) such that
formulation in H1(Ω), see Section 2.2.  (cid:90) (cid:90)
(P) ∇u·∇v= fv+(cid:104)g,v(cid:105) ,
(cid:3) 
fo
Ω
r all v∈H˜1(
Ω
Ω)
H−2 1 ,H 1 2
which is a well-posed problem under the compatibility
7.4 Compatibility conditions in PDE
condition of Eq. (43).
Problem. Solve with FreeFem++ the Poisson-Neumann
problem: How to deal with the constraint in the functional
space? Basically the main idea consists in fixing the
(cid:26) −∆u = f in Ω=]0,1[2,
constantwhichisequivalenttoprovidingsomecoercivity
∇u·n = g on ∂Ω.
to the problem. Instead of solving problem (P), we may
solve a penalized version of the problem:
with f ∈L2(Ω) and g∈H− 2 1 (∂Ω). (cid:3)
 Find u ∈H1(Ω) such that
Solution.  (cid:90) ε (cid:90) (cid:90)
(P ) ∇u ·∇v+ε u v= fv+(cid:104)g,v(cid:105) ,
w
M
o
a
rk
th
a
e
n
m
d
a
th
t
e
ic
a
a
n
l
a
f
l
r
y
a
si
m
s o
e
f
w
t
o
h
r
e
k
p
.
ro
T
b
h
le
e
m
m
a
a
r
t
e
he
r
m
eq
a
u
t
i
i
r
c
e
a
d
l f
b
r
e
a
f
m
or
e
e
- ε 
fo
Ω
r all
ε
v∈H1(Ω
Ω
),
ε Ω H−2 1 ,H 1 2
thinking about writing a FreeFem++ solver for this prob-
which is the variational formulation of problem
lem. The mathematical analysis was done in section 2.
In this problem, we recall the two main issues: (cid:26) −∆u +εu = f in Ω=]0,1[2,
ε ε
The well-posedness requires the (necessary) com- ∇u ·n = g on ∂Ω.
ε
patibility condition:
(cid:90) Inproblem(P ε ),thefunctionalframeworkreliesonH1(Ω)
Ω f+(cid:104)g,1(cid:105) H−2 1 ,H 1 2 =0. (43) ( n a e n c d es n s o a t ri H ly ˜1( z Ω er ) o ) ) a . s N th o e te m t e h a a n t, va u lu n e de o r f t t h h e e s c o o lu m t p io a n ti i b s il n it o y t
The solution cannot be unique in H1(Ω): we may assumption, by taking v≡1 as a test function we have
add any constant to a solution, thus defining an- (cid:90) (cid:90)
other solution. In order to select a unique solution ε
Ω
u ε =
Ω
fv+(cid:104)g,v(cid:105) H−1
2,H
1
2
=0.
(thus fixing the constant) we impose
Thus the approximate solution u has also zero mean
(cid:90) ε
u=0, (44) value (this property emerges from the compatibility con-
Ω dition, it is not imposed by the functional framework).
hence dealing with the functional space H˜1(Ω). We now may prove the following:
60 Introducci´on al m´etodo de los elementos finitos
Proposition 7.6 (Convergence) Let f ∈ L2(Ω) and ensure the stability of the computations and Proposition
g∈H−1 2(∂Ω). Assume that the compatibility condition 7.6 guarantees that the penalized solution is close to the
(43) is satisfied. Let u be the variational solution of the exact solution. But we should be very careful with the
ε
Laplace-Neumann problem (P ) and let u be the solution compatibility condition:
ε
of the Poisson-Neumann problem (P). Then u converges
ε if the compatibility condition is not satisfied,taking
to u as ε goes to 0. Moreover (cid:107)u −u(cid:107) converges to 0
ε H1 toosmallvaluesofε inthepenalizedproblemdoes
at least at order 1.
not work: as ε goes to 0, the limit problem is ill-
posed (recall that the compatibility condition is a
Proof of Proposition 7.6.
Bound for |u | . We observe that u ∈H˜1(Ω) for necessary condition for the well-posedness of (P));
ε H1(Ω) ε
each ε and we recall that, by the Poincar´e-Wirtinger
the compatibility condition has to be satisfied at
inequality, see Theorem 1.20, page 5, |·| is a norm
H1(Ω) the discrete level as well: thus, the projections of
on H˜1(Ω). Taking v=u ε as a test function in (P ε ) yields the data f and g over the finite element spaces
have to be done carefully.
|u |2 +ε(cid:107)u (cid:107)2 ≤ (cid:107)f(cid:107) (cid:107)u (cid:107)
ε H1(Ω) ε L2(Ω) L2(Ω) ε L2(Ω)
+C (cid:107)g(cid:107) (cid:107)u (cid:107) , Figure18wasobtainedwithFreeFem++computations
γ0 H−1
2(∂Ω)
ε H1(Ω)
by solving the Poisson-Neumann problem (in fact, the
where we have used the Cauchy-Schwarz inequality and penalized version with ε =10−8) on the unit square in
the continuity of the trace operator. Thus, we have two situations:
|u |2 ≤ |u |2 +ε(cid:107)u (cid:107)2 1. By choosing
ε H1(Ω) ε H1(Ω) ε L2(Ω)
f(x,y)=0,
≤ ((cid:107)f(cid:107) +C (cid:107)g(cid:107) )(cid:107)u (cid:107)
L2(Ω) γ0 H−1
2(∂Ω)
ε H1(Ω)
≤ C|u | , and
ε H1(Ω)

x(1−x), on ]0,1[×{0},
w
bo
h
u
e
n
re
de
C
d
o
in
nl
H
y
1
d
(
e
Ω
p
)
e
.
nds on f, g, γ
0
and Ω. Thus {u
ε
} is
g(x,y)=

0, on {0}×]0,1[,
−x(1−x), on ]0,1[×{1},
Estimatefore ε :=u ε −u. Inthevariationalformulation

0, on {1}×]0,1[,
of problem (P), thanks to the compatibility condition,
testfunctionscanbetakeninH1(Ω)andnotonlyH˜1(Ω), the compatibility condition is satisfied and we ob-
see Section 2.2. Thus we have, for all v∈H1(Ω): tained the (penalized) solution of our problem.
(cid:90) (cid:90) (cid:90)
2. Replacing f ≡0 by f ≡1, the compatibility condi-
∇u ·∇v + ε u v = fv+(cid:104)g,v(cid:105) ,
(cid:90)Ω
ε
Ω
ε
(cid:90)Ω
H−1
2,H
1
2 tion is not satisfied anymore and FreeFem++ pro-
∇u·∇v = fv+(cid:104)g,v(cid:105) , vides a nonsense solution with an amplitude of
Ω Ω
H−1
2,H
1
2 10+8: when ε is small, the L∞−norm of the (penal-
and, taking the difference, ized) solution behaves as ε−1 illustrating the fact
that the limit problem is ill-posed.
(cid:90) (cid:90)
∇e ·∇v+ε u v=0, ∀v∈H1(Ω).
ε ε
Ω Ω
(cid:3)
Note that e ∈H˜1(Ω) for each ε. Then taking v=e in
ε ε
the above equation, we get
|e |2 = −ε (cid:82) u e 7.5 Lack of regularity and error estimates
ε H1(Ω) Ω ε ε Problem. Let Ω=]0,1[2, (x ,y )∈Ω. The source term
≤ ε(cid:107)u (cid:107) (cid:107)e (cid:107) 0 0
ε L2(Ω) ε L2(Ω)
and the boundary conditions are chosen so as
≤ ε(cid:107)u (cid:107) (cid:107)e (cid:107) ,
ε H1(Ω) ε H1(Ω)
bytheCauchy-Schwarzinequality. Thenusingthebound- u(x,y)= (cid:0) (x−x 0 )2+(y−y 0 )2(cid:1)α 2
ednessof{u }andtheequivalenceof|·| and(cid:107)·(cid:107)
ε H1(Ω) H1(Ω)
is the solution of the Poisson problem.
on H˜1(Ω), we obtain
1. Prove that the regularity of u critically depends
|e | ≤Cε,
ε H1(Ω) on α:
whereC only depends on f, g, γ 0 and Ω. (cid:4)  H1(Ω), if 0<α ≤1,

Thus, in practical computations with FreeFem++, we u∈ H2(Ω), if 1<α ≤2,
may solve (P ε ) with e.g. ε =10−6: it is sufficient to  H3(Ω), if 2<α.
Introducci´on al m´etodo de los elementos finitos 61
u0 u1
0.10 1.009250e+08
0
-0.10 1.009240e+08
(1) (2)
Figure 18. Solution of the Poisson-Neumann problem by penalization: (1) the compatibility condition is satisfied;
(2) the compatibility condition is not satisfied.
2. Using FreeFem++, discuss the convergence rate of Note that r(cid:55)→r2α−1∈L1(0,1) if, and only if,
the approximations obtained by the P1 or P2 finite 2α−1>−1.
element method, depending on the value of α. As a conclusion, u∈H1(B(0,1)) if, and only
if, α >0.
(cid:3) At order 2, we have
Solution. ∂ xx u(x,y) = α(x2+y2) α 2 −1
+α(α−2)x2(x2+y2) α
2
−2,
1. For the sake of simplicity (and without loss of ∂ xy u(x,y) = α(α−2)xy(x2+y2) α 2 −2,
generality), we consider Ω=B(0,1) (the unit ball) ∂ yy u(x,y) = α(x2+y2) α 2 −1
and(x 0 ,y 0 )=(0,0). Letuscomputethederivatives +α(α−2)y2(x2+y2) α 2 −2
of the function and their related L2 integrability.
and
At order 0, we have ∂ u=∂ u.
yx xy
u(x,y)=(x2+y2) α
2
Then, computing (∂
xx
u)2, (∂
xy
u)2, (∂
yy
u)2, in-
tegrating over B(0,1) and using the change
and, as a consequence, of coordinates (x,y)=(rcosθ,rsinθ), we get
(cid:90) (cid:90) 2π(cid:90) 1 (cid:90) 1 (cid:90) (cid:90) 1
u2= r2αrdrdθ=2π r2α+1dr. |∂ u|2 = C r2α−3dr,
xx 1
B(0,1) 0 0 0 B(0,1) 0
Note that r(cid:55)→r2α+1∈L1(0,1) if, and only if, (cid:90) (cid:12) (cid:12)∂ xy u (cid:12) (cid:12) 2 = C 2 (cid:90) 1 r2α−3dr,
B(0,1) 0
2 A α s + a 1 co > nc − lu 1 s . ion, u∈L2(B(0,1)) if, and only (cid:90) B(0,1) (cid:12) (cid:12)∂ yy u (cid:12) (cid:12) 2 = C 3 (cid:90) 0 1 r2α−3dr
if, α >−1.
with
At order 1, we have
(cid:90) 2π
C = 2πα2+α2(α−2)2 cos4θdθ
∂ x u(x,y) = αx(x2+y2) α 2 −1, 1 0
∂ y u(x,y) = αy(x2+y2) α 2 −1 +α2(α−2) (cid:90) 2π cos2θdθ,
0
and, as a consequence, C = α2(α−2)2 (cid:90) 2π cos2θ sin2θdθ,
2
(cid:90) (cid:90) 2π(cid:90) 1 0 (cid:90) 2π
|∇ x u|2 = α2 r2α−2rdrdθ C 3 = 2πα2+α2(α−2)2 sin4θdθ
B(0,1) 0 0 0
(cid:90) 1 (cid:90) 2π
= 2πα2 r2α−1dr. +α2(α−2) sin2θdθ.
0 0
62 Introducci´on al m´etodo de los elementos finitos
Note that r(cid:55)→r2α−3∈L1(0,1) if, and only if, Let us focus on the numerical computation of the
2α−3>−1. solution. By Lemma 4.1 and the approximabil-
As a conclusion, u∈H2(B(0,1)) if, and only ity property of P1 and P2 with respect to H1(Ω),
the numerical solution u converges to the exact
if, α >1. h
solution u in H1(Ω). But what is the rate of con-
At order 3, we have
vergence?
∂ u(x,y) Theorem 5.10 states that the P1 method converges
xxx
=C 0 (cid:16) 3x(x2+y2) α 2 −2+x3(α−4)(x2+y2) α 2 −3 (cid:17) , atfirstorderinH1,providedthesolutionisatleast
H2.
∂ u(x,y)
xxy
=C 0 (cid:16) y(x2+y2) α 2 −2+(α−4)x2y(x2+y2) α 2 −3 (cid:17) , T at he se o c re o m nd 5 o .1 r 9 de s r ta in tes H t 1 h , a p t r t o h v e id P e 2 d m th e e th s o o d lu c t o io n n ve i r s g a es t
∂ u(x,y)
yyx least H3.
(cid:16) (cid:17)
=C 0 x(x2+y2) α 2 −2+(α−4)y2x(x2+y2) α 2 −3 , The convergence in the L2 norm illustrates Theo-
∂ yyy u(x,y) rem 5.11 when u∈H2(Ω). Note that the adjoint
(cid:16) (cid:17)
=C 0 3y(x2+y2) α 2 −2+y3(α−4)(x2+y2) α 2 −3 problem is identical to the initial problem by sym-
metry of the bilinear form so that it satisfies the
withC =α(α−2), and elliptic regularity property since the domain Ω is
0
convex.
∂ u=∂ u=∂ u, ∂ u=∂ u=∂ u.
yxx xyx xxy xyy yxy yyx Focusing on the error in the H1 norm, Figure 20
Then, computing (∂ u)2, (∂ u)2, (∂ u)2, illustrates the above theorems by observing the
xxx xxy yyx
(∂ u)2,integratingoverB(0,1)andusingthe numerical orders of convergence for α =0.5, 1.5
yyy
change of coordinates (x,y)=(rcosθ,rsinθ), and 2.5. Optimality of the finite element method
we get is achieved with the P1 elements for α =1.5 and
α =2.5 (with a numerical order that is close to 1)
(cid:90) (cid:90) 1 but not for α=0.5: in this case the convergence is
|∂ u|2 = C(cid:48) r2α−5dr,
B(0,1) xxx 1 0 suboptimal because the solution does not belong
(cid:90) B(0,1) (cid:12) (cid:12)∂ xxy u (cid:12) (cid:12) 2 = C 2 (cid:48) (cid:90) 0 1 r2α−5dr, t a o ch H ie 2 v . e O d p w ti i m th al t i h ty e o P f 2 t e h l e em fin e i n t t e s e f l o e r m α en = t m 2. e 5 th ( o w d it i h s
(cid:90) (cid:12) (cid:12)∂ yyx u (cid:12) (cid:12) 2 = C 3 (cid:48) (cid:90) 1 r2α−5dr, a α n = u 0 m .5 er a i n ca d l α or = de 1 r .5 t : h i a n t th is es c e lo c s a e se t s o th 2 e ) c b o u n t ve n r o g t en fo ce r
B(0,1) 0
(cid:90) (cid:12) (cid:12)∂ yyy u (cid:12) (cid:12) 2 = C 4 (cid:48) (cid:90) 1 r2α−5dr, i t s o s H ub 3. op S t i i m m i a la l r b o e b ca se u r s v e a t t h io e n s s o c lu a t n io b n e d le o d es w n i o th t b th el e on L g 2
B(0,1) 0
analysis.
whereC(cid:48) denotesaconstant13. Notethatr(cid:55)→
i
r2α−5∈L1(0,1) if, and only if, 2α−5>−1.
(cid:3)
As a conclusion, u∈H3(B(0,1)) if, and only
if, α >2.
2. Figure19representsthesolutionfordifferentvalues 7.6 Finite elements for the Stokes system
of α. In particular the behaviour of the solution Problem. WriteaFreeFem++programtoinvestigatethe
near the point (0.5,0.5) illustrates the regularity finite element method applied to the Stokes problem. (cid:3)
issue that has been discussed above.
Solution. The major issue discussed in Section 6, is
13with
whetherornotthecoupleofapproximationspaceschosen
(cid:16)
C 1 (cid:48) = C 0 2 9(cid:82) 0 2πcos2θdθ+(α−4)2(cid:82) 0 2πcos6θdθ for a variationnal problem in mixed form satisfies the
(cid:17)
+6(α−4)(cid:82)2πcos4θdθ , (uniform) inf-sup condition at the discrete level. In order
0
(cid:16)
C(cid:48) = C2 (cid:82)2πsin2θdθ+(α−4)2(cid:82)2πcos4θsin2θdθ to get well-posedness of the discretized Stokes problem,
2 0 0 0
+(α−4)(cid:82)2πcos2θsin2θdθ (cid:17) , the functional spaces X h and M h (for the velocity and
0
(cid:16) pressure, respectively) should indeed satisfy the inf-sup
C(cid:48) = C2 (cid:82)2πcos2θdθ+(α−4)2(cid:82)2πsin4θcos2θdθ
3 0 0 0 condition. Figures21to23exhibitthenumericalsolution
(cid:17)
+(α−4)(cid:82) 0 2πcos2θsin2θdθ , of a Stokes problem with different approximation spaces.
(cid:16)
C
4
(cid:48) = C
0
2 9(cid:82)
0
2πsin2θdθ+(α−4)2(cid:82)
0
2πsin6θdθ Consider the domain Ω=]0,1[2 and B denotes the
(cid:17)
+6(α−4)(cid:82)2πsin4θdθ . ballofcenter(0.5,0.5)andradiusr=0.25anddefinethe
0
components of the source term f as f
1
= f
2
=50×1B.
Introducci´on al m´etodo de los elementos finitos 63
uh uh uh
0.84 0.60 0.42
0.42 0.3 0.21
0.00 0.00 0.00
(a) (b) (c)
Figure 19. Function u:(x,y)(cid:55)→((x−0.5)2+(y−0.5)2) α 2 for different values of α: (a) α =0.5, (c) α =1.5,
(c) α =2.5.
We consider the (variational) Stokes problem: 7.7 Uzawa algorithm for saddle-point problems
 Problem. ConsideradomainΩandasubdomainB⊂Ω.

F
(cid:90)
ind
∇
(
u
u
:
,
∇
p)
v
∈
−
(
(cid:90)
H
0
1
p
(Ω
di
)
v
)
(
2
v
×
)
L
0
2
=
(Ω)
(cid:90)
su
f
ch
·v
t
,
hat
Let f ∈L2(Ω). Defi
1
n
(cid:90)
e
1(cid:90) (cid:90)
Ω (cid:90)Ω Ω J(v):= |∇u|2+ u2− fv,

for all (v,q)∈(
Ω
H
q
1(
d
Ω
iv
)
(
)
u
2
)
×L
=
2(Ω
0
).
,
(cid:26)
2 Ω 2
(cid:90)
Ω
(cid:27)
Ω
0 0 V = v∈H1(Ω), v=0 .
B
In order to illustrate the influence of the choice of the
approximation spaces, we use a structured mesh14. Solve with FreeFem++ the minimization problem:
(cid:40)
Figure 21 deals with P1−P0 finite elements: the Find u∈V such that
locking effect is illustrated, see Proposition 6.2, as J(u)=minJ(v).
v∈V
the numerical velocity field is 0, which evidences
the failure of the approximation. (cid:3)
Figure 22 deals with P1−P1 finite elements: the
Solution. This problem is the application of Example 1
checkerboard effect on the pressure field is illus-
developped in Section 3. By the Lax-Milgram theorem,
trated. In particular, spurious oscillations strongly
the minimization problem is equivalent to a variational
depend on the mesh size, producing an unrealistic
formulation associated to the functional spaceV. From
pressure field. The P1−P1 finite elements have the
the numerical point of view, dealing withV is difficult
same drawback as the Q1−P0 finite elements for
because we cannot build finite elements in a finite di-
which the checkerboard effect has been proved, see
mensional subspace ofV, because of the constraint. Nev-
Proposition 6.3.
ertheless, the solution u of the minimization problem is
Figure 23 deals with P1−P1 finite elements, which the first component of the solution of the saddle-point
b
are inf-sup stable. problem:

F
ar
i
e
gu
a
re
lso
24
in
d
f
e
-
a
s
l
u
s
p
w
s
it
t
h
ab
P
l
2
e.
−P
B
1
es
fi
i
n
d
i
e
t
s
e
,
e
t
le
h
m
es
e
e
nt
fi
s
n
,
i
w
te
hic
e
h
l-
 F
(cid:90)
ind
∇
(
u
u
·
,
∇
λ
v
)
+
∈
(cid:90)
H1
u
(Ω
v+
)×
λ
R
(cid:90)
su
v
ch
=
tha
(cid:90)
t
fv,
ements are more precise than the P1 b −P1 finite (Q) Ω Ω (cid:90) B Ω
e
ti
l
o
e
n
me
is
nt
r
s
e
.
gu
A
la
s
r,
a
th
c
e
on
nu
se
m
q
e
u
r
e
i
n
ca
ce
l
,
si
a
m
s
u
t
la
h
t
e
io
e
n
xa
p
c
r
t
ov
s
i
o
d
l
e
u
s
- 
for all (v,µ)∈H1(Ω)
µ
×R
B
.
u = 0,
a better approximation at fixed size mesh.
We can prove that problem (Q) is well-posed (see Sub-
section 3.3). The main advantage of this formulation is
(cid:3)
that (Q) is now a problem without constraint.
Uzawa algorithm. From the numerical point of view,
14ThelockingeffectassociatedtotheP1−P0 finiteelementsis
the solution of the (discretized version of the) saddle-
provedundertheassumptionofastructured triangular mesh,see
Proposition6.2,page46. point problem can be defined by solving directly the
64 Introducci´on al m´etodo de los elementos finitos
10−1
10−2
10−3 slope 0.25
10−4
10−5
10−6
10−7
10−2 10−1
h
(cid:107)
u−u(cid:107)
h
α =0.5 - P1 approximation
10−1
10−2
10−3 slope 0.25
10−4
H1 error 10−5
L2 error
10−6
10−7
10−2 10−1
h
(cid:107)
u−u(cid:107)
h
α =0.5 - P2 approximation
H1 error
L2 error
10−1
10−2 slope 1
10−3
slope 2
10−4
10−5
10−6
10−7
10−2 10−1
h
(cid:107)
u−u(cid:107)
h
α =1.5 - P1 approximation
10−1
10−2
10−3
10−4
H1 error 10−5
slope 1.5
L2 error
10−6
10−7
10−2 10−1
h
(cid:107)
u−u(cid:107)
h
α =1.5 - P2 approximation
H1 error
L2 error
10−1
slope 1
10−2
10−3
10−4 slope 2
10−5
10−6
10−7
10−2 10−1
h
(cid:107)
u−u(cid:107)
h
α =2.5 - P1 approximation
10−1
10−2
10−3
10−4 slope 2
H1 error 10−5
L2 error
10−6
slope 3
10−7
10−2 10−1
h
(cid:107)
u−u(cid:107)
h
α =2.5 - P2 approximation
H1 error
L2 error
Figure 20. Error analysis of the finite element method in H1 and L2 for various regularity of the exact solution.
From top to bottom α =0.5, α =1.5, and α =2.5.
Introducci´on al m´etodo de los elementos finitos 65
P
14
0
-14
U
0.4
0.2
0.0
1)
U
0.4
0.2
0.0
P
14
0
-14
2)
Figure 21. Numerical solution of the Stokes system with P1−P0 finite elements. Velocity field and pressure field for
1) h=0.067 and 2) h=0.020.
66 Introducci´on al m´etodo de los elementos finitos
P
14
0
-14
U
0.4
0.2
0.0
1)
U
0.4
0.2
0.0
P
14
0
-14
2)
Figure 22. Numerical solution of the Stokes system with P1−P1 finite elements. Velocity field and pressure field for
1) h=0.067 and 2) h=0.020.
Introducci´on al m´etodo de los elementos finitos 67
P
14
0
-14
U
0.4
0.2
0.0
1)
U
0.4
0.2
0.0
P
14
0
-14
2)
Figure 23. Numerical solution of the Stokes system with P1−P1 finite elements. Velocity field and pressure field for
b
1) h=0.067 and 2) h=0.020.
68 Introducci´on al m´etodo de los elementos finitos
P
14
0
-14
U
0.4
0.2
0.0
1)
U
0.4
0.2
0.0
P
14
0
-14
2)
Figure 24. Numerical solution of the Stokes system with P2−P1 finite elements. Velocity field and pressure field for
1) h=0.067 and 2) h=0.020.
Introducci´on al m´etodo de los elementos finitos 69
corresponding linear system. However, by nature, this Choose p0∈M.
linear system does not have a nice symmetric definite for n=0,...,+∞
positive structure for which efficient solver can be used.
1. Solve for the principal unknown:
Thatisthereasonwhymanyspecificiterativealgorithms (cid:26) Find un+1∈X such that
have been developed in the literature to solve such linear
Aun+1=L−B(cid:48)pn,
systems.
2. Update the Lagrange multiplier:
Here we present one of those alternative methods, (cid:26) Define pn+1∈M by
which is iterative: for each iteration, a first step only
pn+1=pn+ρ(Bun+1−G).
requires to solve the elliptic contribution of the problem
enddo
andthenasecondstepconsistsinupdatingtheLagrange
multiplier. The Uzawa algorithm is often used to solve Proposition 7.7 (Uzawa algorithm) Assumethatthe
saddle-point problems. In the literature it is often pre- saddle-point problem admits a solution. Then the se-
sented in a finite dimensional framework but it makes quence {un} defined by the Uzawa algorithm converges to
sense also in the infinite dimensional framework: if a the solution of the corresponding minimization problem
solution exists, then the algorithm converges! Let us if
present the algorithm in different forms. 2α
0<ρ < ,
(cid:107)B(cid:107)2
Abstract problem. Let X and M be Hilbert where α is the coercivity constant of a(·,·).
spaces,a(·,·)acontinuousbilinearformonX×X,b
acontinuousbilinearformonX×M. ForallL∈X(cid:48), Proof of Proposition 7.7. We have
for all G∈M(cid:48), we aim at solving the variational
pn+1 = pn + ρ(Bun+1−G),
problem
p = p + ρ(Bu−G),

Find (u,p)∈X×M such that hence

a(u,v)+b(v,p) = L(v), pn+1−p=pn−p+ρB(un+1−u).
b(u,q) = G(q),

for all (v,q)∈X×M.
Then
(cid:107)pn+1−p(cid:107)2
M
Then, for a given parameter ρ >0, the Uzawa
= (cid:107)pn−p(cid:107)2
M
+2ρ (cid:0) pn−p,Bun+1−u (cid:1)
M
algorithm writes:
+ρ2(cid:107)B(un+1−u)(cid:107)2
M
= (cid:107)pn−p(cid:107)2 +2ρ (cid:0) B(cid:48)(pn−p),un+1−u (cid:1)
M X
+ρ2(cid:107)B(un+1−u)(cid:107)2
M
Choose p0∈M. = (cid:107)pn−p(cid:107)2 M −2ρ (cid:0) A(un+1−u),un+1−u (cid:1) X
for n=0,...,+∞
+ρ2(cid:107)B(un+1−u)(cid:107)2
M
≤ (cid:107)pn−p(cid:107)2 −ρ(2α−ρ(cid:107)B(cid:107)2)(cid:107)un+1−u(cid:107)2.
M X
1. Solve the elliptic problem
 Find un+1∈X such that Thus if the condition on ρ is satisfied, the series

a(un+1,v)=L(v)−b(v,pn),
∑(cid:107)un+1−u(cid:107)2,
 for all v∈X. X
n
2. Update the Lagrange multiplier
 Find pn+1∈M such that is convergent. As a consequence, {un} converges to u.
 The equation satisfied by pn−p is thus
(pn+1,q)=(pn,q)+ρ(b(un+1,q)−G(q)),
 for all q∈M. B(cid:48)(pn−p)=−A(un+1−u),
enddo
which gives, for any v∈X
Operators. Defining A:X →X(cid:48) as (cid:104)Au,·(cid:105) =
b(pn−p,v)=−a(un+1−u,v)≤(cid:107)a(cid:107)(cid:107)un+1−u(cid:107)(cid:107)v(cid:107).
X(cid:48),X
a(u,·) and B:X →M(cid:48) as (cid:104)Bv,·(cid:105) M(cid:48),M =b(v,·), the By the inf-sup condition we obtain
formulation is equivalent to
b(pn−p,v)
β(cid:107)pn−p(cid:107)≤sup ≤(cid:107)a(cid:107)(cid:107)un+1−u(cid:107),
  Find (u,p)∈X×M such that v∈X (cid:107)v(cid:107)
Au+B(cid:48)p = L, and the convergence of pn to p is proved. (cid:4)
 Bu = G,
In practice, the algorithm stops running when an
where B(cid:48):M→X(cid:48) is the adjoint operator of B, the error criterion on the Lagrange multiplier is met.
bidual of M being identified to M itself. Then the Application. Let us apply the Uzawa algorithm to our
Uzawa algorithm writes: problem. It reads
70 Introducci´on al m´etodo de los elementos finitos
or, alternatively,
Define λ0=0.
for n=0,...,+∞
(cid:12) (cid:12)λn+1−λn(cid:12)
(cid:12)
<tol
ρ
1. Solve the problem
 Find un+1∈H1(Ω) such that
 (cid:90) (cid:90) (cid:90) (cid:90) in which case the stopping test addresses the numerical
∇un+1·∇v+ un+1v= fv−λn v, constraint (cid:107)Bun−G(cid:107).

fo
Ω
r all v∈H1(Ω)
Ω
.
Ω B
Choosing
2. Solve the problem ρ
max
(cid:40) Find λn+1∈R such that ρ = 2 ,
(cid:90)
λn+1=λn+ρ un+1. the algorithm converges and produces the numer-
B ical solution (u ,λ ) where u is represented on
enddo h h h
Figure 25 and λ =−5.25807. Actually, with our
h
Let us compute the range of admissible values for fixed tolerance and our choice for ρ, the algorithm
the Uzawa parameter ρ in our constrained problem. For converges in 11 iterations and, in the end, satisfies
the sake of simplicity, we assume that Ω=]0,1[2. The (cid:82) u =5.86·10−11 which is quite satisfactory.
B h
coercivity constant is α =1. Then, for all u∈H1(Ω),
As it was outlined the choice of ρ has a critical im-
|Bu|= (cid:12) (cid:12) (cid:12) (cid:12) (cid:90) B u (cid:12) (cid:12) (cid:12) (cid:12) ≤ (cid:90) B |u|≤|B| 1 2(cid:107)u(cid:107) L2(Ω) ≤|B|2 1 (cid:107)u(cid:107) H1(Ω) , p ex a h ct ib o it n s t t h h e eb b e e h h a a v v i i o o u u r r o o f f t t h h e e s a e l q g u o e r n it c h e m { . λn F } ig f u or re va 2 r 6 -
ious values of the Uzawa parameter: for ρ >ρ ,
max
so that
the method does not converge. For ρ <ρ the
(cid:107)B(cid:107):= sup |Bu| ≤|B| 1 2. method converges but the choice of ρ cr m it a i x cally
(cid:107)u(cid:107)
u∈H1(Ω) H1(Ω) rules the the rate of convergence: it is optimal for
Moreover, taking u˜≡1 yields ρ =0.5·ρ
max
whereas it is deteriorated when too
small or too close to ρ .
|Bu˜| |B| max
= =|B|.
(cid:107)u˜(cid:107) H1(Ω) |Ω| 1 2 Remark 7.8 The Stokes problem can be solved itera-
tively with the Uzawa algorithm: the elliptic part reduces
Thus, to a vector Laplace problem (for which all the compo-
if |B|=1 (i.e. if B=Ω), then the bound is obvi- nent of the velocity can be uncoupled) whereas the update
of the Lagrange multiplier (the pressure field) reduces
ously attained and
to a simple computation. Let Ω be a bounded domain,
(cid:107)B(cid:107)=1. f ∈L2(Ω) and consider the Stokes problem:

if |B|<1, we have
(cid:107)B(cid:107)=|B|,
 F (cid:90) ind
∇
(
u
u
:
,
∇
p)
v
∈
−
( (cid:90) H 0 1
p
(Ω
di
)
v
)
(
2
v
×
)
L 0 2
=
(Ω) (cid:90) su
f
ch
·v,
that
Ω (cid:90)Ω Ω
which is consistent with the case |B|=1.

for all (v,q)∈(
Ω
H
q
1(
d
Ω
iv
)
(
)
u
2
)
×L
=
2(Ω
0
)
,
.
0 0
Then the Uzawa parameter should be chosen as
Then the Uzawa algorithm writes:
2
0<ρ <ρ := .
max |B|2
Choose p0≡0.
Numerical results. Let us present some numerical for n=0,...,+∞
simulations: B is the disk of center (0.5,0.5) and radius
1. Solve the elliptic problem
r=0.2. We define the source term as
 Find un+1∈(H1(Ω))2 such that
(cid:26) 1, if (x,y)∈B,  (cid:90) 0(cid:90) (cid:90)
f(x,y)= ∇un+1:∇v= pndiv(v)+ f·v,
−1, if (x,y)∈/B.

fo
Ω
r all v∈(H1(Ω)
Ω
)2.
Ω
0
In practice the Uzawa algorithm stops running when 2. Update the Lagrange multiplier
the user estimates that convergence of {λn} has been  Find pn+1∈L2(Ω) such that
numerically reached. Thus we define for instance tol=  (cid:90)
pn+1q=
(cid:90)
pnq−ρ
(cid:90)
qdiv(un+1),
10−8 and the computations will stop as soon as

fo
Ω
r all q∈L2
Ω
(Ω).
Ω
(cid:12) (cid:12)λn+1−λn(cid:12)
(cid:12)<tol, enddo
Introducci´on al m´etodo de los elementos finitos 71
U
0.032
-0.049
-0.130
Figure 25. Solution of the saddle-point problem with the Uzawa algorithm. The solution u h numerically satisfies
(cid:82)
u =0.
B h
20
15
10
5
0
−5
−10
−15
−20
10 20 30 40 50 60 70 80
ITERATION
rorregol
B1
A
B2
C
Figure 26. Convergence of the Lagrange multiplier with the Uzawa algorithm for different values of ρ.
72 Introducci´on al m´etodo de los elementos finitos
Notice that the initialization p0≡0 guarantees that usrecallthatbuoyancydenotesthepowertofloatorrise
the Lagrange multiplier has zero mean value at each time in a fluid; therefore a particle is said buoyant if ρ (cid:54)=ρ
B f
step: choosing q≡1 as a test function, we get by the and neutrally buoyant if ρ =ρ.
B f
Lagrange multiplier equation
1. Computetheinstantaneousvelocityfieldgenerated
(cid:90) (cid:90) (cid:90) by the inclusion of a rigid sphere in the fluid.
pn+1= pn−ρ div(un+1)
Ω Ω Ω
(cid:90) (cid:90) 2. Compute the dynamics of a buoyant sphere in a
= pn−ρ un+1·n fluid at rest.
Ω ∂Ω
(cid:90)
= pn, 3. Compute the dynamics of a neutrally buoyant el-
Ω lipsoid in a linear shear flow.
hence the property inherited from the initialization step.
(cid:3)
(cid:3)
Solution. We present a fictitious domain approach that
allows us to address the fluid-structure interaction prob-
lem.
7.8 A fluid-structure interaction problem
Problem. We aim at describing the interaction between “Direct”formulationoftheproblem. Thecomputa-
a rigid particle and an incompressible Newtonian fluid. tional method that we propose is based upon a fictitious
Let Ω be the unit square in R2. Let B(t)⊂Ω a rigid domain approach: the velocity field u and the pressure
particlewithacenterofmassx ,angularpositionθ . field p, defined on Ω\B are extended over Ω by
B(t) B(t)
Inertial effects are neglected, which leads us to consider
the instantaneous equilibrium of forces within the fluid u(t,x) = U(t)+ω(t)(x−x B(t) )⊥, on B(t),
and for the particle. Thus, at each time t, we consider p(t,x) = 0, on B(t).
the Stokes equations in the fluid domain:
Theextensionof pfollowsfromthefactthatthepressure
  −div(2µD(u)−pI) = f f in Ω\B(t), field is the Lagrange multiplier associated to the incom-
(FSI 1 ) div(u) = 0 in Ω\B(t), pressibility condition. Note that if u describes a rigid
 u = Ur on ∂B(t). movement, thenitisdivergencefree, hencetheextention
by 0 for the associated pressure field is natural.
Here µ denotes the fluid viscosity and f :=−ρ ge de-
f f y We introduce the functional spaces:
notes the gravity force exerted on the fluid (with density
ρ f ). D(u):= 1 2 (∇u+(∇u)t) is the strain tensor. The X B = {u∈(H 0 1(Ω))2, ∃(U,ω)∈R2×R,
boundary condition at the fluid-particle interface ∂B(t) u(x)=U+ω(x−x )⊥ a.e. in B},
B
is a no-slip condition: the particle has a rigid move- M = {p∈L2(Ω), p=0 a.e. in B}.
B 0
mentwhichisdecomposedintoatranslationalmovement
(withtranslationalvelocityU)andarotationalmovement We introduce the source term
(with rotational velocity ω),
f := f 1 +f 1 .
f Ω\B B B
Ur(t,x)=U(t)+ω(t)(x−x )⊥, t>0, x∈∂B(t).
B(t)
By the forthcoming Proposition 7.9, the fluid flow is
The translational and rotational velocities are a priori determined as the solution of the variational problem:
unknown. We use the notation x⊥=(−x ,x ). The fluid-
2 1  Find (u,p)∈K ×M such that
s
th
tr
e
u
N
ct
e
u
w
re
to
i
n
nt
e
e
q
r
u
a
a
c
t
t
i
i
o
o
n
n
w
e
h
m
ic
e
h
rg
e
e
x
s
p
f
r
r
e
o
s
m
ses
t
t
h
h
e
e
c
i
o
n
u
st
p
a
l
n
in
t
g
an
w
eo
it
u
h
s

2µ
(cid:90)
D(u):D
B
(v)−
B (cid:90)
pdiv(v) =
(cid:90)
f·v,
equilibrium of the forces applied to the particle: (F) Ω (cid:90)Ω Ω
 (cid:90) (cid:90)

Ω
qdiv(u) = 0,
 f
B
− σ.n = 0, for all (v,q)∈K
B
×M
B
.
(FSI 2 ) (cid:90) (cid:90) B ∂B
 (x−x B )⊥·f B − (x−x B )⊥·(σ.n) = 0. Proposition 7.9 Let(u,p)∈(H1(Ω))2×L2(Ω). Assume
B ∂B 0 0
that the restriction to Ω\B of (u,p) belongs to (H2(Ω\
where σ :=2µD(u)−pI is the total stress tensor for B))2×H1(Ω\B). Then (u,p) is a solution of Equa-
a Newtonian fluid. Here f B denotes the external non- tions (FSI 1 )−(FSI 2 ) if, and only if, (u,p) is a solution
hydrodynamical forces exerted on the particle. In our of problem (F).
case we restrict our study to the gravity forces: f :=
B
−ρ g(0,1), where ρ is the density of the particle. Let The dynamics of the rigid particle is described by:
B B
Introducci´on al m´etodo de los elementos finitos 73
 (cid:90)  Find (u ,p )∈(H1(Ω))2×L2(Ω) such that
(P)

d
d
t
x
B(t)
=U(t):= B(
(cid:90)
t)
B
ρ
(t
B
)
u
ρ
(
B
t,
d
x
x
)dx
,
(F ε )

2µ
(cid:90)
Ω
D
ε
(u
−
ε
ε
)
(cid:90)
:D
p
(
ε
v
d
0
)
iv
+
(v
ε
2
)
(cid:90)
B
=
D(
0
u
(cid:90) ε
):
f
D
·
(
v
v
,
)

d
d
t θ B(t) =ω(t):=
(cid:90)
B(t) (cid:90)
ρ B u
ρ
(t
B
,
(cid:107)
x
x
)
−
·(x
x
B
−
(t
x
)
(cid:107)
B
2
(t
d
) )
x
⊥dx
.

for all (v,q)∈
(cid:90)Ω
Ω (
q
H
d
0 1
i
(
v
Ω
(u
)
ε
)2
)
×
=
L 0 2(Ω
0
)
Ω
,
.
B(t) Roughly speaking, the penalty term 2(cid:82) D(u ):D(v)
ε B ε
ensures that when ε tends to 0, then D(u ) tends to 0
The computational method relies on the computa- ε
on B, thus satisfying the constraint in the asymptotic
tion of the solution, at a given time, of the variational
regime. It means also that rigid domains are modelled
problem (F) which determines the flow generated by the
as highly viscous domains (with viscosity 1/ε).
inclusion of the particle and, then update the position of
It is possible to prove the following result:
theparticlebysolving(P)(withanexplicitEulerscheme,
for instance). Thus let us focus on the computation of
Proposition 7.12 Let (u,p) be the solution of (F) and
the solution of problem (F).
let (u ,p ) be the solution of (F ). Then
ε ε ε
(cid:107)u−u (cid:107) =O(ε).
Remark 7.10 For the sake of simplicity (and without
ε H1(Ω)
any consequences on the velocity field) we may replace Fromthecomputationalpointofview,itispossibletouse
the source term modelling the gravity a standard finite element solver to compute the solution
of(F ). Thisapproachdoesnotrequiremeshadaptation
ε
f := f 1 +f 1 techniques: a fixed (structured or unstructured) mesh
f Ω\B B B
can be used.
by a source term modelling the buoyancy only:
Algorithmforthedynamicsofarigidparticleina
fluid. Thedynamicsofaparticlewhichevolvesinafluid
f˜:= f−f f =(f B −f f )1 B . has been modelled by a strongly coupled fluid-structure
interaction problem: we aim at solving problems (F)
Penalizedformulationofproblem(F). Solvingprob- and (P). Let us describe how to handle this coupled
lem (F) with a finite element solver is not easy: the ele- problem with the computational aspects. Problem (P) is
mentsshouldbelongtotheconstrainedfunctionalspaces. solved using an explicit Euler scheme but requires the
Moreover, as the rigid domain may evolve in time, so do knowledge of the instantaneous velocity field generated
the constraints. As a consequence, a finite element basis by the inclusion of the rigid particle, hence the solution
shouldbebuiltateachtimestep,whichisprohibitive! In of problem (F). As it was outlined, problem (F) can be
order to avoid these difficulties, we may use an approxi- solved with the penalty formulation or the saddle-point
mationmethodwhichconsistsinrelaxingtheconstraints formulation. We present the algorithm with the penalty
inthefunctionalspaces,thusleadingtothepossibilityof method (the adaptation for the saddle-point formulation
using standard finite element solvers. In the variational is straightforward).
formulation, the relaxation of the constraints should be Assume that the position of a particle is known at
associated with the introduction of integrals which tend time t n . We aim at computing the velocity field in the
to mimick / impose the constraint on the solution: this fluid at timet n and update the position of the particle at
additional term is called a penalty term. time t n+1 =t n +∆t. The computational process writes:
Let us introduce another characterization of the rigid
Step 0 (initialization). The position of the cen-
movement: ter of mass xn =x (t ) and angle θn =θ (t ) are
B B n B B n
known. The rigid domain
Proposition 7.11 We have
Bn:=B(t )
n
X ={u∈(H1(Ω))2, D(u)=0 a.e. in B}.
B 0 is completely characterized by xn, θn and the geo-
B B
metrical properties of the particle.
Roughlyspeaking,theabovepropositionstatesthatrigid
movements do not deform the domain (as D(u) is the Step 1. Define the generalized viscosity and the
deformation tensor). source term:
The penalty method applied to the variational for-
1
mulation leads to the following problem: µn:=µ1 Ω\Bn +
ε
1 Bn, fn:=(f Bn−f f )1 Bn.
74 Introducci´on al m´etodo de los elementos finitos
Step 2. Solve (the penalized version of) prob- interface, the velocity field is continuous but its
lem (F): gradient admits a jump discontinuity through the
interface). As a consequence, higher order finite
elements would increase the computational costs

 F (cid:90) ind
2µ
(u
n
n
D
,p
(u
n
n
)
)
∈
:
(
D
H
(
0
v
1
)
(Ω
−
) (cid:90) )2×
pn
L
d
0 2
i
(
v
Ω
(v
)
)
suc
=
h th (cid:90) at
fn·v,
w
ys
it
is
ho
g
u
u
t
a
a
r
d
a
d
n
i
t
t
e
io
es
na
t
l
h
a
a
c
t
c
,
u
b
ra
y
c
u
y.
si
N
ng
ev
t
e
h
rt
e
h
m
ele
in
ss
i
t
e
h
le
e
m
a
e
n
n
a
t
l-
,
Ω (cid:90)Ω Ω the numerical solution converges to the exact so-

for all (v,q)∈(H1(Ω))2 Ω ×
q
L
d
2
i
(
v
Ω
(u
)
n
.
) = 0, l
o
u
r
t
d
i
e
o
r
n
t
w
o
it
g
h
ua
a
ra
su
n
b
te
o
e
pt
a
im
co
a
n
l
v
o
e
r
r
d
g
e
e
r
n
o
ce
f c
r
o
a
n
te
ve
o
r
f
ge
o
n
r
c
d
e
er
(i
1
n
,
0 0 the solution should be in H2, see Theorem 6.6).
Note that the definition of µn leads to write the Figure 27 presents the velocity field generated by
a rigid sphere of radius r=0.1 and coordinates
penalized problem as
(0.5,0.6). The sphere is not neutrally buoyant
(cid:90) (ρ >ρ).
2µnD(u):D(v) B f
Ω
(cid:90) 2(cid:90) 2. Sedimentationofarigidsphereinafluidatrest,see
=2µ D(u):D(v)+ D(u):D(v).
Ω ε Bn Section 8, Program 8.2. We consider the domain
Ω=]0,1[2 made of an incompressible Newtonian
Notealsothattheaboveproblemcanbeusedwith
fluid and a rigid sphere of radius 0.1 with a center
a standard finite element solver.
of mass located at (0.5,0.8). The sphere is not
neutrally buoyant (ρ >ρ) so that it is expected
Step 3. Solve problem (P) with an explicit Euler B f
that the sphere falls down to the ground. By a
scheme:
symmetry argument, if the initial position of the
Compute the translational and rotational ve- sphereissymmetricwithrespecttotheaxisx=0.5
locities of the particle at time t : then the sphere falls along this axis with a zero an-
n
gular velocity. As a consequence we only compute
(cid:90)
ρ un(x)dx the translational velocity in order to update the
B
Un := Bn , position of the sphere. We compute the solution
(cid:90)
ρ dx of the penalized version of the fluid-structure in-
B
(cid:90) ρ B B n un(x)·(x−x Bn)⊥dx t a er 1 a 0 c 0 t × ion 10 p 0 ro s b tr le u m ctu w r i e t d h m P1 b e − sh P . 1 T fi h n e ite fa e ll le o m f e a nt r s ig o id n
ωn := Bn (cid:90) . sphere in a fluid at rest is reproduced in Figure 28.
ρ
B
(cid:107)x−x Bn(cid:107)2dx
Bn
3. Rotating ellipsoid in a linear shear flow, see Sec-
Update the position of the particle:
tion 8, Section 8.8, Program 8.3. We consider the
xn+1=xn+∆tUn, θn+1=θn+∆tωn. domain Ω=]0,1[2. A linear shear flow may be
B B B B
described by the velocity profile
1. Inclusion of a rigid sphere in a fluid. We con- (cid:18) (cid:19)
1
sider the domain Ω=]0,1[2 which divides into two u(x,y)=(1−2y) ,
0
(moving) subdomains: a part is occupied by an
incompressible Newtonian fluid (viscosity µ =1)
which is obtained by solving the Stokes equations
and the other part is a rigid sphere (radius 0.1)
in Ω with the boundary conditions
at (x0,y0)=(0.5,0.8). The sphere is not neutrally
buoyant(ρ B =1.0,ρ f =0.1). Theinstantaneousve- u(·,0)=+1, on y=0,
locity field generated by the inclusion of the sphere u(·,1)=−1, on y=1,
may be computed by using the penalized formula-
tion of the problem. In the penalized formulation, andperiodicconditionswithrespecttox. Consider
ageneralizedStokesproblemissolvedateachtime anellipsoid(withhalfsemi-axes0.1and0.25)which
step. This requires the use of finite elements that is neutrally buoyant (i.e. ρ =ρ). When inserting
B f
are inf-sup stable. In that prospect we use P1−P1 theellipsoidintheshearflow,thevelocityprofilein
b
finite elements. Note that it is no worth using the fluid is modified and, as a result, the backflow
P2−P1 elements in order to increase the accuracy produces a movement of the ellipsoid. We expect
of the solution: the extension of the velocity field that, if the center of mass is initially located at
fromΩ\BtoΩisnotinH3(Ω). Actuallytheveloc- (0.5,0.5), it does not evolve in time (no gravity
ity field is not even in H2(Ω) (at the fluid-particle effect), i.e. the ellipsoid does not translate. But
Introducci´on al m´etodo de los elementos finitos 75
CHI U
1.00 0.016
0.5 0.008
0.00 0.000
1) 2)
Ux Uy
0.0075 0.009
0 -0.0035
-0.0075 -0.016
3) 4)
Figure 27. Solution of the fluid-structure interaction problem with the penalty method with P1−P1 finite elements
b
on a 100×100 structured mesh: 1) characteristic function of B. 2) velocity field. 3) first component of the velocity
field. 4) second component of the velocity field.
76 Introducci´on al m´etodo de los elementos finitos
CHI U
1.00 0.016
0.5 0.008
0.00 0.000
t=t
1
CHI U
1.00 0.016
0.5 0.008
0.00 0.000
t=t
2
CHI U
1.00 0.016
0.5 0.008
0.00 0.000
t=t
3
Figure 28. Position of the sphere and velocity field at different times t i .
Introducci´on al m´etodo de los elementos finitos 77
the angular position of the ellipsoid does evolve in /* == Variational problem *******************/
time: theellipsoidrotatesarounditscenterofmass. problem Poisson(uh,vh,solver=LU) =
Wecomputethesolutionofthepenalizedversionof int2d(Th)(dx(uh)*dx(vh)+dy(uh)*dy(vh))
thefluid-structureinteractionproblemwithP1−P1 -int2d(Th)(f*vh)
b
finite elements on a 100×100 structured mesh. +on(1,2,3,4,uh=g) ;
Figure 29 represents the ellipsoid and the velocity
field at different time steps. /* == Compute uh and uh-u for different h ***/
for (int i=0;i<Niter;i++){
Th=square(np,np);
(cid:3)
Poisson;
errh=u-uh;
Vh0 uh0=uh;
8. FreeFem++ programs Vh0 errh0=u0-uh0;
8.1 Problem 1
real errL2=sqrt(int2d(Th0)(errh0^2));
/********************************************/
real errH1=sqrt(int2d(Th0)(dx(errh0)^2
/* PROBLEM 1 */
+dy(errh0)^2));
/********************************************/
hL2(i)=1./(np-1);
/* == Fine mesh *****************************/
eL2(i)=errL2;
mesh Th0=square(300,300);
hH1(i)=1./(np-1);
eH1(i)=errH1;
/* == Solution of the Poisson problem *******/
func u=x*y*(1.-x)*(1.-y);
plot(uh,wait=0);
np=np+2;
/* == Source term ***************************/
}
func f=2*y*(1.-y)+2*x*(1.-x);
ofstream out1("P2_errL2.txt");
/* == Boundary conditions *******************/
for (int i=0;i<Niter;i++){
func g=0;
out1<<log(hL2(i))<<" "<<log(eL2(i))<<endl;
}
/* == Number of computed errors *************/
int Niter=20;
ofstream out2("P2_errH1.txt");
for (int i=0;i<Niter;i++){
/* == Storage of the error in L2 or H1 ******/
out2<<log(hH1(i))<<" "<<log(eH1(i))<<endl;
real[int] eL2(Niter);
}
real[int] eH1(Niter);
/********************************************/
real[int] hL2(Niter);
real[int] hH1(Niter);
8.2 Problem 2
/* == Finite element space on the fine mesh */ From the Robin condition to the Dirichlet condition
fespace Vh0(Th0,P2); /********************************************/
/* PROBLEM 2-1: FROM THE ROBIN CONDITION */
/* == Projection on the fine mesh ***********/ /* TO THE DIRICHLET CONDITION */
Vh0 u0=u; /********************************************/
/* == Initialization of the number of nodes */ /* == Mesh **********************************/
int np=10; int np=200;
mesh Th=square(np,np);
/* == Initialization of the mesh ************/ plot(Th,wait=0);
mesh Th=square(np,np);
/* == P1 finite element space ***************/
/* == Finite element on the coarse mesh *****/ fespace Vh(Th,P1);
fespace Vh(Th,P2); Vh uh,vh,ueh,e;
Vh uh,vh,errh;
func f=1.;
78 Introducci´on al m´etodo de los elementos finitos
CHI U
1.00 1.000
0.5 0.5
0.00 0.000
t=t
1
CHI U
1.00 1.000
0.5 0.5
0.00 0.000
t=t
2
CHI U
1.00 1.000
0.5 0.5
0.00 0.000
t=t
3
Figure 29. Position of the ellipsoid and velocity field at different times t i .
Introducci´on al m´etodo de los elementos finitos 79
func g=0.; plot(Th,wait=0);
int Niter=20; /* == P1 finite element space ***************/
real[int] errH1(Niter); fespace Vh(Th,P1);
real[int] ee(Niter); Vh uh,vh,fh,ueh,e;
real eps=0.1; func f=1;
real alpha=1; real alpha=1;
/* == Variational problem *******************/ int Niter=10;
/* == with Dirichlet conditions *************/ real[int] errH1(Niter);
problem laplDir(uh,vh,solver=LU)= real[int] ee(Niter);
int2d(Th)(dx(uh)*dx(vh)+dy(uh)*dy(vh))
+int2d(Th)(alpha*uh*vh) real eps=100;
-int2d(Th)(f*vh)
+on(1,2,3,4,uh=g) ; /* == Variational problem *******************/
/* == with Neumann conditions ***************/
laplDir; problem laplNeum(uh,vh,solver=LU) =
int2d(Th)(dx(uh)*dx(vh)+dy(uh)*dy(vh))
plot(uh,wait=0); +int2d(Th)(alpha*uh*vh)
-int2d(Th)(f*vh);
/* == Variational problem *******************/
/* == with Robin condition ******************/ laplNeum;
problem laplRobin(ueh,vh,solver=LU)=
int2d(Th)(dx(ueh)*dx(vh)+dy(ueh)*dy(vh)) plot(uh,wait=0,value=true);
+int2d(Th)(alpha*ueh*vh)
+int1d(Th,1,2,3,4)((1./eps)*ueh*vh) /* == Variational problem *******************/
-int2d(Th)(f*vh); /* == with Robin condition ******************/
problem laplRobin(ueh,vh,solver=LU) =
/* == Compute the error ue-u0 ***************/ int2d(Th)(dx(ueh)*dx(vh)+dy(ueh)*dy(vh))
for (int i=0;i<Niter;i++){ +int2d(Th)(alpha*ueh*vh)
laplRobin; +int1d(Th,1,2,3,4)((1./eps)*ueh*vh)
e=uh-ueh; -int2d(Th)(f*vh) ;
real eH1=sqrt(int2d(Th)(e^2)
+int2d(Th)(dx(e)^2+dy(e)^2)); for (int i=0;i<Niter;i++){
errH1(i)=eH1; laplRobin;
ee(i)=eps; e=uh-ueh;
plot(ueh,wait=0); real eL2=sqrt(int2d(Th)(e^2));
eps=eps/2.; real eH1=sqrt(int2d(Th)(e^2)
} +int2d(Th)(dx(e)^2+dy(e)^2));
errH1(i)=eH1;
ofstream out1("q2_errorH1.txt"); ee(i)=eps;
for (int i=0;i<Niter;i++){ plot(ueh,wait=0,value=true);
out1<<log(ee(i))<<" "<<log(errH1(i))<<endl; cout<<i<<endl;
} eps=eps*10.;
/********************************************/ }
From the Robin condition to the Neuman condition
/********************************************/
ofstream out1("q3_errorH1.txt");
/* PROBLEM 2-2: FROM THE ROBIN CONDITION */
for (int i=0;i<Niter;i++){
/* TO THE NEUMANN CONDITION */
out1<<log(ee(i))<<" "<<log(errH1(i))<<endl;
/********************************************/
}
/* == Mesh **********************************/
/********************************************/
int np=200;
mesh Th=square(np,np);
80 Introducci´on al m´etodo de los elementos finitos
8.3 Problem 3
/********************************************/ /* == Mesh **********************************/
/* PROBLEM 3 */ int np=200;
/********************************************/ mesh Th=square(np,np);
/* == Define the boundaries of the domain ***/ /* == P1 finite element space ***************/
border A(t=0.,1) {x=t ;y=0; label=1;}; fespace Vh(Th,P1);
border B(t=0.,1) {x=1 ;y=t; label=2;}; Vh uh,vh;
border C(t=0.,1) {x=1-t;y=1; label=3;};
border D(t=0.,1) {x=0 ;y=1-t;label=4;}; /* == Source term f *************************/
func f=1.;
/* == Number of elements on each boundary ***/ //Vh fh=f;
int n=500;
/* == Source term g on each boundary ********/
/* == Mesh generation ***********************/ func g1= x*(1.-x);
mesh Th = buildmesh(A(n)+B(n)+C(n)+D(n)); func g2= 0.;
plot(Th,wait=1); func g3=-x*(1.-x);
func g4= 0.;
/* == Dirichlet boundary function ***********/
/* == - g0 for problem (P^0) ****************/ /* == Penalization parameter ****************/
/* == - g1 for problem (P^1) ****************/ real eps=1.0E-8;
func g0=0;
func g1=1; /* == Variational problem *******************/
problem laplace(uh,vh,solver=LU)=
/* == Finite element space (here: P1) *******/ int2d(Th)(dx(uh)*dx(vh)+dy(uh)*dy(vh))
fespace Vh(Th,P1); +int2d(Th)(eps*uh*vh)
Vh u,v,w; -int2d(Th)(f*vh)
-int1d(Th,1)(g1*vh)
/* == Define the source term ****************/ -int1d(Th,2)(g2*vh)
func f=1; -int1d(Th,3)(g3*vh)
-int1d(Th,4)(g4*vh);
/* == Define the variational formulation ****/
/* == - select g0 on boundary 4 for (P^0) ***/ real CC=int2d(Th)(f)
/* == - select g1 on boundary 4 for (P^1) ***/ +int1d(Th,1)(g1)+int1d(Th,2)(g2)
problem Poisson(u,v,solver=LU)= +int1d(Th,3)(g3)+int1d(Th,4)(g4);
int2d(Th)(dx(u)*dx(v)+dy(u)*dy(v)) cout<<"Value (should be 0): "<<CC<<endl;
-int2d(Th)(f*v)
+on(1,2,3,u=0) laplace;
+on(4,u=g0);
plot(uh,wait=0,value=true);
/* == Solve the problem *********************/ /********************************************/
Poisson;
8.5 Problem 5
/********************************************/
/* == Compute the H1-norm of the solution ***/
/* PROBLEM 5 */
real normH1=sqrt(int2d(Th)(dx(u)^2+dy(u)^2));
/********************************************/
cout<< normH1 <<endl;
plot(u,fill=0,wait=0,value=1);
/* == Fine mesh *****************************/
w=sqrt(dx(u)^2+dy(u)^2);
mesh Th0=square(300,300);
plot(w,fill=0,wait=0,value=1);
/* == Data of the problem *******************/
/********************************************/
real a =0.5;
8.4 Problem 4 real x0=0.5;
/********************************************/ real y0=0.5;
/* PROBLEM 4 */
/********************************************/ /* == Solution of the Poisson problem *******/
Introducci´on al m´etodo de los elementos finitos 81
func u=((x-x0)^2+(y-y0)^2)^(a/2.); }
/* == Source term ***************************/
func f=a^2*((x-x0)^2+(y-y0)^2)^(a/2.-1.); ofstream out1("errL2.txt");
/* == Boundary conditions *******************/ for (int i=0;i<Niter;i++){
func g=u; out1<<log(hL2(i))<<" "<<log(eL2(i))<<endl;
}
/* == Number of computed errors *************/
int Niter=20; ofstream out2("errH1.txt");
/* == Storage of the error in L2 or H1 ******/ for (int i=0;i<Niter;i++){
real[int] eL2(Niter); out2<<log(hH1(i))<<" "<<log(eH1(i))<<endl;
real[int] eH1(Niter); }
real[int] hL2(Niter); /********************************************/
real[int] hH1(Niter);
8.6 Problem 6
/* == Finite element space on the fine mesh */
/********************************************/
fespace Vh0(Th0,P2);
/* PROBLEM 6 */
/********************************************/
/* == Projection on the fine mesh ***********/
Vh0 u0=u;
int n=50;
plot(u0,value=1,fill=0,wait=0);
mesh Th=square(n,n);
/* == Initialization of the number of nodes */
int np=10;
//fespace Xh(Th,[P1,P1,P0]);
/* == Initialization of the mesh ************/
//fespace Xh(Th,[P1,P1,P1]);
mesh Th=square(np,np);
//fespace Xh(Th,[P1b,P1b,P1]);
fespace Xh(Th,[P2,P2,P1]);
/* == Finite element on the coarse mesh *****/
fespace Vh(Th,P2);
/* === Velocity and pressure field **********/
Vh uh,vh,errh;
Xh [u1,u2,p],[v1,v2,q];
/* == Variational problem *******************/
/* === Source term **************************/
problem Poisson(uh,vh) =
real r=0.25;
int2d(Th)(dx(uh)*dx(vh)+dy(uh)*dy(vh))
V0h f1h=50*((x-0.5)^2+(y-0.5)^2<r^2);
-int2d(Th)(f*vh)
V0h f2h=50*((x-0.5)^2+(y-0.5)^2<r^2);
+on(1,2,3,4,uh=g) ;
/* == Stabilization parameter ***************/
Poisson;
real eps=1E-6;
/* == Compute uh and uh-u for different h ***/
/********************************************/
for (int i=0;i<Niter;i++){
/* == Stokes problem ************************/
Th=square(np,np);
/*********************************************/
Poisson;
errh=u-uh;
problem Stokes([u1,u2,p],[v1,v2,q])=
Vh0 uh0=uh;
int2d(Th)(2*dx(u1)*dx(v1)+dy(u1)*dy(v1)
Vh0 errh0=u0-uh0;
+dx(u2)*dx(v2)+2*dy(u2)*dy(v2)
real errL2=sqrt(int2d(Th0)(errh0^2));
+dy(u1)*dx(v2)+dx(u2)*dy(v1))
real errH1=sqrt(int2d(Th0)(dx(errh0)^2
+int2d(Th)(eps*p*q-p*dx(v1)-p*dy(v2)
+dy(errh0)^2));
-q*dx(u1)-q*dy(u2))
hL2(i)=1./(np-1);
-int2d(Th)(f1h*v1+f2h*v2)
eL2(i)=errL2;
+on(1,2,3,4,u1=0,u2=0);
hH1(i)=1./(np-1);
eH1(i)=errH1;
Stokes;
plot(uh,value=1,fill=1,wait=0);
plot([u1,u2],value=1);
np=np+2;
plot(p,fill=1,value=1);
82 Introducci´on al m´etodo de los elementos finitos
/********************************************/ i=i+1;
cout<<"i="<<i<<" ; error="<<err<<endl;
8.7 Problem 7
}
/********************************************/
/* PROBLEM 7 */
plot(uh,wait=0,value=true);
/********************************************/
cout<< "*** Constraint:"<<endl;
cout<< " Bu="<< int2d(Th)(chih*uh)<<endl;
/* == Mesh **********************************/
cout<< " lambda="<<lm<<endl;
int np=100;
/********************************************/
mesh Th=square(np,np);
8.8 Problem 8
/* == P1 finite element space ***************/ Rigid sphere in a fluid: computing the velocity field with a
fespace Vh(Th,P1); penalized formulation
Vh uh,vh; /********************************************/
/* PROBLEM 8-1 */
/* == P0 finite element space ***************/ /* FSI PROBLEM A PENALIZED FORMULATION */
fespace Ph(Th,P0); /********************************************/
/* == Characteristic function ***************/ mesh Th =square(100,100);
Ph chih=((x-0.5)^2+(y-0.5)^2<0.2^2);
fespace Vh(Th,P1b);
/* == Source term f *************************/ fespace Xh(Th,P1);
Ph fh=((x-0.5)^2+(y-0.5)^2<0.2^2) Vh u1,u2,v1,v2;
-((x-0.5)^2+(y-0.5)^2>0.2^2); Xh p,q;
/* == Lagrange multiplier *******************/ /* == Coordinates / radius of the sphere ****/
/* == lm0: Lagrange multiplier at time n ****/ real xB=0.5, yB=0.6, rB=0.1;
/* == lm : Lagrange multiplier at time n+1 **/ /* == Gravity and buoyancy ******************/
real lm,lm0=0.; real g=9.81, rhoB=1.0, rhoF=0.1;
/* == Uzawa parameters **********************/ /* == Source term, characteristic function **/
real rhomax=2./(int2d(Th)(chih))^2; fespace Ph(Th,P0);
real rho=0.5*rhomax; Ph chiB = ((x-xB)^2+(y-yB)^2 < rB^2);
real tol=1.E-8; Ph f1 = 0.00;
int Nmax=100; Ph f2 = -(rhoB-rhoF)*g*chiB;
/* == Variational problem *******************/ real eps=1.0E-5, delta=1.0E-8;
problem laplace(uh,vh,solver=LU)=
int2d(Th)(dx(uh)*dx(vh)+dy(uh)*dy(vh)) /* == Penalized formulation *****************/
+int2d(Th)(uh*vh) problem FSI([u1,u2,p],[v1,v2,q])=
-int2d(Th)(fh*vh) int2d(Th)(2*dx(u1)*dx(v1)+dy(u1)*dy(v1)
+int2d(Th)(lm0*chih*vh); +dx(u2)*dx(v2)+2*dy(u2)*dy(v2)
+dy(u1)*dx(v2)+dx(u2)*dy(v1))
/* == Uzawa algorithm ***********************/ +int2d(Th)(delta*p*q-p*dx(v1)-p*dy(v2)
real err=2*tol; +q*dx(u1)+q*dy(u2))
int i=1; -int2d(Th)(f1*v1+f2*v2)
+int2d(Th)((2*dx(u1)*dx(v1)+dy(u1)*dy(v1)
while ((i<=Nmax)&&(err>tol)){ +dx(u2)*dx(v2)+2*dy(u2)*dy(v2)
+dy(u1)*dx(v2)+dx(u2)*dy(v1))*chiB/eps)
laplace; +on(1,2,3,4,u1=0,u2=0);
lm=lm0+rho*int2d(Th)(chih*uh);
FSI;
err=sqrt((lm-lm0)^2);
/* == Computing the translational velocity **/
lm0=lm; real Mh=int2d(Th)(rhoB*chiB);
Introducci´on al m´etodo de los elementos finitos 83
real uB=int2d(Th)(rhoB*chiB*u1)/Mh; real vpart1=0.0;
real vB=int2d(Th)(rhoB*chiB*u2)/Mh; real vpart2=0.0;
real dt=1.0;
/* == Computing the angular velocity ********/ for (int i=0 ; i<=imax; i++){
real Jh,oB; FSI;
Jh=int2d(Th)(rhoB*chiB*((x-xB)^2+(y-yB)^2)); plot([u1,u2],ps="u"+i+".eps",coef=1);
oB=int2d(Th)(rhoB*chiB*(-(y-yB)*u1+(x-xB)*u2))/Jh; plot(chiB,ps="chi"+i+".eps",fill=1);
t=t+dt;
cout<<"(u,v)=("<<uB<< ","<<vB<<")"<<endl; vpart1=u1(xB,yB);
cout<<"omega="<<oB<<endl; vpart2=u2(xB,yB);
plot(chiB,fill=true,wait=0); xB=xB+vpart1*dt;
plot([u1,u2],value=true,wait=0,coef=5); yB=yB+vpart2*dt;
chiB= ((x-xB)^2+(y-yB)^2 < rB^2);
Sedimentation of a rigid sphere in a fluid at rest f2=-(rhoB-rhoF)*g*chiB;
/********************************************/
plot(chiB,fill=1);
/* PROBLEM 8-2 */
}
/* SEDIMENTATION OF A RIGID SPHERE */
/********************************************/ Rigid ellipsoid in a linear shear flow
/********************************************/
mesh Th =square(100,100); /* PROBLEM 8-3 */
/* ROTATING ELLIPSOID IN A SHEAR FLOW */
fespace Xh(Th,P1b); /********************************************/
fespace Mh(Th,P1);
Xh u1,u2,v1,v2; mesh Th =square(100,100);
Mh p,q;
fespace Vh(Th,P1b);
/* == Coordinates / radius of the sphere ****/ fespace Wh(Th,P1);
real xB=0.5, yB=0.8, rB=0.1; Vh u1,u2,v1,v2;
/* == Gravity and buoyancy ******************/ Wh p,q;
real g=9.81, rhoB=1.0, rhoF=0.1;
/* == Coordinates / radii of the ellipsoid **/
/* == Source term, characteristic function **/ real xB=0.5,yB=0.5,thetaB=0,rB=0.1,dB=0.25;
fespace Ph(Th,P0); /* == Gravity and buoyancy ******************/
Ph chiB = ((x-xB)^2+(y-yB)^2 < rB^2); real g=9.81, rhoB=1., rhoF=1.;
Ph f1=0.00;
Ph f2=-(rhoB-rhoF)*g*chiB; real Mh,Jh,uB,vB,omegaB;
real cosB=cos(thetaB);
/* == Parameters ****************************/ real sinB=sin(thetaB);
real eps=1.0E-2, delta=1.0E-8;
/* == Source term, characteristic function **/
/* == Variational formulation ***************/ fespace Ph(Th,P0);
problem FSI([u1,u2,p],[v1,v2,q])= Ph chiB;
int2d(Th)(2*dx(u1)*dx(v1)+dy(u1)*dy(v1)
+dx(u2)*dx(v2)+2*dy(u2)*dy(v2) chiB=(((x-xB)*cosB+(y-yB)*sinB)^2/rB^2
+dy(u1)*dx(v2)+dx(u2)*dy(v1)) +(-(x-xB)*sinB+(y-yB)*cosB)^2/dB^2<=1.0);
+int2d(Th)(delta*p*q-p*dx(v1)-p*dy(v2)
+q*dx(u1)+q*dy(u2)) Ph f1=0.00;
-int2d(Th)(f1*v1+f2*v2) Ph f2=-(rhoB-rhoF)*g*chiB;
+int2d(Th)((2*dx(u1)*dx(v1)+dy(u1)*dy(v1)
+dx(u2)*dx(v2)+2*dy(u2)*dy(v2) /* == Boundary condition (Couette flow) *****/
+dy(u1)*dx(v2)+dx(u2)*dy(v1))*chiB/eps) func g1=1.0*(1.-2*y);
+on(1,2,3,4,u1=0,u2=0); func g2=0;
/* == Time evolution ************************/ /* == Parameters ****************************/
int imax=50; real eps=1.0E-2, delta=1.0E-8;
real t=0.0;
84 Introducci´on al m´etodo de los elementos finitos
/* == Variational formulation ***************/ [3] F. Boyer and P. Fabrie, Mathematical tools
problem FSI([u1,u2,p],[v1,v2,q],solver=Crout)= for the study of the incompressible Navier-Stokes
int2d(Th)(2*dx(u1)*dx(v1)+dy(u1)*dy(v1) equations and related models. Springer, 2013.
+dx(u2)*dx(v2)+2*dy(u2)*dy(v2)
[4] H. Brezis, Analyse fonctionnelle : th´eorie et appli-
+dy(u1)*dx(v2)+dx(u2)*dy(v1))
cations. Masson, 1983.
+int2d(Th)(delta*p*q-p*dx(v1)-p*dy(v2)
+q*dx(u1)+q*dy(u2)) [5] F. Brezzi, On the existence uniqueness and ap-
-int2d(Th)(f1*v1+f2*v2)
proximation of saddle-point problems arising from
+int2d(Th)((2*dx(u1)*dx(v1)+dy(u1)*dy(v1)
Lagrange multipliers. RAIRO Mathematical Mod-
+dx(u2)*dx(v2)+2*dy(u2)*dy(v2)
elling and Numerical Analysis, 8(R2):129–151, 1974.
+dy(u1)*dx(v2)+dx(u2)*dy(v1))*chiB/eps)
+on(1,2,3,4,u1=g1,u2=g2); [6] F. Brezzi and M. Fortin, Mixed and hybrid
finite element method. Springer, 1991.
/* == Time evolution ************************/
[7] P.Cle´ment, Approximationbyfiniteelementfunc-
int imax=100;
tions using local regularization. RAIRO Numerical
real t = 0.0;
Analysis, 9(R-2), 77–84, 1975.
real dt= 0.1;
for (int i=0 ; i<=imax; i++){ [8] J. Douglas and J. Wang, An absolutely stabi-
FSI;
lized finite element method for the Stokes problem.
plot([u1,u2],ps="u"+i+".eps",wait=0,coef=1);
Math. of Comp., 52(186):495–508, 1989.
plot(chiB,ps="chi"+i+".eps",wait=0,fill=1);
t=t+dt; [9] A. Ern and J.-L. Guermond, Theory and prac-
tice of finite elements. Springer, 2004.
/* == Translational velocity *************/
[10] G.P. Galdi, An introduction to the mathematical
Mh=int2d(Th)(rhoB*chiB);
theory of the Navier-Stokes equations: steady-state
uB=int2d(Th)(rhoB*chiB*u1)/Mh;
problems. Springer, 1994.
vB=int2d(Th)(rhoB*chiB*u2)/Mh;
[11] V. Girault and P.-A. Raviart, Finite element
/* == Angular velocity *******************/
methods for Navier-Stokes equations. Springer,
Jh=int2d(Th)(rhoB*chiB*((x-xB)^2+(y-yB)^2));
1986.
omegaB=int2d(Th)(rhoB*chiB*
(-(y-yB)*u1+(x-xB)*u2))/Jh; [12] F. Hecht, New development in FreeFem++. J.
Numer. Math., 20(3-4):251–265, 2012.
/* == Update of the position *************/
[13] T.J.R. Hughes, L.P. Franca, and M.
xB=xB+uB*dt;
Balestra, A new finite element formulation for
yB=yB+vB*dt;
computational fluid dynamics: V. Circumventing
thetaB=thetaB+omegaB*dt;
the Babuska-Brezzi condition: a stable Petrov-
cosB=cos(thetaB);
Galerkin formulation of the Stokes problem accom-
sinB=sin(thetaB);
modating equal-order interpolations. Comp. Meth.
App. Mech. Eng., 59(1):85–99,1986.
chiB=(((x-xB)*cosB+(y-yB)*sinB)^2/rB^2
+(-(x-xB)*sinB+(y-yB)*cosB)^2/dB^2<=1.0); [14] A. Novotny and I. Straskraba, Introduction
f2=-(rhoB-rhoF)*g*chiB;
to the mathematical theory of compressible flow.
cout<<"thetaB="<<<<thetaB<<endl;
Oxford University Press, 2004.
}
[15] A. Quarteroni and A. Valli, Approximation of
partial differential equations: theory and numerical
References analysis. North-Holland, 1979.
[1] D.N. Arnold, F. Brezzi and M. Fortin, A sta- [16] L.R.ScottandS.Zhang, Finiteelementinterpo-
ble finite element for the Stokes equations. Calcolo, lation of nonsmooth functions satisfying boundary
23(4):337–344, 1985. conditions. Math. Comp., 54(190):483–493, 1990.
[2] I. Babuska, The finite element method with La- [17] R. Temam, Navier-Stokes Equations: theory and
grangianmultipliers. Num. Math.,20:179–192,1973. numerical analysis. North-Holland, 1979.
